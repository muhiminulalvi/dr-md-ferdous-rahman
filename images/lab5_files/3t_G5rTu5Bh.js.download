;/*FB_PKG_DELIM*/

__d("LSBumpE2EEMetadataThread",["LSCancelTaskByQueueName","LSIssueNewTask"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1];c.n;var d=[],e=[],f;return c.seq([function(e){return c.seq([function(e){return d[0]=new c.Map(),d[0].set("bump_timestamp_ms",a[1]),d[0].set("thread_key",a[0]),d[0].set("bumped_by_local_device_send",a[2]),d[1]=d[0].get("thread_key"),d[0],c.sp(b("LSCancelTaskByQueueName"),c.i64.to_string(d[1]),[0,389])},function(e){return d[2]=new c.Map(),d[2].set("bump_timestamp_ms",a[1]),d[2].set("thread_key",a[0]),d[2].set("bumped_by_local_device_send",a[2]),d[3]=d[2].get("thread_key"),d[2],d[4]=c.toJSON(d[2]),c.sp(b("LSIssueNewTask"),c.i64.to_string(d[3]),[0,389],d[4],f,f,[0,0],[0,0],f,f,[0,0])}])},function(a){return c.resolve(e)}])}e.exports=a}),null);
__d("LSCreateE2EEMetadataThread",["LSIssueNewTask"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1];c.n;var d=[],e=[],f;return c.seq([function(e){return d[0]=new c.Map(),d[0].set("wa_jid",a[0]),d[0].set("offline_thread_key",a[1]),d[0].set("thread_type",a[2]),d[0].set("folder_type",a[3]),d[0].set("bump_timestamp_ms",a[4]),d[1]=d[0].get("offline_thread_key"),d[0],d[2]=c.toJSON(d[0]),c.sp(b("LSIssueNewTask"),c.i64.to_string(d[1]),[0,388],d[2],f,f,[0,0],[0,0],f,f,[0,0])},function(a){return c.resolve(e)}])}e.exports=a}),null);
__d("LSUpdateE2EEMetadataParticipants",["LSIssueNewTask"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1];c.n;var d=[],e=[],f;return c.seq([function(e){return d[0]=new c.Map(),d[0].set("thread_key",a[0]),d[1]=d[0].get("thread_key"),d[0],d[2]=c.toJSON(d[0]),c.sp(b("LSIssueNewTask"),c.i64.to_string(d[1]),[0,394],d[2],f,f,[0,0],[0,0],f,f,[0,0])},function(a){return c.resolve(e)}])}e.exports=a}),null);
__d("MAWCatQuery_facebookRelayOperation",[],(function(a,b,c,d,e,f){e.exports="4877036382414550"}),null);
__d("MAWCatQuery.facebook.graphql",["MAWCatQuery_facebookRelayOperation","relay-runtime"],(function(a,b,c,d,e,f){"use strict";a=function(){var a=[{alias:null,args:null,concreteType:"SecureMessageOverWACATGraphResult",kind:"LinkedField",name:"secure_message_over_wa_cat_query",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"encrypted_serialized_cat",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"expiration_time_in_seconds",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"MAWCatQuery",selections:a,type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[],kind:"Operation",name:"MAWCatQuery",selections:a},params:{id:b("MAWCatQuery_facebookRelayOperation"),metadata:{},name:"MAWCatQuery",operationKind:"query",text:null}}}();b("relay-runtime").PreloadableQueryRegistry.set(a.params.id,a);e.exports=a}),null);
__d("MAWCatQuery.graphql",["cr:11203"],(function(a,b,c,d,e,f){"use strict";e.exports=b("cr:11203")}),null);
__d("MAWCatQuery",["MAWCatQuery.graphql"],(function(a,b,c,d,e,f,g){"use strict";var h;a=h!==void 0?h:h=b("MAWCatQuery.graphql");c=a;g["default"]=c}),98);
__d("MWToast.react",["deferredLoadComponent","gkx","react","requireDeferred"],(function(a,b,c,d,e,f,g){"use strict";var h=d("react"),i=c("gkx")("571"),j=c("deferredLoadComponent")(c("requireDeferred")("MDSToast.react").__setRef("MWToast.react")),k=c("deferredLoadComponent")(c("requireDeferred")("CometToast.react").__setRef("MWToast.react"));function a(a){var b,c=a.body,d=a.icon,e=a.onDismiss,f=a.startAddOn;f=f===void 0?null:f;var g=a.supressCloseButton;g=g===void 0?!1:g;var l=a.testid;l=l===void 0?"mw-toast":l;a=a.title;var m=(d==null?void 0:d.mds)!=null?{source:d==null?void 0:d.mds,type:"icon"}:void 0;d=(d=d==null?void 0:d.comet)!=null?d:void 0;b=a!=null&&c!=null?h.jsxs(h.Fragment,{children:[a,h.jsx("br",{}),c]}):(b=(b=a)!=null?b:c)!=null?b:"";c={body:c,onDismiss:e,startAddOn:f!==null?f:m,testid:l,title:a,withCloseButton:!g};f={icon:d,message:b,onDismiss:e,supressCloseButton:g,testid:l};return i?h.jsx(j,babelHelpers["extends"]({},c)):h.jsx(k,babelHelpers["extends"]({},f))}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("mwPushToast",["ix","BaseToasterStateManager","MWToast.react","cr:2344","cr:4379","fbicon","react"],(function(a,b,c,d,e,f,g,h){"use strict";var i=d("react"),j=c("BaseToasterStateManager").getInstance();function k(a,b){var d=a.body,e=a.icon,f=a.startAddOn;f=f===void 0?null:f;var g=a.supressCloseButton;g=g===void 0?!1:g;a=a.title;b===void 0&&(b=2750);var h=j.push(i.jsx(c("MWToast.react"),{body:d,icon:e,onDismiss:function(){return j.expire(h)},startAddOn:f,supressCloseButton:g,title:a}),b);return h}function a(a,c){var e,f=a.body;a=a.title;c===void 0&&(c=2750);var g=b("cr:2344")!==null?i.jsx(b("cr:2344"),{color:"warning",icon:d("fbicon")._(h("502062"),20)}):void 0;e=(e=b("cr:4379"))!=null?e:void 0;return k({body:f,icon:{comet:g,mds:e},title:a},c)}g.mwPushToast=k;g.mwPushErrorToast=a}),98);
__d("mwReplaceToast",["BaseToasterStateManager","MWToast.react","err","react"],(function(a,b,c,d,e,f,g){"use strict";var h=d("react"),i=c("BaseToasterStateManager").getInstance();function a(a){var b=a.body,d=a.icon,e=a.startAddOn;e=e===void 0?null:e;var f=a.supressCloseButton;f=f===void 0?!1:f;var g=a.title,j=a.toastId;if(j==null){c("err")("toastId or toasterStateManager is not provided");return}i.replace(j,h.jsx(c("MWToast.react"),{body:b,icon:d,onDismiss:function(){return i.expire(j)},startAddOn:e,supressCloseButton:f,title:g}))}g.mwReplaceToast=a}),98);
__d("MAWCryptoAuthToken",["MAWCatQuery","RelayHooks","err"],(function(a,b,c,d,e,f,g){"use strict";function h(a){return a==null||a.secure_message_over_wa_cat_query==null||a.secure_message_over_wa_cat_query.encrypted_serialized_cat==null||a.secure_message_over_wa_cat_query.expiration_time_in_seconds==null?{error:"Crypto Auth Token was null or incomplete"}:{success:{encrypted_serialized_cat:a.secure_message_over_wa_cat_query.encrypted_serialized_cat,expiration_time_in_seconds:a.secure_message_over_wa_cat_query.expiration_time_in_seconds}}}function a(a){return d("RelayHooks").fetchQuery(a,c("MAWCatQuery"),{}).toPromise().then(h).then(function(a){if(a.error!==null&&a.error!==void 0)throw c("err")("Unable to rotate Crypto Auth Token");return a.success})}g.processCatResponse=h;g.fetchFreshCAT=a}),98);
__d("WAFixedSizeMap",[],(function(a,b,c,d,e,f){a=function(){function a(a){a=a.max;this.$1=new Map();this.$2=new Map();this.$3=0;this.$4=100;this.$4=a}var b=a.prototype;b.has=function(a){return this.$1.has(a)};b.get=function(a){return this.$1.get(a)};b.set=function(a,b){this.$1.set(a,b);this.$2.set(this.$3,a);this.$3+=1;b=this.$2.get(this.$3-this.$4-1);b!=null&&(this.$1["delete"](b),this.$2["delete"](this.$3-this.$4-1))};b.clear=function(){this.$1.clear(),this.$2.clear(),this.$3=0};b.size=function(){return this.$1.size};return a}();f.FixedSizeMap=a}),66);
__d("MAWJobActionsV2",["MAWTransactionMode","Promise","WAFixedSizeMap","WAHex","WATimeUtils"],(function(a,b,c,d,e,f,g){"use strict";function h(a){return new(b("Promise"))(function(b,c){a.onsuccess=b,a.onerror=c})}function i(a){return h(a).then(function(a){return a.target.result})}function j(a,c,e){return new(b("Promise"))(function(b,f){var g=a(d("MAWTransactionMode").READONLY).index(c);g=g.openCursor(IDBKeyRange.only(e));var h=[];g.onsuccess=function(a){a=a.target.result;if(!a){b(h);return}h.push(a.value);a["continue"]()};g.onerror=function(a){return f(a)}})}var k=new(d("WAFixedSizeMap").FixedSizeMap)({max:100});function a(a,c){var d=c.args,e=c.type,f=c.uniqKey;c=c.version;c=c===void 0?1:c;return f!=null&&k.has(f)?b("Promise").resolve({newlyCreated:"cached",result:k.get(f)}):l(a,{args:d,type:e,uniqKey:f,version:c})}function l(a,c){var e,f=c.args,g=c.scheduleConfig,h=c.type,k=c.uniqKey;c=c.version;c=c===void 0?1:c;e=JSON.stringify([h,(e=k)!=null?e:d("WAHex").randomHex(32)]);var l={backedOffCount:0,current:f,original:f,scheduleConfig:g,startTime:d("WATimeUtils").unixTime(),step:"$unstarted",stepFirstStartTime:null,stepHardStartCountAfterTimeout:0,stepUnexpectedErrorCount:0,type:h,uniqKey:e,version:c,waitUntil:null},n=function(){var b,c=a().add(l),d=i(c);if(l.uniqKey==null&&typeof ((b=c.transaction)==null?void 0:b.commit)==="function")try{c.transaction.commit()}catch(a){}return d.then(function(a){return{id:a,newlyCreated:!0}})};if(k!=null)return j(a,"uniqKey",k).then(function(c){if(c.length===0)return n();var d=[],e=null;c.forEach(function(b){b.step!=="$finished"?e=b:d.push(m(a,b.jobId))});return b("Promise").all(d).then(function(){return e!=null?{id:e.jobId,newlyCreated:!1}:n()})});else return n()}function m(a,b){return i(a()["delete"](b))}function c(a,b){return i(a().get(b))}function e(a,b){return i(a().put(b))}function f(a){return i(a().getAll())}function n(a){return h(a().clear()).then(function(){})}g.recentFinishedJobsCache=k;g.maybeCreateJobWithCache=a;g.maybeCreateJob=l;g.deletePersistedJob=m;g.readPersistedJob=c;g.updatePersistedJob=e;g.readAllPersistedJobs=f;g.clearJobs=n}),98);
__d("MessengerWaitForEvent",["Promise"],(function(a,b,c,d,e,f){function a(a,c,d){var e,f=d;return new(b("Promise"))(function(b){f?e=function(){f.apply(this,arguments)&&b.apply(this,arguments)}:e=b,a&&a.addEventListener&&a.addEventListener(c,e)})["finally"](function(){a&&a.removeEventListener&&a.removeEventListener(c,e)})}f.waitForEvent=a}),66);
__d("LocalStorageMutex",["MessengerWaitForEvent","Promise","QPLUserFlow","err","pageID","qpl"],(function(a,b,c,d,e,f,g){"use strict";var h=null,i=1e3;a=function(){function a(a){var b=this,d=a.mutexKey,e=a.localTakeoverKey,f=a.log,g=a.logError,h=a.getStorage,j=a.setItemGuarded,k=a.mutexTimeoutMs;k=k===void 0?i:k;a=a.mutexTimeoutCallback;this.mutexFilter=function(a){if(a.key!==b.$1)return!1;a=a.newValue||"";if(!a.includes(c("pageID")))return!0;else return!1};this.$1=d;this.$2=e;this.$5=h;this.$6=j;this.$3=f;this.$4=g;this.$7=k;this.$8=a}var e=a.prototype;e.init=function(){c("QPLUserFlow").start(c("qpl")._(1056847375,"584"));this.$3("APPMUTEX - this tab is "+c("pageID"));var a=this.getMutex();if(a!=null&&a===c("pageID")){this.$3("APPMUTEX - WE ALREADY HAVE THE MUTEX LOCK WITHIN INIT");c("QPLUserFlow").endSuccess(c("qpl")._(1056847375,"584"));return b("Promise").resolve(!0)}if(a!=null){this.$3("APPMUTEX - initiating localTAKEOVER");return this.localTakeover()}else{this.$3("APPMUTEX - NO1 ELSE IS ALIVE, GET THE MUTEX");a=this.$9(c("pageID"));var d=this.$10(c("pageID"));if(!a.success||!d.success){c("QPLUserFlow").addAnnotations(c("qpl")._(1056847375,"584"),{bool:{setMutexResult:d.success,setTakeoverResult:a.success},string:{setMutexError:d.error,setTakeoverError:a.error}});c("QPLUserFlow").endFailure(c("qpl")._(1056847375,"584"),"fail_to_set_takeover_or_mutex");return b("Promise").resolve(!1)}c("QPLUserFlow").endSuccess(c("qpl")._(1056847375,"584"));return b("Promise").resolve(!0)}};e.localTakeover=function(){var a,e=this,f=this.$9(c("pageID"));if(!f.success){c("QPLUserFlow").addAnnotations(c("qpl")._(1056847375,"584"),{string:{initTakeoverError:f.error}});c("QPLUserFlow").endFailure(c("qpl")._(1056847375,"584"),"local_takeover_init_takeover_failure");return b("Promise").resolve(!1)}var g,h=function(){g!=null&&clearTimeout(g)};f=d("MessengerWaitForEvent").waitForEvent(window,"storage",this.mutexFilter);var j=(a=this==null?void 0:this._mutexTimeoutMs)!=null?a:i;return b("Promise").race([f,new(b("Promise"))(function(a){g=setTimeout(function(){a()},j)}),this.$8?this.$8():new(b("Promise"))(function(a){})]).then(function(a){if(a==null){e.$3("AppMutex - Forcefully took the mutex and takeover lock");var b=e.$9(c("pageID")),d=e.$10(c("pageID"));if(!b.success||!d.success){c("QPLUserFlow").addAnnotations(c("qpl")._(1056847375,"584"),{string:{setMutexError:d.error,setTakeoverError:b.error}});c("QPLUserFlow").endFailure(c("qpl")._(1056847375,"584"),"local_takeover_forcefully_takeover_failure");return!1}c("QPLUserFlow").endSuccess(c("qpl")._(1056847375,"584"));return!0}e.$3("APPMUTEX - GOT MUTEX STORAGE EVENT CHANGE FROM ANOTHER TAB");d=e.$11(a.newValue);if(!d&&e.hasTakeoverPermission()){e.$3("APPMUTEX - setting mutex on localtakeover");b=e.$10(c("pageID"));if(!b.success){c("QPLUserFlow").addAnnotations(c("qpl")._(1056847375,"584"),{string:{setMutexError:b.error}});c("QPLUserFlow").endFailure(c("qpl")._(1056847375,"584"),"local_takeover_set_mutex_failure");return!1}c("QPLUserFlow").endSuccess(c("qpl")._(1056847375,"584"));return!0}else{e.hasTakeoverPermission()&&e.$12();c("QPLUserFlow").endFailure(c("qpl")._(1056847375,"584"),"local_takeover_no_takeover_permission");return!1}}).then(function(a){h();return a})["catch"](function(a){h();e.$4("AppMutex - localTakeover error no permission - "+a);c("QPLUserFlow").endFailure(c("qpl")._(1056847375,"584"),"local_takeover_general_failure");return!1})};e.onMutexDeath=function(){var a=this.getMutex();a!=null&&a==c("pageID")&&(this.$3("APPMUTEX - removing mutex on death"),this.$13(),this.hasTakeoverPermission()&&this.$12())};e.takeoverFilter=function(a){if(a.key!==this.$2)return!1;a=a.newValue||"";if(!a.includes(c("pageID")))return!0;else return!1};e.$14=function(){if(!h){var a=this.$5();if(!a)throw c("err")("Could not get localStorage");h=a}return h};e.getMutex=function(){h=this.$14();return h.getItem(this.$1)};e.$10=function(a){h=this.$14();return this.$6(h,this.$1,a)};e.$13=function(){h=this.$14(),h.removeItem(this.$1)};e.getTakeover=function(){h=this.$14();return h.getItem(this.$2)};e.$9=function(a){h=this.$14();return this.$6(h,this.$2,a)};e.$12=function(){h=this.$14(),h.removeItem(this.$2)};e.$11=function(a){return a!=null?a:""};e.hasTakeoverPermission=function(){var a=this.getTakeover();return a!=null&&a==c("pageID")};return a}();g.THIS_TAB=c("pageID");g.LocalStorageMutex=a}),98);
__d("MAWAppMutex",["LocalStorageMutex","MAWLocalStorage","WALogger"],(function(a,b,c,d,e,f,g){"use strict";var h="armadillo_msgr_mutex",i="armadillo_msgr_local_takeover",j=null;function a(){j==null&&(j=new(d("LocalStorageMutex").LocalStorageMutex)({mutexKey:h,localTakeoverKey:i,log:function(a){d("WALogger").LOG([a])},logError:function(a){d("WALogger").ERROR([a])},getStorage:d("MAWLocalStorage").getStorage,setItemGuarded:d("MAWLocalStorage").setItemGuarded}));return j}g.MAW_MUTEX_KEY=h;g.MAW_LOCALTAKEOVER_KEY=i;g.use=a}),98);
__d("MAWLocalizationEphemeralSettingSetAdminMsg",["MAWLocalizationType"],(function(a,b,c,d,e,f,g){"use strict";function a(a){return a===d("MAWLocalizationType").LOCALIZATION_TYPE.UNKNOWN_USER_EPHEMERAL_SETTING_TURNED_ON_SECONDS||a===d("MAWLocalizationType").LOCALIZATION_TYPE.UNKNOWN_USER_EPHEMERAL_SETTING_TURNED_ON_MINUTES||a===d("MAWLocalizationType").LOCALIZATION_TYPE.UNKNOWN_USER_EPHEMERAL_SETTING_TURNED_ON_HOURS||a===d("MAWLocalizationType").LOCALIZATION_TYPE.UNKNOWN_USER_EPHEMERAL_SETTING_TURNED_ON_DAYS||a===d("MAWLocalizationType").LOCALIZATION_TYPE.YOU_EPHEMERAL_SETTING_TURNED_ON_SECONDS||a===d("MAWLocalizationType").LOCALIZATION_TYPE.YOU_EPHEMERAL_SETTING_TURNED_ON_MINUTES||a===d("MAWLocalizationType").LOCALIZATION_TYPE.YOU_EPHEMERAL_SETTING_TURNED_ON_HOURS||a===d("MAWLocalizationType").LOCALIZATION_TYPE.YOU_EPHEMERAL_SETTING_TURNED_ON_DAYS||a===d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_EPHEMERAL_SETTING_TURNED_ON_SECONDS||a===d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_EPHEMERAL_SETTING_TURNED_ON_MINUTES||a===d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_EPHEMERAL_SETTING_TURNED_ON_HOURS||a===d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_EPHEMERAL_SETTING_TURNED_ON_DAYS||a===d("MAWLocalizationType").LOCALIZATION_TYPE.UNKNOWN_USER_EPHEMERAL_SETTING_CHANGE_SECONDS||a===d("MAWLocalizationType").LOCALIZATION_TYPE.UNKNOWN_USER_EPHEMERAL_SETTING_CHANGE_MINUTES||a===d("MAWLocalizationType").LOCALIZATION_TYPE.UNKNOWN_USER_EPHEMERAL_SETTING_CHANGE_HOURS||a===d("MAWLocalizationType").LOCALIZATION_TYPE.UNKNOWN_USER_EPHEMERAL_SETTING_CHANGE_DAYS||a===d("MAWLocalizationType").LOCALIZATION_TYPE.YOU_EPHEMERAL_SETTING_CHANGE_SECONDS||a===d("MAWLocalizationType").LOCALIZATION_TYPE.YOU_EPHEMERAL_SETTING_CHANGE_MINUTES||a===d("MAWLocalizationType").LOCALIZATION_TYPE.YOU_EPHEMERAL_SETTING_CHANGE_HOURS||a===d("MAWLocalizationType").LOCALIZATION_TYPE.YOU_EPHEMERAL_SETTING_CHANGE_DAYS||a===d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_EPHEMERAL_SETTING_CHANGE_SECONDS||a===d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_EPHEMERAL_SETTING_CHANGE_MINUTES||a===d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_EPHEMERAL_SETTING_CHANGE_HOURS||a===d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_EPHEMERAL_SETTING_CHANGE_DAYS||a===d("MAWLocalizationType").LOCALIZATION_TYPE.UNKNOWN_USER_EPHEMERAL_SETTING_TURNED_OFF||a===d("MAWLocalizationType").LOCALIZATION_TYPE.YOU_EPHEMERAL_SETTING_TURNED_OFF||a===d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_EPHEMERAL_SETTING_TURNED_OFF}g.isEphemeralSettingSetAdminMsg=a}),98);
__d("MAWAdminMsgCTA.bs",["fbt","MAWLocalizationEphemeralSettingSetAdminMsg","MAWLocalizationType.bs","MAWTimeUtils","Promise","ReQL.bs","bs_caml_int64","regeneratorRuntime"],(function(a,b,c,d,e,f,g,h){"use strict";var i=h._("__JHASH__iw7A0LnsmaW__JHASH__").toString(),j=h._("__JHASH__jODYJ2eW1Pa__JHASH__").toString(),k=h._("__JHASH__xAOSvpC7vLN__JHASH__").toString();function l(a){var e;return b("regeneratorRuntime").async(function(f){while(1)switch(f.prev=f.next){case 0:f.next=2;return b("regeneratorRuntime").awrap(d("ReQL.bs").first(d("ReQL.bs").fromIndexDescending(a.table("admin_message_ctas").index("ctaId"))));case 2:e=f.sent;return f.abrupt("return",e!=null?c("bs_caml_int64").add(e.ctaId,c("bs_caml_int64").one):c("bs_caml_int64").zero);case 4:case"end":return f.stop()}},null,this)}function m(a,b,c){return d("ReQL.bs").first(d("ReQL.bs").bounds(d("ReQL.bs").fromTableDescending(a.table("admin_message_ctas")),{NAME:"range",VAL:[{NAME:"greaterThanOrEqual",VAL:{hd:b,tl:{hd:c,tl:0}}},{NAME:"lessThanOrEqual",VAL:{hd:b,tl:{hd:c,tl:0}}}]}))}function n(a){if(a==null)return{actionUrl:void 0,adClientToken:void 0,adHelpUrl:void 0,adminMessageNicknameParticipantId:void 0,adPreferenceUrl:void 0,showAdChoiceIcon:!1,targetId:void 0,targetTitle:void 0,title:void 0};if(d("MAWLocalizationEphemeralSettingSetAdminMsg").isEphemeralSettingSetAdminMsg(a))return{actionUrl:void 0,adClientToken:void 0,adHelpUrl:void 0,adminMessageNicknameParticipantId:void 0,adPreferenceUrl:void 0,showAdChoiceIcon:!1,targetId:void 0,targetTitle:void 0,title:i};switch(a){case d("MAWLocalizationType.bs").cutoverThreadAdminMessage:case d("MAWLocalizationType.bs").e2eeThreadAdminMessage:return{actionUrl:void 0,adClientToken:void 0,adHelpUrl:void 0,adminMessageNicknameParticipantId:void 0,adPreferenceUrl:void 0,showAdChoiceIcon:!1,targetId:void 0,targetTitle:void 0,title:j};case d("MAWLocalizationType.bs").cutoverRollbackAdminMessage:return{actionUrl:void 0,adClientToken:void 0,adHelpUrl:void 0,adminMessageNicknameParticipantId:void 0,adPreferenceUrl:void 0,showAdChoiceIcon:!1,targetId:void 0,targetTitle:void 0,title:k};default:return{actionUrl:void 0,adClientToken:void 0,adHelpUrl:void 0,adminMessageNicknameParticipantId:void 0,adPreferenceUrl:void 0,showAdChoiceIcon:!1,targetId:void 0,targetTitle:void 0,title:void 0}}}function o(a){if(a==null)return;if(d("MAWLocalizationEphemeralSettingSetAdminMsg").isEphemeralSettingSetAdminMsg(a))return"admin_msg_armadillo_ephemeral_change_duration";switch(a){case d("MAWLocalizationType.bs").cutoverThreadAdminMessage:return"admin_msg_thread_level_cutover";case d("MAWLocalizationType.bs").e2eeThreadAdminMessage:return"admin_msg_e2ee_thread";case d("MAWLocalizationType.bs").cutoverRollbackAdminMessage:return"admin_msg_cutover_rollback"}}function p(a,b,c,e,f){return a.table("admin_message_ctas").add({actionUrl:f.actionUrl,adClientToken:f.adClientToken,adHelpUrl:f.adHelpUrl,adminMessageNicknameParticipantId:f.adminMessageNicknameParticipantId,adPreferenceUrl:f.adPreferenceUrl,ctaId:b,messageId:e.msgId,showAdChoiceIcon:f.showAdChoiceIcon,targetId:f.targetId,targetTitle:f.targetTitle,threadKey:c,timestampMs:d("MAWTimeUtils").toTimestamp(e.ts),title:f.title})}function q(a,c,d){var e,f,g,h;return b("regeneratorRuntime").async(function(i){while(1)switch(i.prev=i.next){case 0:i.next=2;return b("regeneratorRuntime").awrap(b("Promise").all([m(a,c,d.msgId),l(a)]));case 2:e=i.sent;f=e[0];g=e[1];if(!(f!=null)){i.next=9;break}return i.abrupt("return",{ctaId:f.ctaId,ctaType:o(d.adminType),title:f.title});case 9:h=n(d.adminType);i.next=12;return b("regeneratorRuntime").awrap(p(a,g,c,d,h));case 12:return i.abrupt("return",{ctaId:g,ctaType:o(d.adminType),title:h.title});case 13:case"end":return i.stop()}},null,this)}function a(a,c,e){var f=e.adminType;return f!==void 0&&(d("MAWLocalizationEphemeralSettingSetAdminMsg").isEphemeralSettingSetAdminMsg(f)||f===d("MAWLocalizationType.bs").cutoverThreadAdminMessage||f===d("MAWLocalizationType.bs").e2eeThreadAdminMessage||f===d("MAWLocalizationType.bs").cutoverRollbackAdminMessage)?q(a,c,e):b("Promise").resolve()}g.insertAdminMsgCta=p;g.createOrReturnExistingAdminMsgCta=q;g.getAdminMsgCtaStep=a}),98);
__d("MAWAdminMsgNormalized",["MAWLocalizationType"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b){switch(a){case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_ADDED_YOU:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_ADDED_YOU_AND_ONE_USER:case d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_ADDED_ONE_PARTICIPANT:case d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_ADDED_TWO_PARTICIPANTS:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_ADDED_ONE_USER:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_ADDED_TWO_USER:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_REMOVED_YOU:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_REMOVED_YOU_AND_ONE_USER:case d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_REMOVED_ONE_PARTICIPANT:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_LEFT_GROUP:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_REMOVED_ONE_USER:case d("MAWLocalizationType").LOCALIZATION_TYPE.UNKNOW_USER_ADDED_YOU_AND_ONE_USER:case d("MAWLocalizationType").LOCALIZATION_TYPE.UNKNOW_USER_ADDED_ONE_USER:case d("MAWLocalizationType").LOCALIZATION_TYPE.UNKNOW_USER_ADDED_TWO_USER:case d("MAWLocalizationType").LOCALIZATION_TYPE.UNKNOW_USER_REMOVED_ONE_USER:case d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_PROMOTED_PARTICIPANT:case d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_DEMOTED_PARTICIPANT:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_GOT_PROMOTED:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_GOT_DEMOTED:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_PROMOTED_YOU:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_DEMOTED_YOU:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_PROMOTED_PARTICIPANT:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_SELF_DEMOTED:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_DEMOTED_PARTICIPANT:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_ADDED_DEVICE:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_REMOVED_DEVICE:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_UPDATED_DEVICE:return{contactIds:b,contents:[]};case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_ADDED_YOU_AND_MORE_THAN_ONE_USERS:case d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_ADDED_MORE_THAN_TWO_PARTICIPANTS:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_REMOVED_YOU_AND_MORE_THAN_ONE_USERS:case d("MAWLocalizationType").LOCALIZATION_TYPE.UNKNOW_USER_ADDED_MORE_THAN_TWO_USER:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_NAMED_GROUP:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_CUSTOMIZE_HOTLIKE:case d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_CUSTOMIZE_NICKNAME:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_CUSTOMIZE_CURRENT_USER_NICKNAME:a=b[0];var c=b[1];return{contactIds:[a],contents:[c]};case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_ADDED_MORE_THAN_TWO_USER:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_CUSTOMIZE_PARTICIPANT_NICKNAME:a=b[0];c=b[1];var e=b[2];return{contactIds:[a,c],contents:[e]};case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_CUSTOMIZE_THEME:a=b[0];c=b[1];e=b[2];return{contactIds:[a],contents:[c,e]};case d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_NAMED_GROUP:case d("MAWLocalizationType").LOCALIZATION_TYPE.UNKNOWN_USER_NAMED_GROUP:case d("MAWLocalizationType").LOCALIZATION_TYPE.UNKNOW_USER_ADDED_YOU_AND_MORE_THAN_ONE_USER:case d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_CUSTOMIZE_THEME:case d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_CUSTOMIZE_HOTLIKE:default:return{contactIds:[],contents:b}}}g.deconstructContactIdsFromAdminContent=a}),98);
__d("MAWMedia.bs",["MAWDbMedia","MessagingAttachmentType.bs","bs_caml_int64"],(function(a,b,c,d,e,f,g){"use strict";function a(a){if(a===d("MAWDbMedia").IMAGE)return d("MessagingAttachmentType.bs").image;else if(a===d("MAWDbMedia").VIDEO)return d("MessagingAttachmentType.bs").video;else if(a===d("MAWDbMedia").PTT)return d("MessagingAttachmentType.bs").audio;else if(a===d("MAWDbMedia").GIF)return d("MessagingAttachmentType.bs").animatedImage;else if(a===d("MAWDbMedia").STICKER)return d("MessagingAttachmentType.bs").sticker;return d("MessagingAttachmentType.bs").none}g.mediaTypeToMessageAttachmentType=a;g.mediaIdToIntExn=c("bs_caml_int64").of_int32}),98);
__d("MAWFrontendMediaUtils",["MAWDbMedia","err"],(function(a,b,c,d,e,f,g){"use strict";function a(a){if(a==="image/gif")return{mediaType:d("MAWDbMedia").MEDIA_TYPE.GIF,serverMediaType:"gif"};if(a==="image/webp")return{mediaType:d("MAWDbMedia").MEDIA_TYPE.STICKER,serverMediaType:"sticker"};var b=a.split("/")[0];switch(b){case"image":return{mediaType:d("MAWDbMedia").MEDIA_TYPE.IMAGE,serverMediaType:"image"};case"video":return{mediaType:d("MAWDbMedia").MEDIA_TYPE.VIDEO,serverMediaType:"video"};case"audio":return{mediaType:d("MAWDbMedia").MEDIA_TYPE.PTT,serverMediaType:"ptt"};default:throw c("err")("get a wrong media file with type "+a)}}g.getMediaTypeAndServerMediaTypeFromBlob=a}),98);
__d("QPLUserCountEvent",["QPLUserFlow"],(function(a,b,c,d,e,f,g){"use strict";function a(a){c("QPLUserFlow").start(a),c("QPLUserFlow").endSuccess(a)}g.fireQplUserCount=a}),98);
__d("MNLSXMATemplateType.bs",["bs_caml_int64"],(function(a,b,c,d,e,f){"use strict";a=b("bs_caml_int64").zero;c=b("bs_caml_int64").neg_one;f.genericShare=a;f.default_=c}),null);
__d("MNXMAPreviewImageDecorationType.bs",["bs_caml_int64"],(function(a,b,c,d,e,f){"use strict";a=b("bs_caml_int64").zero;c=b("bs_caml_int64").one;d=[0,2];e=[0,3];b=[0,4];var g=[0,5],h=[0,6],i=[0,7],j=[0,8],k=[0,9],l=[0,10],m=[0,11];f.default_=a;f.collage=c;f.video=d;f.messengerIcon=e;f.instagramIcon=b;f.shopping=g;f.upcomingEvent=h;f.live=i;f.reel=j;f.igtv=k;f.youtubeVideo=l;f.youtubeShorts=m}),null);
__d("MAWBridgeNewXMAHandler.bs",["I64","MAWDbMsg","MAWThreadId.bs","MNLSXMALayoutType.bs","MNLSXMATemplateType.bs","MNXMAPreviewImageDecorationType.bs","MessagingAttachmentType.bs","Promise","ReQL.bs","WAArmadilloXMA.pb","bs_belt_Array","bs_belt_Option","bs_caml_int64"],(function(a,b,c,d,e,f,g){"use strict";function h(a,b){if(a===void 0)return;a=c("bs_belt_Array").get(a,b-1);if(a===void 0)return;return a.buttonType===d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.IG_SINGLE_VIDEO_POST_SHARE?"xma_open_native":void 0}function i(a,b){if(a===void 0)return;a=c("bs_belt_Array").get(a,b-1|0);if(a!==void 0)return a.title}function j(a){if(a===0||a!==3)return d("MNLSXMALayoutType.bs").single;else return d("MNLSXMALayoutType.bs").portrait}function a(a){return d("MNLSXMATemplateType.bs").default_}function k(a){switch(a){case 10:return d("MNXMAPreviewImageDecorationType.bs").collage;case 14:return d("MNXMAPreviewImageDecorationType.bs").reel;case 5:case 6:case 7:case 8:case 9:case 11:case 15:case 16:case 17:case 18:case 19:return d("MNXMAPreviewImageDecorationType.bs").default_;case 4:case 12:case 13:case 20:case 21:case 22:case 23:return d("MNXMAPreviewImageDecorationType.bs").instagramIcon;default:return d("MNXMAPreviewImageDecorationType.bs").default_}}function l(a,e){return d("MAWThreadId.bs").toThreadKeyMaybe(a,e.threadId).then(function(f){if(f===void 0)return b("Promise").resolve();var g=String(e.xmaId),l=e.msgId;if(l!==void 0)return d("ReQL.bs").first(d("ReQL.bs").fromTableDescending(a.table("attachment_ctas"))).then(function(h){var i=h!==void 0?c("bs_caml_int64").add(h.ctaId,c("bs_caml_int64").one):c("bs_caml_int64").one;h=e.defaultCTA;if(h===void 0)return b("Promise").resolve([void 0,i]);var j=h.actionUrl,k=h.nativeUrl,m="xma_web_url";switch(e.targetType){case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.RTC_AUDIO_CALL:case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.RTC_GROUP_AUDIO_CALL:m="xma_rtc_audio";break;case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.RTC_VIDEO_CALL:case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.RTC_GROUP_VIDEO_CALL:m="xma_rtc_video";break;case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.RTC_MISSED_AUDIO_CALL:m="xma_rtc_missed_audio";break;case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.RTC_MISSED_VIDEO_CALL:m="xma_rtc_missed_video";break}return a.table("attachment_ctas").add({actionContentBlob:void 0,actionUrl:j!==void 0?j:h.nativeUrl,attachmentFbid:g,attachmentIndex:c("bs_caml_int64").zero,ctaId:i,enableExtensions:!1,extensionHeightType:void 0,messageId:l,nativeUrl:k!==void 0?k:h.actionUrl,platformToken:void 0,targetId:void 0,threadKey:f,title:c("bs_belt_Option").getWithDefault(h.title,""),type_:m,urlWebviewType:void 0}).then(function(a){return b("Promise").resolve([i,i])})}).then(function(d){var h=d[1],i=d[0],j=[];d=e.ctas;if(d===void 0)return b("Promise").resolve([i,[]]);d=d.map(function(b,d){d=c("bs_caml_int64").add(h,c("bs_caml_int64").of_int32(d+1|0));j.push(d);var e=b.actionUrl,i=b.nativeUrl;return a.table("attachment_ctas").add({actionContentBlob:void 0,actionUrl:e!==void 0?e:b.nativeUrl,attachmentFbid:g,attachmentIndex:c("bs_caml_int64").zero,ctaId:d,enableExtensions:!1,extensionHeightType:void 0,messageId:l,nativeUrl:i!==void 0?i:b.actionUrl,platformToken:void 0,targetId:void 0,threadKey:f,title:c("bs_belt_Option").getWithDefault(b.title,"Tap to view status update"),type_:"xma_web_url",urlWebviewType:void 0})});return b("Promise").all(d).then(function(a){return b("Promise").resolve([i,j])})}).then(function(b){var m=b[1],n=c("bs_caml_int64").of_int32(d("MAWDbMsg").getInChatMsgIdFromMsgId(l)),o;switch(e.targetType){case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.FB_STORY_SHARE:o={height:d("I64").of_int32(108),width:d("I64").of_int32(72),xmaContentType:"xma_montage_share"};break;case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.RTC_AUDIO_CALL:o={xmaContentType:"xma_rtc_audio"};break;case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.RTC_VIDEO_CALL:o={xmaContentType:"xma_rtc_video"};break;case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.RTC_MISSED_AUDIO_CALL:o={xmaContentType:"xma_rtc_missed_audio"};break;case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.RTC_MISSED_VIDEO_CALL:o={xmaContentType:"xma_rtc_missed_video"};break;case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.RTC_GROUP_AUDIO_CALL:o={xmaContentType:"xma_rtc_missed_group_audio"};break;case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.RTC_GROUP_VIDEO_CALL:o={xmaContentType:"xma_rtc_missed_group_video"};break;default:o={height:e.previewHeight!=null?d("I64").of_int32(e.previewHeight):void 0,width:e.previewWidth!=null?d("I64").of_int32(e.previewWidth):void 0,xmaContentType:"xma_web_url"};break}return a.table("attachments").add({accessibilitySummaryText:void 0,actionUrl:void 0,attachmentCta1Id:m.length>0?m[0]:void 0,attachmentCta2Id:m.length>1?m[1]:void 0,attachmentCta3Id:m.length>2?m[2]:void 0,attachmentFbid:g,attachmentIndex:c("bs_caml_int64").zero,attachmentLoggingType:void 0,attachmentType:d("MessagingAttachmentType.bs").xma,attributionAppIcon:void 0,attributionAppIconFallback:void 0,attributionAppIconUrlExpirationTimestampMs:void 0,attributionAppId:void 0,attributionAppName:void 0,authorityLevel:c("bs_caml_int64").zero,avatarCount:void 0,avatarViewAccessibilityLabel:void 0,avatarViewSize:void 0,avatarViewTitleList:void 0,avatarViewUrlExpirationTimestampList:void 0,avatarViewUrlFallbackList:void 0,avatarViewUrlList:void 0,captionBodyText:void 0,cta1Title:i(e.ctas,1),cta1Type:h(e.ctas,1),cta2Title:i(e.ctas,2),cta2Type:h(e.ctas,2),cta3Title:i(e.ctas,3),cta3Type:h(e.ctas,3),dashManifest:void 0,decryptionKey:void 0,defaultCtaId:b[0],defaultCtaTitle:c("bs_belt_Option").getWithDefault(c("bs_belt_Option").map(e.defaultCTA,function(a){return a.title})),defaultCtaType:o.xmaContentType,descriptionText:void 0,ephemeralMediaState:void 0,faviconUrl:void 0,faviconUrlExpirationTimestampMs:void 0,faviconUrlFallback:void 0,filename:void 0,filesize:e.filesize!=null?d("I64").of_int32(e.filesize):void 0,gatingTitle:void 0,gatingType:e.overlayIconGlyph!=null?String(e.overlayIconGlyph):void 0,hasMedia:!1,hasXma:!0,headerImageUrl:void 0,headerImageUrlExpirationTimestampMs:void 0,headerImageUrlFallback:void 0,headerImageUrlMimeType:void 0,headerTitle:e.headerTitle,imageUrl:void 0,imageUrlExpirationTimestampMs:void 0,imageUrlFallback:void 0,imageUrlMimeType:void 0,isBorderless:void 0,isPreviewImage:void 0,isSharable:!0,listItemAccessibilityText1:void 0,listItemAccessibilityText2:void 0,listItemAccessibilityText3:void 0,listItemContactUrlExpirationTimestampList1:void 0,listItemContactUrlExpirationTimestampList2:void 0,listItemContactUrlExpirationTimestampList3:void 0,listItemContactUrlFallbackList1:void 0,listItemContactUrlFallbackList2:void 0,listItemContactUrlFallbackList3:void 0,listItemContactUrlList1:void 0,listItemContactUrlList2:void 0,listItemContactUrlList3:void 0,listItemId1:void 0,listItemId2:void 0,listItemId3:void 0,listItemProfilePictureUrl1:void 0,listItemProfilePictureUrl2:void 0,listItemProfilePictureUrl3:void 0,listItemProfilePictureUrlExpirationTimestamp1:void 0,listItemProfilePictureUrlExpirationTimestamp2:void 0,listItemProfilePictureUrlExpirationTimestamp3:void 0,listItemProfilePictureUrlFallback1:void 0,listItemProfilePictureUrlFallback2:void 0,listItemProfilePictureUrlFallback3:void 0,listItemProgressBarFilledPercentage1:void 0,listItemProgressBarFilledPercentage2:void 0,listItemProgressBarFilledPercentage3:void 0,listItemsDescriptionSubtitleText:void 0,listItemsDescriptionText:void 0,listItemsId:void 0,listItemsSecondaryDescriptionText:void 0,listItemTitleText1:void 0,listItemTitleText2:void 0,listItemTitleText3:void 0,localPlayableUrl:void 0,maxSubtitleNumOfLines:e.maxSubtitleNumOfLines!=null?d("I64").of_int32(e.maxSubtitleNumOfLines):void 0,maxTitleNumOfLines:e.maxTitleNumOfLines!=null?d("I64").of_int32(e.maxTitleNumOfLines):void 0,messageId:l,miniPreview:void 0,offlineAttachmentId:g,originalFileHash:void 0,originalPageSenderId:void 0,playableDurationMs:void 0,playableUrl:void 0,playableUrlExpirationTimestampMs:void 0,playableUrlFallback:void 0,playableUrlMimeType:void 0,preheaderText:void 0,previewHeight:o.height,previewHeightLarge:e.previewHeightLarge!=null?d("I64").of_int32(e.previewHeightLarge):void 0,previewImageDecorationType:k(e.targetType),previewUrl:void 0,previewUrlExpirationTimestampMs:void 0,previewUrlFallback:void 0,previewUrlLarge:void 0,previewUrlMimeType:void 0,previewWidth:o.width,previewWidthLarge:e.previewWidthLarge!=null?d("I64").of_int32(e.previewWidthLarge):void 0,samplingFrequencyHz:void 0,shouldAutoplayVideo:void 0,shouldHighlightHeaderTitleInTitle:void 0,shouldRespectServerPreviewSize:void 0,sourceText:void 0,subtitleIconUrl:void 0,subtitleText:e.subtitleText,targetId:void 0,threadKey:f,timestampMs:n,titleText:e.titleText,viewerSeenTimestampMs:void 0,waveformData:void 0,xmaLayoutType:e.xmaLayoutType!=null?j(e.xmaLayoutType):void 0,xmasTemplateType:e.xmaLayoutType!=null?j(e.xmaLayoutType):void 0})});else return b("Promise").resolve()})}function e(a,b){return l(a,b).then(function(a){})}g.getCTAType=h;g.getCTATitle=i;g.getLSXMALayoutType=j;g.getLSXMATemplateType=a;g.getLSPreviewImageDecorationType=k;g.call=e}),98);
__d("MAWBridgeDeleteGroupInviteHandler",["MAWThreadId","Promise","ReQL"],(function(a,b,c,d,e,f,g){"use strict";function a(a,c){return d("MAWThreadId").toThreadKeyMaybe(a,c.threadId).then(function(c){return c==null?b("Promise").resolve():d("ReQL").toArrayAsync(d("ReQL").fromTableAscending(a.table("group_invites")).getKeyRange(c)).then(function(c){return c.reduce(function(b,c){return b.then(function(){return a.table("group_invites")["delete"]({hd:c.threadKey,tl:{hd:c.inviterId,tl:{hd:c.inviteeId,tl:0}}})})},b("Promise").resolve(void 0))})})}g["default"]=a}),98);
__d("MAWBridgeDeleteMessageRangesV2Handler",["I64","MAWThreadId","regeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";function a(a,c){var e;return b("regeneratorRuntime").async(function(f){while(1)switch(f.prev=f.next){case 0:f.next=2;return b("regeneratorRuntime").awrap(d("MAWThreadId").toThreadKeyMaybe(a,c.threadId));case 2:e=f.sent;if(!(e==null)){f.next=5;break}return f.abrupt("return");case 5:return f.abrupt("return",a.table("messages_ranges_v2__generated")["delete"]({hd:e,tl:{hd:d("I64").of_float(c.minTimestampMs),tl:{hd:c.minMsgId,tl:0}}}));case 6:case"end":return f.stop()}},null,this)}g.deleteMessageRangesV2=a}),98);
__d("MAWBridgeDeleteMessagesHandler",["MAWThreadId","MAWTimeUtils","ReQL","regeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";function a(a,c){var e,f,g,h,i,j;return b("regeneratorRuntime").async(function(k){while(1)switch(k.prev=k.next){case 0:k.next=2;return b("regeneratorRuntime").awrap(d("MAWThreadId").toThreadKeyMaybe(a,c.threadId));case 2:e=k.sent;if(!(e!==void 0)){k.next=20;break}f=c.messages,g=Array.isArray(f),h=0,f=g?f:f[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();case 5:if(!g){k.next=11;break}if(!(h>=f.length)){k.next=8;break}return k.abrupt("break",20);case 8:i=f[h++];k.next=15;break;case 11:h=f.next();if(!h.done){k.next=14;break}return k.abrupt("break",20);case 14:i=h.value;case 15:j=i;k.next=18;return b("regeneratorRuntime").awrap(a.table("messages")["delete"](d("ReQL").key(e,d("MAWTimeUtils").toTimestamp(j.ts),j.msgId)));case 18:k.next=5;break;case 20:case"end":return k.stop()}},null,this)}g["default"]=a}),98);
__d("MAWBridgeDeleteReactionHandler",["I64","MAWThreadId","regeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";function a(a,c){var e;return b("regeneratorRuntime").async(function(f){while(1)switch(f.prev=f.next){case 0:f.next=2;return b("regeneratorRuntime").awrap(d("MAWThreadId").toThreadKeyMaybe(a,c.threadId));case 2:e=f.sent;if(!(e!==void 0)){f.next=5;break}return f.abrupt("return",a.table("reactions")["delete"]({hd:e,tl:{hd:c.messageId,tl:{hd:d("I64").of_string(c.actorId),tl:0}}}));case 5:case"end":return f.stop()}},null,this)}g.deleteReaction=a}),98);
__d("MAWBridgeEphemeralSettingsUpdatedForUIHandler",["Promise"],(function(a,b,c,d,e,f){"use strict";function a(a,c){return b("Promise").resolve()}f.call=a}),66);
__d("MAWBridgeGroupInfoUpdatedHandler.bs",["MAWThreadId.bs","Promise","ReQL.bs","bs_caml_option"],(function(a,b,c,d,e,f,g){"use strict";function h(a,e){return d("MAWThreadId.bs").toThreadKeyMaybe(a,e.threadId).then(function(f){if(f===void 0)return b("Promise").resolve();var g=e.threadName,h=g==null?void 0:c("bs_caml_option").some(g);return d("ReQL.bs").first(d("ReQL.bs").getKeyRange(d("ReQL.bs").fromTableAscending(a.table("threads")),{hd:f,tl:0})).then(function(c){if(c===void 0)return b("Promise").resolve();c=babelHelpers["extends"]({},c,{threadName:h});return a.table("threads").put(c)})})}function a(a,b){return h(a,b).then(function(a){})}g.call=a}),98);
__d("MAWBridgeGroupInviteUpdateHandler.bs",["MAWThreadId.bs","MAWTimeUtils","MAWUpdateLSThreadCapabilities.bs","Promise","bs_caml_format"],(function(a,b,c,d,e,f,g){"use strict";function h(a,e){return d("MAWThreadId.bs").toThreadKeyMaybe(a,e.threadId).then(function(f){if(f===void 0)return b("Promise").resolve();var g=c("bs_caml_format").caml_int64_of_string(e.inviterId);return a.table("group_invites").put({caption:e.caption!=null?e.caption:void 0,inviteCode:e.inviteCode,inviteeId:c("bs_caml_format").caml_int64_of_string(e.inviteeId),inviteExpirationTimestampMs:d("MAWTimeUtils").toTimestamp(e.inviteExpireTs),inviterId:g,threadKey:f}).then(function(b){return d("MAWUpdateLSThreadCapabilities.bs").setGroupInviteTxn(a,f,g)})})}function a(a,b){return h(a,b).then(function(a){})}g.call=a}),98);
__d("MAWBridgeInitOfflineQueueSyncCompleteHandler.bs",["CurrentLocale","LSDict","LSJson","LSLogHistory","LSSyncChannel.bs","LSSyncStatus.bs","MAWInitSyncComplete.bs","bs_caml_int64"],(function(a,b,c,d,e,f,g){"use strict";var h=[2328,1316134911];function i(a){return a.table("sync_groups").put({canIgnoreTimestamp:!1,currentCursor:void 0,dataTraceId:void 0,groupId:d("MAWInitSyncComplete.bs").id,initTraceTimestampMs:void 0,lastSyncCompletedTimestampMs:void 0,lastSyncRequestTimestampMs:c("bs_caml_int64").zero,minTimeToSyncTimestampMs:h,priority:c("bs_caml_int64").zero,regionHint:void 0,sendSyncParams:!0,syncChannel:d("LSSyncChannel.bs").mqtt,syncParams:d("LSJson").stringify(new(c("LSDict"))([["locale",c("CurrentLocale").get()]])),syncStatus:d("LSSyncStatus.bs").complete})}function a(a){d("LSLogHistory").log("Init Offline Queue Sync Complete","debug");return i(a)}g.neverSyncTimestamp=h;g.finishOfflineArmadilloSyncCursor=i;g.call=a}),98);
__d("MAWBridgeInitOfflineQueueSyncProgressHandler.bs",["Promise"],(function(a,b,c,d,e,f){"use strict";function a(a,c){return b("Promise").resolve()}f.call=a}),66);
__d("MAWBridgeInitOfflineQueueSyncStartHandler.bs",["CurrentLocale","LSDict","LSJson","LSLogHistory","LSSyncChannel.bs","LSSyncStatus.bs","MAWInitSyncComplete.bs","bs_caml_int64"],(function(a,b,c,d,e,f,g){"use strict";var h=[2328,1316134911];function i(a){return a.table("sync_groups").put({canIgnoreTimestamp:!1,currentCursor:void 0,dataTraceId:void 0,groupId:d("MAWInitSyncComplete.bs").id,initTraceTimestampMs:void 0,lastSyncCompletedTimestampMs:void 0,lastSyncRequestTimestampMs:c("bs_caml_int64").zero,minTimeToSyncTimestampMs:h,priority:c("bs_caml_int64").zero,regionHint:void 0,sendSyncParams:!0,syncChannel:d("LSSyncChannel.bs").mqtt,syncParams:d("LSJson").stringify(new(c("LSDict"))([["locale",c("CurrentLocale").get()]])),syncStatus:d("LSSyncStatus.bs").paging})}function a(a,b){d("LSLogHistory").log("Init Offline Queue Sync Start","debug");return i(a)}g.neverSyncTimestamp=h;g.initOfflineArmadilloSyncCursor=i;g.call=a}),98);
__d("MWChatFetchThreadMessageCounts",["I64","Promise","ReQL","regeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";function a(a){var c,e,f;return b("regeneratorRuntime").async(function(g){while(1)switch(g.prev=g.next){case 0:c={};g.next=3;return b("regeneratorRuntime").awrap(d("ReQL").toArrayAsync(d("ReQL").fromTableAscending(a.table("threads")).filter(function(a){return d("I64").to_int32(a.threadType)===16||d("I64").to_int32(a.threadType)===15}).map(function(a){return a.threadKey})));case 3:e=g.sent;g.next=6;return b("regeneratorRuntime").awrap(b("Promise").all(e.map(function(b){return d("ReQL").toArrayAsync(d("ReQL").fromTableAscending(a.table("messages")).getKeyRange(b).filter(function(a){return!a.isAdminMessage}))})));case 6:f=g.sent;e.forEach(function(a,b){c[d("I64").to_string(a)]=f[b].length});return g.abrupt("return",c);case 9:case"end":return g.stop()}},null,this)}function c(a,c){var e;return b("regeneratorRuntime").async(function(f){while(1)switch(f.prev=f.next){case 0:f.next=2;return b("regeneratorRuntime").awrap(d("ReQL").toArrayAsync(d("ReQL").fromTableAscending(a.table("messages")).getKeyRange(c).filter(function(a){return!a.isAdminMessage})));case 2:e=f.sent;return f.abrupt("return",e.length);case 4:case"end":return f.stop()}},null,this)}g.fetchArmadilloThreadMessageCounts=a;g.fetchArmadilloThreadMessageCount=c}),98);
__d("MWChatDataLossCheckerUtil",["Crypto.bs","FBLogger","I64","MAWBridgeSendAndReceive","MAWThreadId.bs","MWChatFetchThreadMessageCounts","Promise","QuickPerformanceLogger","WebStorage","gkx","promiseDone","qex","qpl","regeneratorRuntime","useDataLossStatisticsStorageListener"],(function(a,b,c,d,e,f,g){"use strict";function h(a){a=Array.from(new Uint8Array(a));return a.map(function(a){return a.toString(16).padStart(2,"0")}).join("")}function i(a){var e,f,g;return b("regeneratorRuntime").async(function(i){while(1)switch(i.prev=i.next){case 0:i.prev=0;if(!c("qex")._("460")){i.next=3;break}return i.abrupt("return",a);case 3:e=new TextEncoder();f=e.encode(a).buffer;i.next=7;return b("regeneratorRuntime").awrap(d("Crypto.bs").digest("SHA-256",f));case 7:g=i.sent;return i.abrupt("return",h(g));case 11:i.prev=11;i.t0=i["catch"](0);return i.abrupt("return",i.t0);case 14:case"end":return i.stop()}},null,this,[[0,11]])}function j(a){var d,e,f,g,h,j,k;return b("regeneratorRuntime").async(function(l){while(1)switch(l.prev=l.next){case 0:d=a.currentIDBCnt,e=a.currentMsgCnt,f=a.logThreadId,g=a.prevMsgCnt,h=a.qplEvent,j=a.threadId;if(!(f!==void 0&&f)){l.next=8;break}l.next=4;return b("regeneratorRuntime").awrap(i(j));case 4:k=l.sent;d!==void 0?(c("QuickPerformanceLogger").markerStartFromNavStart(h),c("QuickPerformanceLogger").markerAnnotate(h,{"int":{current_idb_count:d,current_msg_count:e,prev_msg_count:g},string:{encrypted_threadId:k}}),c("QuickPerformanceLogger").markerEnd(h,2)):(c("QuickPerformanceLogger").markerStartFromNavStart(h),c("QuickPerformanceLogger").markerAnnotate(h,{"int":{current_msg_count:e,prev_msg_count:g},string:{encrypted_threadId:k}}),c("QuickPerformanceLogger").markerEnd(h,2));l.next=9;break;case 8:d!==void 0?(c("QuickPerformanceLogger").markerStartFromNavStart(h),c("QuickPerformanceLogger").markerAnnotate(h,{"int":{current_idb_count:d,current_msg_count:e,prev_msg_count:g}}),c("QuickPerformanceLogger").markerEnd(h,2)):(c("QuickPerformanceLogger").markerStartFromNavStart(h),c("QuickPerformanceLogger").markerAnnotate(h,{"int":{current_msg_count:e,prev_msg_count:g}}),c("QuickPerformanceLogger").markerEnd(h,2));case 9:case"end":return l.stop()}},null,this)}function k(a){var e,f,g,h,i,k,l,m;return b("regeneratorRuntime").async(function(n){while(1)switch(n.prev=n.next){case 0:e=a.currentMsgCnt,f=a.db,g=a.logThreadId,h=a.prevMsgCnt,i=a.qplEvent,k=a.threadId;if(c("gkx")("7965")){n.next=3;break}return n.abrupt("return",j({currentMsgCnt:e,logThreadId:g,prevMsgCnt:h,qplEvent:i,threadId:k}));case 3:l=-100;n.prev=4;n.next=7;return b("regeneratorRuntime").awrap(d("MAWThreadId.bs").ofThreadKey(f,d("I64").of_string(k)));case 7:m=n.sent;if(!(m.TAG!==0)){n.next=11;break}c("FBLogger")("labyrinth").warn("Fetched Invalid IndexedDB thread id");return n.abrupt("return",j({currentMsgCnt:e,logThreadId:g,prevMsgCnt:h,qplEvent:i,threadId:k}));case 11:l=m._0;n.next=18;break;case 14:n.prev=14;n.t0=n["catch"](4);c("FBLogger")("labyrinth").catching(n.t0).warn("Failed to fetch indexedDB thread Id");return n.abrupt("return",j({currentMsgCnt:e,logThreadId:g,prevMsgCnt:h,qplEvent:i,threadId:k}));case 18:c("promiseDone")(d("MAWBridgeSendAndReceive").sendAndReceive("backend","fetchArmadilloThreadMessageCount",{threadId:l}).then(function(a){return j({currentIDBCnt:a,currentMsgCnt:e,logThreadId:g,prevMsgCnt:h,qplEvent:i,threadId:k})})["catch"](function(a){c("FBLogger")("labyrinth").catching(a).warn("Failed to fetch IndexDB message count");return j({currentMsgCnt:e,logThreadId:g,prevMsgCnt:h,qplEvent:i,threadId:k})}));case 19:case"end":return n.stop()}},null,this,[[4,14]])}function a(a,e){var f,g,h,i,j;return b("regeneratorRuntime").async(function(k){while(1)switch(k.prev=k.next){case 0:k.prev=0;k.next=3;return b("regeneratorRuntime").awrap(d("MWChatFetchThreadMessageCounts").fetchArmadilloThreadMessageCount(a,e));case 3:g=k.sent;h=c("WebStorage").getAllowlistedKeyFromLocalStorage(d("useDataLossStatisticsStorageListener").DATA_LOSS_STATISTICS_STORAGE_KEY);if(!(h==null)){k.next=7;break}return k.abrupt("return",{isThreadMissingMessages:!1});case 7:i=JSON.parse(h);j=(f=i[d("I64").to_string(e)])!=null?f:null;if(!(j==null)){k.next=11;break}return k.abrupt("return",{isThreadMissingMessages:!1});case 11:if(!(j>0&&g===0)){k.next=13;break}return k.abrupt("return",{currCount:g,isThreadMissingMessages:!0,prevCount:j});case 13:return k.abrupt("return",{isThreadMissingMessages:!1});case 16:k.prev=16;k.t0=k["catch"](0);c("FBLogger")("labyrinth").catching(k.t0).warn("Failed to check for data loss");return k.abrupt("return",{isThreadMissingMessages:!1});case 20:case"end":return k.stop()}},null,this,[[0,16]])}function e(a){return d("MWChatFetchThreadMessageCounts").fetchArmadilloThreadMessageCounts(a).then(function(a){var e=c("WebStorage").getAllowlistedKeyFromLocalStorage(d("useDataLossStatisticsStorageListener").DATA_LOSS_STATISTICS_STORAGE_KEY);if(e==null)return b("Promise").resolve(null);e=JSON.parse(e);return b("Promise").resolve({current:a,previous:e})}).then(function(c){if(c==null)return b("Promise").resolve();var d=c.current;c=c.previous;return l(c,d,a)})["catch"](function(a){return c("FBLogger")("labyrinth").catching(a).warn("Failed to check for data loss")})}function l(a,d,e){var f,g,h,i,j,l;return b("regeneratorRuntime").async(function(m){while(1)switch(m.prev=m.next){case 0:f=[];for(g in a)Object.prototype.hasOwnProperty.call(d,g)&&f.push(g);h=[];for(i=0;i<f.length;i++)j=f[i],l={currentMsgCnt:d[j],db:e,prevMsgCnt:a[j],threadId:j},a[j]>0&&d[j]===0?(h.push(k(babelHelpers["extends"]({},l,{qplEvent:c("qpl")._(717553665,"1183")}))),h.push(k(babelHelpers["extends"]({},l,{logThreadId:!0,qplEvent:c("qpl")._(717562243,"1358")})))):(h.push(k(babelHelpers["extends"]({},l,{qplEvent:c("qpl")._(717553666,"1184")}))),h.push(k(babelHelpers["extends"]({},l,{logThreadId:!0,qplEvent:c("qpl")._(717556541,"1361")}))));m.next=6;return b("regeneratorRuntime").awrap(b("Promise").all(h));case 6:case"end":return m.stop()}},null,this)}function f(a){var b=function(b){c("promiseDone")(i(b).then(function(d){c("QuickPerformanceLogger").markerStartFromNavStart(c("qpl")._(717567419,"1383")),c("QuickPerformanceLogger").markerAnnotate(c("qpl")._(717567419,"1383"),{string:{encryptedThreadId:d,msg_count:a[b].toString()}}),c("QuickPerformanceLogger").markerEnd(c("qpl")._(717567419,"1383"),2)}))};for(var d in a)b(d)}g.qplLog=k;g.checkIsThreadMissingMessages=a;g.fetchCountsAndLogDataLoss=e;g.logThreadCompleteDataLoss=l;g.logLocalStatistics=f}),98);
__d("useDataLossStatisticsStorageListener",["LSDatabaseDeferred","MWChatDataLossCheckerUtil","MWChatFetchThreadMessageCounts","Visibility","WebStorage","promiseDone","qex","react"],(function(a,b,c,d,e,f,g){"use strict";var h=d("react").useEffect,i="armadillo_msgr_data_loss_stats";function a(){h(function(){var a;window.setTimeout(function(){a=c("Visibility").addListener(c("Visibility").HIDDEN,function(){c("promiseDone")(d("LSDatabaseDeferred").db.then(function(a){return d("MWChatFetchThreadMessageCounts").fetchArmadilloThreadMessageCounts(a).then(function(a){c("WebStorage").setItemGuarded(c("WebStorage").getLocalStorage(),i,JSON.stringify(a)),c("qex")._("1259")&&d("MWChatDataLossCheckerUtil").logLocalStatistics(a)})}))})},3e4);return function(){var b;(b=a)==null?void 0:b.remove()}},[])}g.DATA_LOSS_STATISTICS_STORAGE_KEY=i;g.useDataLossStatisticsStorageListener=a}),98);
__d("MAWBridgeInitSyncCompleteHandler.bs",["CurrentLocale","LSDict","LSJson","LSLogHistory","LSSyncChannel.bs","LSSyncStatus.bs","MAWInitSyncComplete.bs","MAWTTRC","MWChatDataLossCheckerUtil","Promise","QPLUserFlow","bs_caml_int64","gkx","qpl"],(function(a,b,c,d,e,f,g){"use strict";function h(a){return a.table("sync_groups").add({canIgnoreTimestamp:!1,currentCursor:void 0,dataTraceId:void 0,groupId:d("MAWInitSyncComplete.bs").id,initTraceTimestampMs:void 0,lastSyncCompletedTimestampMs:void 0,lastSyncRequestTimestampMs:c("bs_caml_int64").zero,minTimeToSyncTimestampMs:[2328,1316134911],priority:c("bs_caml_int64").zero,regionHint:void 0,sendSyncParams:!0,syncChannel:d("LSSyncChannel.bs").mqtt,syncParams:d("LSJson").stringify(new(c("LSDict"))([["locale",c("CurrentLocale").get()]])),syncStatus:d("LSSyncStatus.bs").complete})}function i(a){return a.table("network_requests").add({epochId:c("bs_caml_int64").neg_one,failureCount:c("bs_caml_int64").zero,lastDelayedRequestTimestampMs:void 0,lastSentTimestampMs:c("bs_caml_int64").zero,lastSyncRequestTimestampMs:c("bs_caml_int64").zero,networkTaskIdentifier:void 0,syncDatabaseId:d("MAWInitSyncComplete.bs").id,taskQueueName:""})}function a(a){d("LSLogHistory").log("Init Sync Complete","debug");d("MAWTTRC").markEvent("init_sync_received");c("QPLUserFlow").endSuccess(c("qpl")._(25300040,"1388"));return window.Promise.all([c("gkx")("4492")?d("MWChatDataLossCheckerUtil").fetchCountsAndLogDataLoss(a):b("Promise").resolve(),h(a),i(a)]).then(function(a){return b("Promise").resolve()})}g.completeLocalArmadilloSyncCursor=h;g.completeLocalArmadilloNetworkRequest=i;g.call=a}),98);
__d("MAWBridgeMediaExpiredHandler.bs",["MAWThreadId.bs","Promise"],(function(a,b,c,d,e,f,g){"use strict";function a(a,c){var e=String(c.mediaId);return d("MAWThreadId.bs").toThreadKeyMaybe(a,c.threadId).then(function(d){if(d!==void 0)return a.table("attachments")["delete"]({hd:d,tl:{hd:c.msgId,tl:{hd:e,tl:0}}});else return b("Promise").resolve()})}g.call=a}),98);
__d("MAWEphemeralMessageExpirationStorage.bs",["MAWBridgeDeleteMessagesHandler","bs_belt_Array","clearTimeout","promiseDone","setTimeout"],(function(a,b,c,d,e,f,g){"use strict";var h=new Map();function i(a,b,d){c("bs_belt_Array").forEach(b,function(b){var d=b.ts,e=b.chatId,f=b.msgId;f={msgId:f,threadId:e,ts:d};e=b.chatId;d=[f];b={messages:d,threadId:e};c("promiseDone")(c("MAWBridgeDeleteMessagesHandler")(a,b))});return h["delete"](d)}function j(a,b,d,e){return c("setTimeout")(function(c){i(a,b,d)},e)}function a(a,b,d,e){var f=h.get(d);b=f==null?[b]:(c("clearTimeout")(f.timeoutId),f.msgs.map(function(a){return a.msgId}).indexOf(b.msgId)===-1?(f.msgs.push(b),void 0):void 0,f.msgs);f=j(a,b,d,e);h.set(d,{expirationTs:d,msgs:b,timeoutId:f})}function b(a){var b=a.msgId;a=h.get(a.countdownTs);if(a==null)return;b=a.msgs.map(function(a){return a.msgId}).indexOf(b);if(b>-1){a.msgs.splice(b,1);return}}d=a;e=b;g.setMessageForExpiration=d;g.clearMessageFromExpiration=e}),98);
__d("MAWBridgeMsgClearCountdownHandler.bs",["MAWEphemeralMessageExpirationStorage.bs","Promise"],(function(a,b,c,d,e,f,g){"use strict";function a(a){d("MAWEphemeralMessageExpirationStorage.bs").clearMessageFromExpiration(a);return b("Promise").resolve()}g.call=a}),98);
__d("LSMessageUnsendabilityStatus.bs",["bs_caml_int64"],(function(a,b,c,d,e,f){"use strict";a=b("bs_caml_int64").zero;c=b("bs_caml_int64").one;d=[0,2];e=[0,3];b=[0,4];var g=[0,5],h=[0,6],i=[0,7],j=[0,8];f.canUnsend=a;f.denyLogMessage=c;f.denyTombstoneMessage=d;f.denyForNonSender=e;f.denyP2pPayment=b;f.denyStoryReaction=g;f.denyBlobAttachment=h;f.denyMessageNotFound=i;f.denyMessageInstagramDirectWriteRestriction=j}),null);
__d("LSMessageUnsendabilityStatus.re",["LSMessageUnsendabilityStatus.bs"],(function(a,b,c,d,e,f){c=(a=b("LSMessageUnsendabilityStatus.bs")).canUnsend;f.canUnsend=c;d=a.denyLogMessage;f.denyLogMessage=d;e=a.denyTombstoneMessage;f.denyTombstoneMessage=e;b=a.denyForNonSender;f.denyForNonSender=b;c=a.denyP2pPayment;f.denyP2pPayment=c;d=a.denyStoryReaction;f.denyStoryReaction=d;e=a.denyBlobAttachment;f.denyBlobAttachment=e;b=a.denyMessageNotFound;f.denyMessageNotFound=b;c=a.denyMessageInstagramDirectWriteRestriction;f.denyMessageInstagramDirectWriteRestriction=c}),null);
__d("LSContactGender",[],(function(a,b,c,d,e,f){a=Object.freeze({UNKNOWN:0,FEMALE:1,MALE:2,NEUTER:3});f["default"]=a}),66);
__d("LSContactIdType",[],(function(a,b,c,d,e,f){a=Object.freeze({UNKNOWN:0,FBID:1,SMS_LOCAL_ID:2});f["default"]=a}),66);
__d("LSContactViewerRelationship",[],(function(a,b,c,d,e,f){a=Object.freeze({UNKNOWN:0,NOT_CONTACT:1,CONTACT_OF_VIEWER:2,FACEBOOK_FRIEND:3,SOFT_CONTACT:4});f["default"]=a}),66);
__d("LSContactWorkForeignEntityType",[],(function(a,b,c,d,e,f){a=Object.freeze({UNKNOWN:0,FOREIGN:1,NOT_FOREIGN:2,NOT_FOREIGN_LIMITED:3});f["default"]=a}),66);
__d("MAWSubscribeToContactNames",["fbt","$InternalEnum","CurrentUser","Env","I64","LS.re","LSAuthorityLevel","LSContactBlockedByViewerStatus","LSContactGender","LSContactIdType","LSContactType","LSContactViewerRelationship","LSContactWorkForeignEntityType","LSVerifyContactRowExists","Promise","ReQL","Run","SubscriptionsHandler","gkx","promiseDone","regeneratorRuntime"],(function(a,b,c,d,e,f,g,h){"use strict";var i=b("$InternalEnum").Mirrored(["FIRST_NAME","FULL_NAME"]),j=new Map(),k=Boolean(c("Env").isMessengerDotComOnComet)?"Messenger":c("gkx")("1902661")?"Instagram":"Facebook";function l(){return h._("__JHASH__9kaBCOd2SjE__JHASH__",[h._param("Platform Name",k)]).toString()}function a(a,b){return(a=a.get(b))!=null?a:l()}function m(a,b){return b===i.FULL_NAME?a==null?void 0:a.name:a==null?void 0:a.firstName}function n(a,b,e,f){var g=d("ReQL").fromTableAscending(a.table("contacts")).getKeyRange(d("I64").of_string(b)).subscribe(function(a,b){if(b.operation==="delete")return;a=m(b.value,e);if(a==null||a==="")return;c("promiseDone")(f(a),g)});return g}function o(a,c){return b("Promise").all(c.map(function(c){var e;return b("regeneratorRuntime").async(function(f){while(1)switch(f.prev=f.next){case 0:f.next=2;return b("regeneratorRuntime").awrap(d("ReQL").firstAsync(d("ReQL").fromTableAscending(a.table("contacts")).getKeyRange(d("I64").of_string(c))));case 2:e=f.sent;return f.abrupt("return",e==null||e.name===""?c:null);case 4:case"end":return f.stop()}},null,this)})).then(function(a){return a.filter(Boolean)})}function p(a,b,c){return d("ReQL").firstAsync(d("ReQL").fromTableAscending(a.table("contacts")).getKeyRange(d("I64").of_string(b))).then(function(a){return m(a,c)})}function q(a,b){return c("LSVerifyContactRowExists")(d("I64").of_string(b),d("I64").of_int32(c("LSContactIdType").FBID),void 0,void 0,d("I64").of_int32(c("LSContactType").USER),void 0,void 0,void 0,void 0,!1,!1,d("I64").of_int32(c("LSContactBlockedByViewerStatus").UNBLOCKED),void 0,b===c("CurrentUser").getID(),d("I64").of_int32(c("LSAuthorityLevel").OPTIMISTIC),void 0,void 0,d("I64").of_int32(c("LSContactWorkForeignEntityType").UNKNOWN),d("I64").of_int32(c("LSContactGender").UNKNOWN),d("I64").of_int32(c("LSContactViewerRelationship").UNKNOWN),void 0,c("LS.re").make(a))}function r(a,c){var d;return b("regeneratorRuntime").async(function(e){while(1)switch(e.prev=e.next){case 0:e.next=2;return b("regeneratorRuntime").awrap(o(a,c));case 2:d=e.sent;e.next=5;return b("regeneratorRuntime").awrap(b("Promise").all(d.map(function(b){return q(a,b)})));case 5:case"end":return e.stop()}},null,this)}function s(a){var b=function(){var b=j.get(a);b==null?(b=new(c("SubscriptionsHandler"))(),j.set(a,b)):(b.release(),b.engage());return b}(),e=d("Run").onBeforeUnload(function(){j.forEach(function(a){return a.release()}),j.clear()},!1);return{add:function(a){b.addSubscriptions({unsubscribe:a})},release:function(){e.remove(),b.release(),j["delete"](a)}}}function t(a){var c,d,e,f,g,h,j,k,m,o,q;return b("regeneratorRuntime").async(function(t){while(1)switch(t.prev=t.next){case 0:c=a.contactIDs,d=a.db,e=a.nameMode,f=e===void 0?i.FIRST_NAME:e,g=a.onResolve,h=a.subscriptionKey,j=a.txn;t.next=3;return b("regeneratorRuntime").awrap(r(j,c));case 3:k=new Map();m=s(h);o=function(a,b){b=(b=k.get(b))!=null?b:l();return[a,b]};t.next=8;return b("regeneratorRuntime").awrap(b("Promise").all(c.map(function(a,e){var h,i;return b("regeneratorRuntime").async(function(q){while(1)switch(q.prev=q.next){case 0:q.next=2;return b("regeneratorRuntime").awrap(p(j,a,f));case 2:h=q.sent;if(!(h!=null&&h!=="")){q.next=6;break}k.set(e,h);return q.abrupt("return",[a,h]);case 6:g!=null&&(i=n(d,a,f,function(a){return b("regeneratorRuntime").async(function(d){while(1)switch(d.prev=d.next){case 0:i();k.set(e,a);if(!(k.size===c.length)){d.next=6;break}m.release();d.next=6;return b("regeneratorRuntime").awrap(g(new Map(c.map(o))));case 6:case"end":return d.stop()}},null,this)}),m.add(i));return q.abrupt("return",[a,l()]);case 8:case"end":return q.stop()}},null,this)})));case 8:q=t.sent;return t.abrupt("return",new Map(q));case 10:case"end":return t.stop()}},null,this)}function e(a){var b=a.contactIDs,c=a.onResolve;a=babelHelpers.objectWithoutPropertiesLoose(a,["contactIDs","onResolve"]);var d=function(a){return b.map(function(b){return(b=a.get(b))!=null?b:l()})},e=function(){return c==null?void 0:function(a){return c(d(a))}}();return t(babelHelpers["extends"]({},a,{contactIDs:b,onResolve:e})).then(d)}g.ContactNameMode=i;g.getUnknownUser=l;g.getContactNameFromLookup=a;g.getMissingContactNames=o;g.getContactNameFromContactID=p;g.fillMissingContacts=r;g.genContacts=t;g.getContactNamesFromContactIDs=e}),98);
__d("MAWBridgeBuildAdminMsg",["I64","MAWAdminMsg","MAWAdminMsgNormalized","MAWLocalizationType","MAWSubscribeToContactNames","MAWUpdateMsg","regeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";function a(a,c,e,f,g,h,i,j){var k,l,m,n,o;return b("regeneratorRuntime").async(function(p){while(1)switch(p.prev=p.next){case 0:j===void 0&&(j=0);k=d("MAWAdminMsgNormalized").deconstructContactIdsFromAdminContent(i,h),l=k.contactIds,m=k.contents;if(!(j===1)){p.next=8;break}n=i===d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_NAMED_GROUP?d("MAWSubscribeToContactNames").ContactNameMode.FIRST_NAME:d("MAWSubscribeToContactNames").ContactNameMode.FULL_NAME;p.next=6;return b("regeneratorRuntime").awrap(d("MAWSubscribeToContactNames").getContactNamesFromContactIDs({contactIDs:[].concat(l),db:a,nameMode:n,onResolve:function(b){b=d("MAWAdminMsg").buildLocalizedString(m,b,i);return d("MAWUpdateMsg").mutateThreadText(a,e,f,g,{text:b})},subscriptionKey:d("I64").to_string(f),txn:c}));case 6:o=p.sent;return p.abrupt("return",d("MAWAdminMsg").buildLocalizedString(m,o,i));case 8:return p.abrupt("return",d("MAWAdminMsg").buildLocalizedString(m,l,i));case 9:case"end":return p.stop()}},null,this)}g.buildAdminMsgText=a}),98);
__d("mapPull",[],(function(a,b,c,d,e,f){function a(a,b,c){var d=new Map();for(var a=a,e=Array.isArray(a),f=0,a=e?a:a[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var g;if(e){if(f>=a.length)break;g=a[f++]}else{f=a.next();if(f.done)break;g=f.value}g=g;d.set(c(g),b(g))}return d}f["default"]=a}),66);
__d("MAWBridgeBuildMsgMentions",["MAWSubscribeToContactNames","WAJids","emptyFunction","fillArray","mapPull","regeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";function h(a){return a.length>0?a.join(","):void 0}function i(a,b){return a.index-b.index}function j(a,b){return a==null||a===""?a:Array.from(b).reduce(function(a,b){var c=b[0];b=b[1];return a.replaceAll(c,b)},a)}function k(a,b){return a==null||a===""?[]:Array.from(b.keys()).flatMap(function(b){return Array.from(a.matchAll(b))}).sort(i)}function l(a,b,e,f){e=c("mapPull")(e,function(a){var c=a[0];a[1];return d("MAWSubscribeToContactNames").getContactNameFromLookup(b,c)},function(a){a[0];a=a[1];return a});var g=k(a,e),i=[],l=[],m=[],n=0;for(var o=g,p=Array.isArray(o),q=0,o=p?o:o[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var r;if(p){if(q>=o.length)break;r=o[q++]}else{q=o.next();if(q.done)break;r=q.value}r=r;var s=d("WAJids").unsafeCoerceToUserJid(r[0]);i.push(d("WAJids").userIdFromJid(s));var t=d("MAWSubscribeToContactNames").getContactNameFromLookup(e,s);l.push(t.length);m.push(r.index+n);n+=t.length-s.length}r=c("fillArray")(g.length,"p");return{mentionIds:h(i),mentionLengths:h(l),mentionOffsets:h(m),mentionTypes:h(r),replyMessageText:j(f,e),text:j(a,e)}}function m(a,b,c,e){a=l(a,c,e);e=a.text;a=b.map(function(a){return d("MAWSubscribeToContactNames").getContactNameFromLookup(c,a)});return[e,a]}function a(a,e,f,g,h,i,j){var k,m;return b("regeneratorRuntime").async(function(n){while(1)switch(n.prev=n.next){case 0:k=c("mapPull")(h,c("emptyFunction").thatReturnsArgument,d("WAJids").userIdFromJid);n.next=3;return b("regeneratorRuntime").awrap(d("MAWSubscribeToContactNames").genContacts({contactIDs:Array.from(k.keys()),db:a,nameMode:d("MAWSubscribeToContactNames").ContactNameMode.FULL_NAME,onResolve:function(a){a=l(g,a,k,j);return i(a)},subscriptionKey:f,txn:e}));case 3:m=n.sent;return n.abrupt("return",l(g,m,k,j));case 5:case"end":return n.stop()}},null,this)}function e(a,e,f,g,h,i,j){var k,l,n,o;return b("regeneratorRuntime").async(function(p){while(1)switch(p.prev=p.next){case 0:l=c("mapPull")((k=h)!=null?k:[],c("emptyFunction").thatReturnsArgument,d("WAJids").userIdFromJid);if(!(l.size===0||g==null||g==="")){p.next=6;break}p.next=4;return b("regeneratorRuntime").awrap(d("MAWSubscribeToContactNames").getContactNamesFromContactIDs({contactIDs:i,db:a,onResolve:function(a){return j([g,a])},subscriptionKey:f,txn:e}));case 4:n=p.sent;return p.abrupt("return",[g,n]);case 6:p.next=8;return b("regeneratorRuntime").awrap(d("MAWSubscribeToContactNames").genContacts({contactIDs:[].concat(Array.from(l.keys()),i),db:a,nameMode:d("MAWSubscribeToContactNames").ContactNameMode.FULL_NAME,onResolve:function(a){a=m(g,i,a,l);return j(a)},subscriptionKey:f,txn:e}));case 8:o=p.sent;return p.abrupt("return",m(g,i,o,l));case 10:case"end":return p.stop()}},null,this)}g.buildMsgTextWithMentions=a;g.buildThreadSnippetWithMentions=e}),98);
__d("LSReplyMessageStatus",[],(function(a,b,c,d,e,f){a=Object.freeze({UNKNOWN:0,VALID:1,DELETED:2,TEMPORARY_UNAVAILABLE:3,EXPIRED:4});f["default"]=a}),66);
__d("MAWMsgReply",["fbt","LSReplyMessageStatus","MAWSubscribeToContactNames","MAWThreadId","MAWTimeUtils","ODS","Promise","ReQL","WAMsgType","err","regeneratorRuntime"],(function(a,b,c,d,e,f,g,h){"use strict";function i(a){var b=a.isAuthorMe,c=a.isDeletedMsg,d=a.isStoryReply;d=d===void 0?!1:d;var e=a.isStoryShare;e=e===void 0?!1:e;var f=a.recipientName,g=a.replySenderIsMe;g=g===void 0?!1:g;var i=a.replySenderIsRecepient;a=a.senderName;switch(!0){case b&&c:return h._("__JHASH__FzueDOoURT8__JHASH__");case b&&e:return h._("__JHASH__d4DLCdwDC03__JHASH__");case b&&g:return h._("__JHASH__GiGYAtipVIl__JHASH__");case b&&d:return f!=null?h._("__JHASH__ZkkDtvZx-as__JHASH__",[h._param("name",f)]):h._("__JHASH__GEUovmERkjj__JHASH__");case b:return f!=null?h._("__JHASH__eQLjVyXwwuH__JHASH__",[h._param("other_name",f)]):h._("__JHASH__NYU_gsfRGpq__JHASH__");case c:return h._("__JHASH__30kvLEU_B_p__JHASH__",[h._param("name",a)]);case i:return h._("__JHASH__RWi7lW394uo__JHASH__",[h._param("other",a)]);case e:return h._("__JHASH__JQwHPEO2e9j__JHASH__",[h._param("user",a)]);case g&&d:return h._("__JHASH__zc6GoZLyKDZ__JHASH__",[h._param("name",a)]);case g:return h._("__JHASH__uU6-xunUPnp__JHASH__",[h._param("other_name",a)]);default:return f!=null?h._("__JHASH__iOHMd6RP1E7__JHASH__",[h._param("other",a),h._param("other_name",f)]):h._("__JHASH__JL2f9yie2zt__JHASH__",[h._param("other",a)])}}function a(a,e,f){var g,h,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B;return b("regeneratorRuntime").async(function(C){while(1)switch(C.prev=C.next){case 0:h=f.chatId,l=f.isAuthorMe,m=f.isStoryReply,n=f.isStoryShare,o=n===void 0?!1:n,p=f.msgId,q=f.originalTs,r=f.replySenderIsMe,s=f.replySourceId,t=f.replyToUserId,u=f.sender,v=f.ts,w=f.type_;if(!(s==null&&!o)){C.next=3;break}return C.abrupt("return",b("Promise").resolve());case 3:if(!(t==null||u==null)){C.next=5;break}throw c("err")("Error getting reply snippet without replyToUserId or sender");case 5:x=d("MAWSubscribeToContactNames").getContactNameFromContactID(e,t,d("MAWSubscribeToContactNames").ContactNameMode.FIRST_NAME)==null;y=d("MAWSubscribeToContactNames").getContactNameFromContactID(e,u,d("MAWSubscribeToContactNames").ContactNameMode.FIRST_NAME)==null;d("ODS").bumpEntityKey(3185,"armadillo_reply","creating_reply_snippet");x&&y?d("ODS").bumpEntityKey(3185,"armadillo_reply","missing_both"):y?d("ODS").bumpEntityKey(3185,"armadillo_reply","missing_sender"):x&&d("ODS").bumpEntityKey(3185,"armadillo_reply","missing_reply_to");C.next=11;return b("regeneratorRuntime").awrap(d("MAWSubscribeToContactNames").getContactNamesFromContactIDs({contactIDs:[t,u],db:a,onResolve:function(b){var e,g=b[0];b=b[1];return k(a,h,d("MAWTimeUtils").toTimestamp(w===d("WAMsgType").MSG_TYPE.REVOKED?(e=q)!=null?e:v:v),p,(e=i({isAuthorMe:l,isDeletedMsg:j(f)===c("LSReplyMessageStatus").DELETED,isStoryReply:m,isStoryShare:o,recipientName:g,replySenderIsMe:r,replySenderIsRecepient:u===t,senderName:b}))==null?void 0:e.toString())},subscriptionKey:p,txn:e}));case 11:z=C.sent;A=z[0];B=z[1];return C.abrupt("return",b("Promise").resolve((g=i({isAuthorMe:l,isDeletedMsg:j(f)===c("LSReplyMessageStatus").DELETED,isStoryReply:m,isStoryShare:o,recipientName:x?void 0:A,replySenderIsMe:r,replySenderIsRecepient:u===t,senderName:B}))==null?void 0:g.toString()));case 15:case"end":return C.stop()}},null,this)}function j(a){a=a.replyStatusType;switch(a){case d("WAMsgType").MSG_TYPE.DELETE_FOR_ME:case d("WAMsgType").MSG_TYPE.REVOKED:return c("LSReplyMessageStatus").DELETED;case d("WAMsgType").MSG_TYPE.TEXT:case d("WAMsgType").MSG_TYPE.IMAGE:case d("WAMsgType").MSG_TYPE.VIDEO:case d("WAMsgType").MSG_TYPE.PTT:case d("WAMsgType").MSG_TYPE.ADMIN:case d("WAMsgType").MSG_TYPE.GIF:case d("WAMsgType").MSG_TYPE.STICKER:case d("WAMsgType").MSG_TYPE.XMA:return c("LSReplyMessageStatus").VALID;case d("WAMsgType").MSG_TYPE.FUTUREPROOF:case d("WAMsgType").MSG_TYPE.CIPHERTEXT:case d("WAMsgType").MSG_TYPE.UNAVAILABLE:return c("LSReplyMessageStatus").TEMPORARY_UNAVAILABLE;case d("WAMsgType").MSG_TYPE.EPHEMERAL_SCREENSHOT_ACTION:case d("WAMsgType").MSG_TYPE.EPHEMERAL_SETTING_ADMIN:case d("WAMsgType").MSG_TYPE.EPHEMERAL_SETTING_CHANGE_FROM_CURRENT_DEVICE:case d("WAMsgType").MSG_TYPE.EPHEMERAL_SYNC_RESPONSE:return c("LSReplyMessageStatus").UNKNOWN;case d("WAMsgType").MSG_TYPE.EXPIRED_EPHEMERAL:return c("LSReplyMessageStatus").EXPIRED;default:return void 0}}function k(a,c,e,f,g){var h;return b("regeneratorRuntime").async(function(i){while(1)switch(i.prev=i.next){case 0:i.next=2;return b("regeneratorRuntime").awrap(d("MAWThreadId").toThreadKeyMaybe(a,c));case 2:h=i.sent;if(!(h==null)){i.next=5;break}return i.abrupt("return",b("Promise").resolve());case 5:return i.abrupt("return",a.runInTransaction(function(a){var c,i;return b("regeneratorRuntime").async(function(j){while(1)switch(j.prev=j.next){case 0:c=a.table("messages");j.next=3;return b("regeneratorRuntime").awrap(d("ReQL").firstAsync(d("ReQL").fromTableAscending(c).getKeyRange(h,e,f)));case 3:i=j.sent;if(!i){j.next=7;break}j.next=7;return b("regeneratorRuntime").awrap(c.put(babelHelpers["extends"]({},i,{replySnippet:g})));case 7:case"end":return j.stop()}},null,this)},"readwrite"));case 6:case"end":return i.stop()}},null,this)}g.buildLocalizedReplySnippet=i;g.getReplySnippet=a;g.getReplyStatus=j}),98);
__d("MAWMsgReply.bs",["LSMessageReplySourceTypeV2.bs","LSReplyMessageAttachmentType.bs","MAWGating","bs_belt_Option","bs_caml_format","bs_caml_int64","cr:2382"],(function(a,b,c,d,e,f,g){"use strict";function a(a){return!c("bs_belt_Option").isNone(a.replySourceId)}function e(a){a=a.replyToUserId;return a==null?void 0:c("bs_caml_format").caml_int64_of_string(a)}function f(a){var b=a.isForwarded,e=!c("bs_belt_Option").isNone(a.replySourceId),f=a.isStoryReply;a=a.isStoryShare;if(b)return d("LSMessageReplySourceTypeV2.bs").forward;if(a!==void 0&&a)return d("LSMessageReplySourceTypeV2.bs").fbStoryShare;if(e)if(f!==void 0&&f)return d("LSMessageReplySourceTypeV2.bs").story;else return d("LSMessageReplySourceTypeV2.bs").message}function h(a){var b=!c("bs_belt_Option").isNone(a.replySourceId),e=a.isStoryReply;a=a.isStoryShare;if(a!==void 0&&a)return d("LSMessageReplySourceTypeV2.bs").fbStoryShare;if(b)if(e!==void 0&&e)return d("LSMessageReplySourceTypeV2.bs").story;else return d("LSMessageReplySourceTypeV2.bs").message}function i(a){if(!c("bs_belt_Option").isNone(a.replySourceId))return a.replySourceId}function j(a){if(!c("bs_belt_Option").isNone(a.replySourceId))return a.replyMessageText}function k(a){if(!c("bs_belt_Option").isNone(a.replySourceId))return a.replyMentionedJids}function l(a){if(c("bs_belt_Option").isNone(a.replySourceId))return!1;else return c("bs_belt_Option").isSome(a.replyMediaUrlMimeType)}function m(a){if(l(a))return a.replyMediaUrlMimeType}function n(a){if(l(a))return c("bs_belt_Option").map(a.replyMediaPreviewHeight,c("bs_caml_int64").of_int32)}function o(a){if(l(a))return c("bs_belt_Option").map(a.replyMediaPreviewWidth,c("bs_caml_int64").of_int32)}function p(a){var c=a.replyMessageText;c=c!==void 0?b("cr:2382")==null?c:b("cr:2382").unvault(c):"";c=c==="\ud83d\udc4d"&&a.replyStatusType==="Sticker"&&d("MAWGating").isHotLikeEnabled();var e=l(a);a=a.replyStatusType;if(e){if(a===void 0)return;switch(a){case"Gif":if(c)return;else return d("LSReplyMessageAttachmentType.bs").gif;case"Ptt":if(c)return;else return d("LSReplyMessageAttachmentType.bs").other;case"Sticker":if(!c)return d("LSReplyMessageAttachmentType.bs").sticker;break;case"Video":if(c)return;else return d("LSReplyMessageAttachmentType.bs").video;case"Image":case"XMA":if(c)return;else return d("LSReplyMessageAttachmentType.bs").photo;default:}}if(a!==void 0&&a==="Sticker"&&c)return d("LSReplyMessageAttachmentType.bs").sticker}function q(a){var b=a.replyMediaId,d=a.replyXMAId;if(l(a)&&b!=null)return d!=null?void 0:c("bs_caml_int64").of_int32(b);if(b!=null||d==null)return;return c("bs_caml_int64").of_int32(d)}function r(a){var b=a.replyStatusType,d=p(a),e=q(a),f=a.replyMessageText;a=a.isStoryReply;if(b!==void 0&&b==="XMA"&&d===void 0){if(e!==void 0)return;if(f===void 0)return c("bs_caml_int64").zero}if(e!==void 0||!(a!==void 0&&a))return;return c("bs_caml_int64").zero}g.hasReply=a;g.getReplyUserId=e;g.getReplySourceTypeV2=f;g.getReplySourceType=h;g.getReplySourceId=i;g.getReplyMessageText=j;g.getReplyMentionedJids=k;g.hasReplyMedia=l;g.getReplyMediaMimeType=m;g.getReplyMediaHeight=n;g.getReplyMediaWidth=o;g.getReplyAttachmentType=p;g.getReplyAttachmentId=q;g.getReplyMediaExpirationTimestampMs=r}),98);
__d("MAWBridgeBuildMsg",["LSIntEnum","MAWBridgeBuildAdminMsg","MAWBridgeBuildMsgMentions","MAWMsgReply","MAWMsgReply.bs","MAWUpdateMsg","MAWVault","bs_caml_int64","regeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";function h(){for(var a=arguments.length,b=new Array(a),c=0;c<a;c++)b[c]=arguments[c];return b.filter(Boolean).reduce(function(a,b){return[].concat(a,b)},[])}function i(a){return a!=null?d("MAWVault").unvault(a):void 0}function j(a){return a!=null?d("MAWVault").vault(a):void 0}function k(a){return babelHelpers["extends"]({},a,{replyMessageText:j(a.replyMessageText),text:j(a.text)})}function a(a){a=a.ephemeralDurationInSec;return a!=null?c("bs_caml_int64").of_int32(a):void 0}function e(a){a=d("MAWMsgReply").getReplyStatus(a);return a!=null?d("LSIntEnum").ofNumber(a):void 0}function f(a,c,e,f){var g,j,l,m,n,o,p,q,r,s;return b("regeneratorRuntime").async(function(t){while(1)switch(t.prev=t.next){case 0:g=d("MAWMsgReply.bs").getReplyMessageText(e);j=e.adminContent,l=e.adminType,m=e.adminVersion,n=e.chatId,o=e.content,p=e.isAdminMessage,q=e.msgId;r=o;if(!(p&&j!=null&&l!=null)){t.next=7;break}t.next=6;return b("regeneratorRuntime").awrap(d("MAWBridgeBuildAdminMsg").buildAdminMsgText(a,c,n,f,q,j,l,m));case 6:r=t.sent;case 7:s=h(e.mentionedJids,d("MAWMsgReply.bs").getReplyMentionedJids(e));if(!(s.length>0)){t.next=10;break}return t.abrupt("return",d("MAWBridgeBuildMsgMentions").buildMsgTextWithMentions(a,c,q,i(o),s,function(b){return d("MAWUpdateMsg").mutateThreadText(a,n,f,q,k(b))},i(g)).then(k));case 10:return t.abrupt("return",{replyMessageText:g,text:r});case 11:case"end":return t.stop()}},null,this)}g.getEphemeralDurationInSec=a;g.getReplyStatus=e;g.buildMessage=f}),98);
__d("MAWUpdateMsg",["LSAuthorityLevel.bs","LSMessageUnsendabilityStatus.re","MAWAckLevel","MAWBridgeBuildMsg","MAWBridgeMsg","MAWMsg.bs","MAWMsgReply.bs","MAWThreadId","MAWTimeUtils","ReQL","bs_belt_Option","bs_caml_int64","regeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";function a(a,c,e,f,g){return a.runInTransaction(function(h){var i,j,k;return b("regeneratorRuntime").async(function(l){while(1)switch(l.prev=l.next){case 0:l.next=2;return b("regeneratorRuntime").awrap(d("MAWThreadId").toThreadKeyMaybe(a,c));case 2:i=l.sent;if(!(i==null)){l.next=5;break}return l.abrupt("return");case 5:j=h.table("messages");l.next=8;return b("regeneratorRuntime").awrap(d("ReQL").firstAsync(d("ReQL").fromTableAscending(j).getKeyRange(i,e,f)));case 8:k=l.sent;if(!(k!=null)){l.next=12;break}l.next=12;return b("regeneratorRuntime").awrap(j.put(babelHelpers["extends"]({},k,g)));case 12:case"end":return l.stop()}},null,this)},"readwrite")}function e(a,e,f,g,h,i){var j,k,l;return b("regeneratorRuntime").async(function(m){while(1)switch(m.prev=m.next){case 0:j=d("MAWTimeUtils").toTimestamp(f.type_===d("MAWMsg.bs").unsent?c("bs_belt_Option").getWithDefault(f.originalTs,f.ts):f.ts);k=f.type_===d("MAWMsg.bs").unsent;m.next=4;return b("regeneratorRuntime").awrap(d("MAWBridgeBuildMsg").buildMessage(a,e,f,j));case 4:l=m.sent;return m.abrupt("return",e.table("messages").put(babelHelpers["extends"]({},g,l,{adminMsgCtaId:h==null?void 0:h.ctaId,adminMsgCtaTitle:h==null?void 0:h.title,adminMsgCtaType:h==null?void 0:h.ctaType,authorityLevel:d("LSAuthorityLevel.bs").authoritative,cannotUnsendReason:k||!f.isAuthorMe?c("LSMessageUnsendabilityStatus.re").denyForNonSender:void 0,displayedContentTypes:d("MAWMsg.bs").getDisplayedContentTypes(f.type_,f.isForwarded,f.isExpiredXmaMsg),ephemeralDurationInSec:d("MAWBridgeBuildMsg").getEphemeralDurationInSec(f),hotEmojiSize:d("MAWBridgeMsg").getSpecialTextSize(f),isUnsent:f.type_===d("MAWMsg.bs").unsent,messageId:f.msgId,primarySortKey:c("bs_caml_int64").of_float(f.sortOrderMs),replyAttachmentId:d("MAWMsgReply.bs").getReplyAttachmentId(f),replyAttachmentType:d("MAWMsgReply.bs").getReplyAttachmentType(f),replyMediaExpirationTimestampMs:d("MAWMsgReply.bs").getReplyMediaExpirationTimestampMs(f),replyMediaPreviewHeight:d("MAWMsgReply.bs").getReplyMediaHeight(f),replyMediaPreviewWidth:d("MAWMsgReply.bs").getReplyMediaWidth(f),replyMediaUrlMimeType:d("MAWMsgReply.bs").getReplyMediaMimeType(f),replySnippet:i,replySourceId:d("MAWMsgReply.bs").getReplySourceId(f),replySourceType:d("MAWMsgReply.bs").getReplySourceType(f),replySourceTypeV2:d("MAWMsgReply.bs").getReplySourceTypeV2(f),replyStatus:d("MAWBridgeBuildMsg").getReplyStatus(f),replyToUserId:d("MAWMsgReply.bs").getReplyUserId(f),sendStatus:d("MAWAckLevel").levelToMessagingSendStatus(f.ack),sendStatusV2:d("MAWAckLevel").levelToMessagingSendStatusV2(f.ack),timestampMs:j})));case 6:case"end":return m.stop()}},null,this)}g.mutateThreadText=a;g.call=e}),98);
__d("MAWBridgeNewMsgHandler.bs",["LSAuthorityLevel.bs","LSMessageUnsendabilityStatus.bs","LSMessageViewFlag.bs","LSQuickReplyType.bs","MAWAckLevel","MAWAdminMsgCTA.bs","MAWBridgeBuildMsg","MAWBridgeMsg","MAWMsg.bs","MAWMsgReply","MAWMsgReply.bs","MAWThreadId","MAWTimeUtils","MAWUpdateMsg","Promise","ReQL.bs","bs_belt_Option","bs_caml_format","bs_caml_int64","regeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";function h(a,e,f,g,h,i){var j,k;return b("regeneratorRuntime").async(function(l){while(1)switch(l.prev=l.next){case 0:j=d("MAWTimeUtils").toTimestamp(g.type_===d("MAWMsg.bs").unsent?c("bs_belt_Option").getWithDefault(g.originalTs,g.ts):g.ts);l.next=3;return b("regeneratorRuntime").awrap(d("MAWBridgeBuildMsg").buildMessage(a,e,g,j));case 3:k=l.sent;return l.abrupt("return",e.table("messages").add(babelHelpers["extends"]({},k,{adminMsgCtaId:h==null?void 0:h.ctaId,adminMsgCtaTitle:h==null?void 0:h.title,adminMsgCtaType:h==null?void 0:h.ctaType,authorityLevel:d("LSAuthorityLevel.bs").authoritative,cannotUnsendReason:g.type_===d("MAWMsg.bs").unsent||!g.isAuthorMe?d("LSMessageUnsendabilityStatus.bs").denyForNonSender:void 0,displayedContentTypes:d("MAWMsg.bs").getDisplayedContentTypes(g.type_,g.isForwarded,g.isExpiredXmaMsg),ephemeralDurationInSec:d("MAWBridgeBuildMsg").getEphemeralDurationInSec(g),ephemeralExpirationTs:void 0,forwardScore:void 0,hasQuickReplies:!1,hotEmojiSize:d("MAWBridgeMsg").getSpecialTextSize(g),isAdminMessage:g.isAdminMessage,isForwarded:void 0,isUnsent:g.type_===d("MAWMsg.bs").unsent,localDataId:void 0,messageId:g.msgId,msUntilExpirationTs:void 0,offlineThreadingId:g.msgId,primarySortKey:c("bs_caml_int64").of_float(g.sortOrderMs),quickReplyType:d("LSQuickReplyType.bs").none,replyAttachmentExtra:void 0,replyAttachmentId:d("MAWMsgReply.bs").getReplyAttachmentId(g),replyAttachmentType:d("MAWMsgReply.bs").getReplyAttachmentType(g),replyCtaId:void 0,replyCtaTitle:void 0,replyMediaExpirationTimestampMs:d("MAWMsgReply.bs").getReplyMediaExpirationTimestampMs(g),replyMediaPreviewHeight:d("MAWMsgReply.bs").getReplyMediaHeight(g),replyMediaPreviewWidth:d("MAWMsgReply.bs").getReplyMediaWidth(g),replyMediaUrl:void 0,replyMediaUrlFallback:void 0,replyMediaUrlMimeType:d("MAWMsgReply.bs").getReplyMediaMimeType(g),replySnippet:i,replySourceId:d("MAWMsgReply.bs").getReplySourceId(g),replySourceTimestampMs:void 0,replySourceType:d("MAWMsgReply.bs").getReplySourceType(g),replySourceTypeV2:d("MAWMsgReply.bs").getReplySourceTypeV2(g),replyStatus:d("MAWBridgeBuildMsg").getReplyStatus(g),replyToUserId:d("MAWMsgReply.bs").getReplyUserId(g),replyType:void 0,secondarySortKey:void 0,senderId:c("bs_caml_format").caml_int64_of_string(g.sender),sendStatus:d("MAWAckLevel").levelToMessagingSendStatus(g.ack),sendStatusV2:d("MAWAckLevel").levelToMessagingSendStatusV2(g.ack),stickerId:void 0,subscriptErrorMessage:void 0,takedownState:void 0,textHasLinks:!1,threadKey:f,timestampMs:j,unsentTimestampMs:d("MAWTimeUtils").toTimestamp(g.ts),viewedPluginContext:void 0,viewedPluginKey:void 0,viewFlags:d("LSMessageViewFlag.bs").uncalculated})));case 5:case"end":return l.stop()}},null,this)}function i(a,e,f){var g,i,j,k,l;return b("regeneratorRuntime").async(function(m){while(1)switch(m.prev=m.next){case 0:m.next=2;return b("regeneratorRuntime").awrap(d("MAWThreadId").toThreadKeyMaybe(e,f.chatId));case 2:g=m.sent;if(!(g==null)){m.next=5;break}return m.abrupt("return");case 5:m.next=7;return b("regeneratorRuntime").awrap(d("MAWAdminMsgCTA.bs").getAdminMsgCtaStep(e,g,f));case 7:i=m.sent;m.next=10;return b("regeneratorRuntime").awrap(d("MAWMsgReply").getReplySnippet(a,e,f));case 10:j=m.sent;k=f.offlineMsg;if(!(k==null)){m.next=14;break}return m.abrupt("return",h(a,e,g,f,i,j));case 14:m.next=16;return b("regeneratorRuntime").awrap(d("ReQL.bs").first(d("ReQL.bs").getKeyRange(d("ReQL.bs").fromTableAscending(e.table("messages")),{hd:g,tl:{hd:c("bs_caml_int64").of_float(k.ts),tl:{hd:k.msgId,tl:0}}})));case 16:l=m.sent;if(!(l==null)){m.next=19;break}return m.abrupt("return",h(a,e,g,f,i,j));case 19:return m.abrupt("return",d("MAWUpdateMsg").call(a,e,f,l,i,j));case 20:case"end":return m.stop()}},null,this)}function a(a,c,d){return b("regeneratorRuntime").async(function(e){while(1)switch(e.prev=e.next){case 0:e.next=2;return b("regeneratorRuntime").awrap(b("Promise").all(d.filter(function(a){return!a.isDualSend}).map(function(b){return i(a,c,b)})));case 2:case"end":return e.stop()}},null,this)}g.call=i;g.bulkCall=a}),98);
__d("MAWBridgeMsgUpdatedHandler.bs",["MAWAdminMsgCTA.bs","MAWMsgReply","MAWThreadId","MAWUpdateMsg","ReQL.bs","regeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";function a(a,c,e){var f,g,h,i;return b("regeneratorRuntime").async(function(j){while(1)switch(j.prev=j.next){case 0:j.next=2;return b("regeneratorRuntime").awrap(d("MAWThreadId").toThreadKeyMaybe(c,e.chatId));case 2:f=j.sent;if(!(f==null)){j.next=5;break}return j.abrupt("return");case 5:j.next=7;return b("regeneratorRuntime").awrap(d("ReQL.bs").first(d("ReQL.bs").filter(d("ReQL.bs").getKeyRange(d("ReQL.bs").fromTableAscending(c.table("messages")),{hd:f,tl:0}),function(a){return a.messageId===e.msgId})));case 7:g=j.sent;if(!(g==null)){j.next=10;break}return j.abrupt("return");case 10:j.next=12;return b("regeneratorRuntime").awrap(d("MAWAdminMsgCTA.bs").getAdminMsgCtaStep(c,f,e));case 12:h=j.sent;j.next=15;return b("regeneratorRuntime").awrap(d("MAWMsgReply").getReplySnippet(a,c,e));case 15:i=j.sent;return j.abrupt("return",d("MAWUpdateMsg").call(a,c,e,g,h,i));case 17:case"end":return j.stop()}},null,this)}g.call=a}),98);
__d("MAWBridgeMsgsLoadedHandler.bs",["LS.bs","LSClearMessagePlaceholderRange","LSInsertNewMessageRange","MAWThreadId.bs","MAWTimeUtils.bs","Promise","bs_caml_int64"],(function(a,b,c,d,e,f,g){"use strict";function a(a,e){return d("MAWThreadId.bs").toThreadKeyMaybe(a,e.threadId).then(function(f){if(f!==void 0)return c("LSClearMessagePlaceholderRange")(f,"",d("MAWTimeUtils.bs").maxTimestampMs,d("LS.bs").make(a)).then(function(b){b=e.rangeExtensionType;var g;switch(b.TAG){case 1:case 2:g=c("bs_caml_int64").of_float(b._0.minMsgTs);break;case 0:case 3:g=d("MAWTimeUtils.bs").minTimestampMs;break}b=e.rangeExtensionType;b=b.TAG===3?c("bs_caml_int64").of_float(b._0.maxMsgTs):d("MAWTimeUtils.bs").maxTimestampMs;var h=e.rangeExtensionType,i;switch(h.TAG){case 1:case 2:i=h._0.minMsgId;break;case 0:case 3:i="";break}h=e.rangeExtensionType;var j;switch(h.TAG){case 1:j=h._0.maxMsgId;break;case 0:case 2:j="";break;case 3:j=h._0.maxMsgId;break}h=e.rangeExtensionType;var k;switch(h.TAG){case 1:case 2:k=c("bs_caml_int64").of_float(h._0.minMsgTs);break;case 0:case 3:k=d("MAWTimeUtils.bs").minTimestampMs;break}h=e.rangeExtensionType;h=h.TAG===3?c("bs_caml_int64").of_float(h._0.maxMsgTs):d("MAWTimeUtils.bs").maxTimestampMs;var l=e.rangeExtensionType,m;switch(l.TAG){case 1:m=l._0.hasMoreBefore;break;case 2:m=l._0.hasMoreBefore;break;case 0:case 3:m=!1;break}l=e.rangeExtensionType;l=l.TAG===3?l._0.hasMoreAfter:!1;return c("LSInsertNewMessageRange")(f,g,b,i,j,k,h,m,l,void 0,d("LS.bs").make(a))});else return b("Promise").resolve()})}g.call=a}),98);
__d("MAWBridgeMsgsStartCountdownHandler.bs",["MAWEphemeralMessageExpirationStorage.bs","MAWThreadId.bs","MAWTimeUtils","Promise","ReQL.bs","bs_caml_int64"],(function(a,b,c,d,e,f,g){"use strict";function a(a,e){return e.msgs.reduce(function(e,f){return e.then(function(e){d("MAWEphemeralMessageExpirationStorage.bs").setMessageForExpiration(a,f,f.countdownTs,f.millisecondsUntilCountdownTs);c("bs_caml_int64").of_int32(f.millisecondsUntilCountdownTs);return d("MAWThreadId.bs").toThreadKeyMaybe(a,f.chatId).then(function(e){if(e!==void 0)return d("ReQL.bs").first(d("ReQL.bs").getKeyRange(d("ReQL.bs").fromTableAscending(a.table("messages")),{hd:e,tl:{hd:d("MAWTimeUtils").toTimestamp(f.ts),tl:{hd:f.msgId,tl:0}}})).then(function(d){if(d===void 0)return b("Promise").resolve();d=babelHelpers["extends"]({},d,{ephemeralExpirationTs:c("bs_caml_int64").of_float(f.countdownTs)});return a.table("messages").put(d)});else return b("Promise").resolve()})})},b("Promise").resolve())}g.call=a}),98);
__d("MAWBridgeNewMediaHandler",["I64","MAWDbMsg","MAWMedia.bs","MAWThreadId","Promise","ReQL","regeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";function h(a,c){var e,f,g,h,i,j,k,l,m,n,o,p,q,r,s;return b("regeneratorRuntime").async(function(t){while(1)switch(t.prev=t.next){case 0:e=c.duration,f=c.ephemeralMediaState,g=c.ephemeralMediaViewMode,h=c.filesize,i=c.hasMedia,j=c.mediaId,k=c.mediaType,l=c.msgIds,m=c.previewHeight,n=c.previewHeightLarge,o=c.previewWidth,p=c.previewWidthLarge,q=c.threadId;t.next=3;return b("regeneratorRuntime").awrap(d("MAWThreadId").toThreadKeyMaybe(a,q));case 3:r=t.sent;if(!(r==null)){t.next=6;break}return t.abrupt("return");case 6:s=j.toString();return t.abrupt("return",b("Promise").all(l.map(function(c){var j,l,q;return b("regeneratorRuntime").async(function(t){while(1)switch(t.prev=t.next){case 0:j=a.table("attachments");t.next=3;return b("regeneratorRuntime").awrap(d("ReQL").firstAsync(d("ReQL").fromTableAscending(j).getKeyRange(r,c)));case 3:l=t.sent;if(!(l!=null)){t.next=6;break}return t.abrupt("return",j.put(babelHelpers["extends"]({},l,{hasMedia:i})));case 6:q=d("I64").of_int32(d("MAWDbMsg").getInChatMsgIdFromMsgId(c));return t.abrupt("return",j.add({attachmentFbid:s,attachmentIndex:d("I64").zero,attachmentType:d("MAWMedia.bs").mediaTypeToMessageAttachmentType(k),authorityLevel:d("I64").zero,ephemeralMediaState:f!=null?d("I64").of_int32(f):void 0,ephemeralMediaViewMode:g!=null?d("I64").of_int32(g):void 0,filesize:h==null?void 0:d("I64").of_int32(h),hasMedia:i,hasXma:!1,isSharable:!1,messageId:c,offlineAttachmentId:s,playableDurationMs:e==null?void 0:d("I64").of_int32(e),previewHeight:m==null?void 0:d("I64").of_int32(m),previewHeightLarge:n==null?void 0:d("I64").of_int32(n),previewWidth:o==null?void 0:d("I64").of_int32(o),previewWidthLarge:p==null?void 0:d("I64").of_int32(p),threadKey:r,timestampMs:q}));case 8:case"end":return t.stop()}},null,this)})));case 8:case"end":return t.stop()}},null,this)}function a(a,c){return b("regeneratorRuntime").async(function(d){while(1)switch(d.prev=d.next){case 0:d.next=2;return b("regeneratorRuntime").awrap(h(a,c));case 2:case"end":return d.stop()}},null,this)}g.call=a}),98);
__d("MAWBridgeNewMediaRangeHandler.bs",["LS.bs","LSThreadMediaGalleryGroup.bs","LSUpsertAttachmentRange","MAWThreadId.bs","Promise","bs_caml_int64"],(function(a,b,c,d,e,f,g){"use strict";function h(a,e){return d("MAWThreadId.bs").toThreadKeyMaybe(a,e.threadId).then(function(f){if(f===void 0)return b("Promise").resolve();var g=c("bs_caml_int64").of_int32(e.minMsgRowId),h=e.hasMoreBefore;return c("LSUpsertAttachmentRange")(f,d("LSThreadMediaGalleryGroup.bs").photosAndVideos,g,h,d("LS.bs").make(a))})}function a(a,b){return h(a,b).then(function(a){})}g.call=a}),98);
__d("MAWBridgeOneToOneMessageRequestLoadedHandler.bs",["fbt","LSAuthorityLevel.bs","LSMessagingThreadTypeUtil.bs","LSThreadBitOffset.bs","MAWContactRelationshipType","MAWDbContact","MAWMessageRequestUtil.bs","MAWThreadId.bs","Promise","ReQL.bs","bs_caml","bs_caml_format","bs_caml_int64","qex"],(function(a,b,c,d,e,f,g,h){"use strict";function a(a,e){return d("MAWThreadId.bs").toThreadKeyMaybe(a,e.threadId).then(function(f){if(f!==void 0)return d("ReQL.bs").first(d("ReQL.bs").getKeyRange(d("ReQL.bs").fromTableAscending(a.table("threads")),{hd:f,tl:0})).then(function(f){if(f===void 0)return b("Promise").resolve([void 0,void 0,void 0,!1]);var g=d("ReQL.bs").first(d("ReQL.bs").getKeyRange(d("ReQL.bs").fromTableAscending(a.table("contacts")),{hd:c("bs_caml_format").caml_int64_of_string(e.fbid),tl:0}));return b("Promise").all([b("Promise").resolve(f),g,b("Promise").resolve(e.relationship),b("Promise").resolve(d("LSMessagingThreadTypeUtil.bs").isOneToOne(f.threadType))])}).then(function(e){var f=e[0];if(f===void 0)return b("Promise").resolve();var g=e[1];if(g===void 0)return b("Promise").resolve();var i=e[2];if(i===void 0)return b("Promise").resolve();if(!e[3])return b("Promise").resolve();e=c("bs_caml").i64_neq(g.authorityLevel,d("LSAuthorityLevel.bs").authoritative)?i:d("MAWContactRelationshipType").getContactRelationshipType(g);if(f.folderName==="pending"||f.folderName==="other"||f.folderName==="spam"||f.folderName==="inbox"&&e===d("MAWDbContact").REVERSED_ONE_WAY_CONTACT&&c("bs_caml").i64_neq(f.lastActivityTimestampMs,c("bs_caml_int64").zero)){i=d("LSThreadBitOffset.bs").clear(d("MAWMessageRequestUtil.bs").disabledThreadCapabilitiesForIncomingRequest,f.capabilities,f.capabilities2,f.capabilities3);g=c("qex")._("1364")&&f.folderName==="inbox"?h._("__JHASH__4F6x7gUU1-S__JHASH__").toString():void 0;e=[d("LSThreadBitOffset.bs").set(d("MAWMessageRequestUtil.bs").enabledThreadCapabilitiesForIncomingRequest,i[0],i[1],i[2]),g]}else e=[[f.capabilities,f.capabilities2,f.capabilities3],void 0];i=e[0];g=babelHelpers["extends"]({},f,{capabilities3:i[2],capabilities2:i[1],additionalThreadContext:e[1],capabilities:i[0]});return a.table("threads").put(g).then(function(a){})});else return b("Promise").resolve()})}g.call=a}),98);
__d("MAWBridgeParticipantRemovedHandler.bs",["MAWThreadId.bs","Promise","bs_caml_format"],(function(a,b,c,d,e,f,g){"use strict";function a(a,e){return d("MAWThreadId.bs").toThreadKeyMaybe(a,e.threadId).then(function(d){if(d===void 0)return b("Promise").resolve();var f=c("bs_caml_format").caml_int64_of_string(e.userId);return a.table("participants")["delete"]({hd:d,tl:{hd:f,tl:0}}).then(function(a){})})}g.call=a}),98);
__d("MAWBridgeParticipantUpdatedHandler.bs",["fbt","LS.bs","LSAuthorityLevel.bs","LSContactBlockedByViewerStatus.bs","LSContactGender.bs","LSContactIdType.bs","LSContactType.bs","LSContactViewerRelationship.bs","LSContactWorkForeignEntityType.bs","LSGroupParticipantJoinState.bs","LSVerifyContactRowExists","MAWCurrentUser","MAWThreadId.bs","MAWTimeUtils","MAWUpdateLSThreadCapabilities.bs","Promise","ReQLTable.bs","bs_caml","bs_caml_format","bs_caml_int64","bs_caml_obj"],(function(a,b,c,d,e,f,g,h){"use strict";var i=d("MAWCurrentUser").getID(),j=c("bs_caml_format").caml_int64_of_string(i);function a(a){return a.startsWith("shadow_")}function e(a,e){if(e.fbid.startsWith("shadow_"))return b("Promise").resolve();else return d("MAWThreadId.bs").toThreadKeyMaybe(a,e.threadId).then(function(f){if(f===void 0)return b("Promise").resolve();var g=c("bs_caml_format").caml_int64_of_string(e.fbid),k=d("MAWTimeUtils").toTimestamp(e.readWatermarkTs),l=d("MAWTimeUtils").toTimestamp(e.deliveredWatermarkTs),m=d("MAWTimeUtils").toTimestamp(e.lastReadActionTs),n=e.isSuperAdmin?h._("__JHASH__-gVxfbL98KU__JHASH__").toString():void 0,o={contents:!1},p={contents:!1};return d("ReQLTable.bs").update(a.table("participants"),{hd:f,tl:{hd:g,tl:0}},function(a){if(a!==void 0){p.contents=!0;return{authorityLevel:a.authorityLevel,contactId:g,deliveredWatermarkTimestampMs:l,groupParticipantJoinState:e.isInvited?d("LSGroupParticipantJoinState.bs").invited:d("LSGroupParticipantJoinState.bs").member,isAdmin:e.isAdmin,isModerator:!1,isSuperAdmin:a.isSuperAdmin,nickname:a.nickname,normalizedSearchTerms:a.normalizedSearchTerms,participantCapabilities:a.participantCapabilities,readActionTimestampMs:m,readWatermarkTimestampMs:k,subscribeSource:n,threadKey:f}}else{p.contents=!0;o.contents=!0;return{authorityLevel:c("bs_caml_int64").zero,contactId:g,deliveredWatermarkTimestampMs:l,groupParticipantJoinState:e.isInvited?d("LSGroupParticipantJoinState.bs").invited:d("LSGroupParticipantJoinState.bs").member,isAdmin:e.isAdmin,isModerator:!1,isSuperAdmin:e.isSuperAdmin,nickname:void 0,normalizedSearchTerms:void 0,participantCapabilities:void 0,readActionTimestampMs:c("bs_caml_int64").zero,readWatermarkTimestampMs:k,subscribeSource:n,threadKey:f}}}).then(function(h){if(p.contents)return d("MAWUpdateLSThreadCapabilities.bs").disableBlockerCapabilitiesTxn(a,f).then(function(b){b=c("bs_caml").i64_eq(j,g);var h=e.isAdmin;if(b)if(h)return d("MAWUpdateLSThreadCapabilities.bs").enableAddMembersTxn(a,f);else return d("MAWUpdateLSThreadCapabilities.bs").disableAddMembersTxn(a,f);else return window.Promise.resolve()});else return b("Promise").resolve()}).then(function(f){if(o.contents)return c("LSVerifyContactRowExists")(g,d("LSContactIdType.bs").fbid,void 0,void 0,d("LSContactType.bs").user,void 0,void 0,void 0,void 0,!1,!1,d("LSContactBlockedByViewerStatus.bs").unblocked,void 0,c("bs_caml_obj").caml_equal(i,e.fbid),d("LSAuthorityLevel.bs").optimistic,void 0,void 0,d("LSContactWorkForeignEntityType.bs").unknown,d("LSContactGender.bs").unknown,d("LSContactViewerRelationship.bs").unknown,void 0,d("LS.bs").make(a));else return b("Promise").resolve()})})}g.currentUserId=i;g.currentUserIdAsInt64=j;g.checkIfDualSendUser=a;g.call=e}),98);
__d("MAWBridgeParticipantsUpdatedHandler.bs",["fbt","I64","LS.bs","LSAuthorityLevel.bs","LSContactBlockedByViewerStatus.bs","LSContactGender.bs","LSContactIdType.bs","LSContactType.bs","LSContactViewerRelationship.bs","LSContactWorkForeignEntityType.bs","LSGroupParticipantJoinState.bs","LSVerifyContactRowExists","MAWCurrentUser","MAWThreadId.bs","MAWTimeUtils","MAWUpdateLSThreadCapabilities.bs","Promise","ReQLTable.bs","bs_caml","bs_caml_format","bs_caml_int64","bs_caml_obj"],(function(a,b,c,d,e,f,g,h){"use strict";var i=d("MAWCurrentUser").getID(),j=c("bs_caml_format").caml_int64_of_string(i);function a(a){return a.startsWith("shadow_")}function e(a,e){e=e.participants.filter(function(a){return!a.fbid.startsWith("shadow_")});return b("Promise").all(e.map(function(e){return d("MAWThreadId.bs").toThreadKeyMaybe(a,e.threadId).then(function(f){if(f===void 0)return b("Promise").resolve();var g=c("bs_caml_format").caml_int64_of_string(e.fbid),k=d("MAWTimeUtils").toTimestamp(e.readWatermarkTs),l=d("MAWTimeUtils").toTimestamp(e.deliveredWatermarkTs),m=d("MAWTimeUtils").toTimestamp(e.lastReadActionTs),n=e.isSuperAdmin?h._("__JHASH__-gVxfbL98KU__JHASH__").toString():void 0,o={contents:!1},p={contents:!1};return d("ReQLTable.bs").update(a.table("participants"),{hd:f,tl:{hd:g,tl:0}},function(a){if(a!==void 0){p.contents=!0;return{authorityLevel:a.authorityLevel,contactId:g,deliveredWatermarkTimestampMs:d("I64").equal(l,d("I64").zero)?a.deliveredWatermarkTimestampMs:l,groupParticipantJoinState:e.isInvited?d("LSGroupParticipantJoinState.bs").invited:d("LSGroupParticipantJoinState.bs").member,isAdmin:e.isAdmin,isModerator:!1,isSuperAdmin:a.isSuperAdmin,nickname:a.nickname,normalizedSearchTerms:a.normalizedSearchTerms,participantCapabilities:a.participantCapabilities,readActionTimestampMs:d("I64").equal(m,d("I64").zero)?a.readActionTimestampMs:m,readWatermarkTimestampMs:d("I64").equal(k,d("I64").zero)?a.readWatermarkTimestampMs:k,subscribeSource:n,threadKey:f}}else{p.contents=!0;o.contents=!0;return{authorityLevel:c("bs_caml_int64").zero,contactId:g,deliveredWatermarkTimestampMs:l,groupParticipantJoinState:e.isInvited?d("LSGroupParticipantJoinState.bs").invited:d("LSGroupParticipantJoinState.bs").member,isAdmin:e.isAdmin,isModerator:!1,isSuperAdmin:e.isSuperAdmin,nickname:void 0,normalizedSearchTerms:void 0,participantCapabilities:void 0,readActionTimestampMs:c("bs_caml_int64").zero,readWatermarkTimestampMs:k,subscribeSource:n,threadKey:f}}}).then(function(h){if(p.contents)return d("MAWUpdateLSThreadCapabilities.bs").disableBlockerCapabilitiesTxn(a,f).then(function(b){b=c("bs_caml").i64_eq(j,g);var h=e.isAdmin;if(b)if(h)return d("MAWUpdateLSThreadCapabilities.bs").enableAddMembersTxn(a,f);else return d("MAWUpdateLSThreadCapabilities.bs").disableAddMembersTxn(a,f);else return window.Promise.resolve()});else return b("Promise").resolve()}).then(function(f){if(o.contents)return c("LSVerifyContactRowExists")(g,d("LSContactIdType.bs").fbid,void 0,void 0,d("LSContactType.bs").user,void 0,void 0,void 0,void 0,!1,!1,d("LSContactBlockedByViewerStatus.bs").unblocked,void 0,c("bs_caml_obj").caml_equal(i,e.fbid),d("LSAuthorityLevel.bs").optimistic,void 0,void 0,d("LSContactWorkForeignEntityType.bs").unknown,d("LSContactGender.bs").unknown,d("LSContactViewerRelationship.bs").unknown,void 0,d("LS.bs").make(a));else return b("Promise").resolve()})})})).then(function(a){})}g.currentUserId=i;g.currentUserIdAsInt64=j;g.checkIfDualSendUser=a;g.call=e}),98);
__d("MAWBridgeReactionUpsertHandler.bs",["LSAuthorityLevel.bs","MAWThreadId.bs","MAWTimeUtils","Promise","bs_caml_format"],(function(a,b,c,d,e,f,g){"use strict";function h(a,e){return d("MAWThreadId.bs").toThreadKeyMaybe(a,e.threadId).then(function(f){if(f!==void 0)return a.table("reactions").upsert({hd:f,tl:{hd:e.messageId,tl:{hd:c("bs_caml_format").caml_int64_of_string(e.actorId),tl:0}}},{actorId:c("bs_caml_format").caml_int64_of_string(e.actorId),authorityLevel:d("LSAuthorityLevel.bs").authoritative,messageId:e.messageId,reaction:e.reaction,threadKey:f,timestampMs:d("MAWTimeUtils").toTimestamp(e.ts)});else return b("Promise").resolve()})}function a(a,b){return h(a,b).then(function(a){})}g.call=a}),98);
__d("MAWBridgeReceivedChatStateHandler.bs",["MAWThreadId.bs","Promise","ServerTime","WAChatState","bs_caml_format","bs_caml_int64"],(function(a,b,c,d,e,f,g){"use strict";function a(a,e){return d("MAWThreadId.bs").toThreadKeyMaybe(a,e.threadId).then(function(f){if(f===void 0)return b("Promise").resolve();var g=c("bs_caml_format").caml_int64_of_string(e.senderId),h=c("bs_caml_int64").of_float(3e3+d("ServerTime").getMillis());if(e.state===d("WAChatState").TYPING)return a.table("typing_indicator").upsert({hd:f,tl:{hd:g,tl:0}},{expirationTimestampMs:h,senderId:g,threadKey:f}).then(function(a){});else if(e.state===d("WAChatState").IDLE)return a.table("typing_indicator")["delete"]({hd:f,tl:{hd:g,tl:0}}).then(function(a){});else return window.Promise.resolve()})}g.call=a}),98);
__d("MAWBridgeReceivedReceiptHandler.bs",["MAWThreadId.bs","MAWTimeUtils","Promise","ReQL.bs","bs_caml_format"],(function(a,b,c,d,e,f,g){"use strict";function a(a,e){return d("MAWThreadId.bs").toThreadKeyMaybe(a,e.threadId).then(function(f){if(f===void 0)return b("Promise").resolve();var g=c("bs_caml_format").caml_int64_of_string(e.fbid),h=d("MAWTimeUtils").toTimestamp(e.lastReadWatermarkTs),i=d("MAWTimeUtils").toTimestamp(e.deliveredWatermarkTs),j=d("MAWTimeUtils").toTimestamp(e.lastReadActionTs);return d("ReQL.bs").first(d("ReQL.bs").getKeyRange(d("ReQL.bs").fromTableAscending(a.table("participants")),{hd:f,tl:{hd:g,tl:0}})).then(function(c){if(c!==void 0)return a.table("participants").put({authorityLevel:c.authorityLevel,contactId:c.contactId,deliveredWatermarkTimestampMs:i,groupParticipantJoinState:c.groupParticipantJoinState,isAdmin:c.isAdmin,isModerator:c.isModerator,isSuperAdmin:c.isSuperAdmin,nickname:c.nickname,normalizedSearchTerms:c.normalizedSearchTerms,participantCapabilities:c.participantCapabilities,readActionTimestampMs:j,readWatermarkTimestampMs:h,subscribeSource:c.subscribeSource,threadKey:c.threadKey});else return b("Promise").resolve()}).then(function(a){})})}g.call=a}),98);
__d("MAWBridgeSyncContacts.bs",["CurrentUser","LS.bs","LSAuthorityLevel.bs","LSContactBlockedByViewerStatus.bs","LSContactGender.bs","LSContactIdType.bs","LSContactType.bs","LSContactViewerRelationship.bs","LSContactWorkForeignEntityType.bs","LSVerifyContactRowExists","Promise","bs_caml_format","bs_caml_obj"],(function(a,b,c,d,e,f,g){"use strict";var h=c("CurrentUser").getID();function a(a,e){return e.reduce(function(b,e){var f=c("bs_caml_format").caml_int64_of_string(e);return b.then(function(b){return c("LSVerifyContactRowExists")(f,d("LSContactIdType.bs").fbid,void 0,void 0,d("LSContactType.bs").user,void 0,void 0,void 0,void 0,!1,!1,d("LSContactBlockedByViewerStatus.bs").unblocked,void 0,c("bs_caml_obj").caml_equal(h,e),d("LSAuthorityLevel.bs").optimistic,void 0,void 0,d("LSContactWorkForeignEntityType.bs").unknown,d("LSContactGender.bs").unknown,d("LSContactViewerRelationship.bs").unknown,void 0,d("LS.bs").make(a))}).then(function(a){})},b("Promise").resolve())}g.currentUserFbid=h;g.call=a}),98);
__d("MAWBridgeBuildThreadSnippet",["MAWAdminMsg","MAWBridgeBuildMsgMentions","MAWLocalizationType","MAWThreadId","ReQL","regeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";function h(a,b,c){if(a==null)return b;b=[].concat(b);switch(c){case d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_SEND_TEXT:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_SEND_TEXT:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_SEND_TEXT_IN_GROUP:b[0]=a;break}return b}function a(a,c,e,f){var g,j,k,l,m,n,o,p;return b("regeneratorRuntime").async(function(q){while(1)switch(q.prev=q.next){case 0:g=e.snippetContactIDs,j=e.snippetMentionJIDs,k=e.snippetParams,l=e.snippetType,m=e.threadId;if(!(k==null||l==null||g==null)){q.next=3;break}return q.abrupt("return",f);case 3:q.next=5;return b("regeneratorRuntime").awrap(d("MAWBridgeBuildMsgMentions").buildThreadSnippetWithMentions(a,c,m,k[0],j,g,function(b){var c=b[0];b=b[1];c=d("MAWAdminMsg").buildLocalizedString(h(c,k,l),b,l);return i(a,m,c)}));case 5:n=q.sent;o=n[0];p=n[1];return q.abrupt("return",d("MAWAdminMsg").buildLocalizedString(h(o,k,l),p,l));case 9:case"end":return q.stop()}},null,this)}function i(a,c,e){return a.runInTransaction(function(f){var g,h,i;return b("regeneratorRuntime").async(function(j){while(1)switch(j.prev=j.next){case 0:j.next=2;return b("regeneratorRuntime").awrap(d("MAWThreadId").toThreadKeyMaybe(a,c));case 2:g=j.sent;if(!(g==null)){j.next=5;break}return j.abrupt("return");case 5:h=f.table("threads");j.next=8;return b("regeneratorRuntime").awrap(d("ReQL").firstAsync(d("ReQL").fromTableAscending(h).getKeyRange(g)));case 8:i=j.sent;if(!i){j.next=12;break}j.next=12;return b("regeneratorRuntime").awrap(h.put(babelHelpers["extends"]({},i,{snippet:e})));case 12:case"end":return j.stop()}},null,this)},"readwrite")}g.buildBridgeThreadSnippet=a;g.mutateThreadSnippet=i}),98);
__d("MAWBridgeBuildThreadSnippet.bs",["MAWBridgeBuildThreadSnippet"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b,c,e){return d("MAWBridgeBuildThreadSnippet").buildBridgeThreadSnippet(a,b,c,e)}function b(a,b,c){d("MAWBridgeBuildThreadSnippet").mutateThreadSnippet(a,b,c)}g.buildBridgeThreadSnippet=a;g.mutateThreadSnippet=b}),98);
__d("MWV2DualSendMessageContent.bs",["MAWVault.bs"],(function(a,b,c,d,e,f,g){"use strict";var h="8031ded1058446aa93ccf8dace0eaf876dd5e32771904d5eb0058a0afdc724ce120dcba542d84548ac3f4a2741c45c0d",i="9031ded1058446aa93ccf8dace0eaf876dd5e32771904d5eb0058a0afdc724ce120dcba542d84548ac3f4a2741c45c0d";function a(a){if(a===void 0)return!1;a=d("MAWVault.bs").unvault(a);if(a.endsWith(h))return!0;else return a.endsWith(i)}g.messageText=h;g.messageTextV2=i;g.isDualSend=a}),98);
__d("MAWBridgeThreadBumpedHandler.bs",["MAWBridgeBuildThreadSnippet.bs","MAWBumpThread.bs","MAWThreadId.bs","MAWTimeUtils","MWV2DualSendMessageContent.bs","Promise","ReQL.bs","bs_belt_Option","bs_caml_format","bs_caml_option"],(function(a,b,c,d,e,f,g){"use strict";function a(a,e,f){return d("MAWThreadId.bs").toThreadKeyMaybe(e,f.threadId).then(function(g){if(g!==void 0)return d("ReQL.bs").first(d("ReQL.bs").getKeyRange(d("ReQL.bs").fromTableAscending(e.table("threads")),{hd:g,tl:0})).then(function(h){if(h!==void 0)return d("MAWBridgeBuildThreadSnippet.bs").buildBridgeThreadSnippet(a,e,f).then(function(a){var h=d("MWV2DualSendMessageContent.bs").isDualSend(a),i=d("MAWTimeUtils").millisTimeToTimestamp(f.lastActivityTs);i=d("MAWBumpThread.bs").threadMutation(e,g,i,d("MAWTimeUtils").millisTimeToTimestamp(f.lastReadTs),a,c("bs_belt_Option").mapWithDefault(c("bs_caml_option").nullable_to_opt(f.snippetSenderContactId),void 0,function(a){return c("bs_caml_format").caml_int64_of_string(a)}));if(h)return b("Promise").resolve();else return i.then(function(a){})});else return b("Promise").resolve()});else return b("Promise").resolve()}).then(function(a){})}g.call=a}),98);
__d("MAWBridgeThreadBumpedServerHandler",["I64","LS.re","LSBumpE2EEMetadataThread","MAWGating","MAWThreadId","MAWTimeUtils","WALoggerDeferred","promiseDone","regeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["[Occamadillo] Bumping thread on server. threadKey: ",", bumpTimestampMs: ",", isLocalDeviceSend: ",""]);h=function(){return a};return a}function a(a,e){return b("regeneratorRuntime").async(function(b){while(1)switch(b.prev=b.next){case 0:if(!(!d("MAWGating").isOccamadillo()||e.isDualSend)){b.next=2;break}return b.abrupt("return");case 2:return b.abrupt("return",d("MAWThreadId").toThreadKeyMaybe(a,e.threadId).then(function(b){if(b==null)return;var f=e.lastActivityTs;f=d("MAWTimeUtils").millisTimeToTimestamp(f);c("promiseDone")(d("WALoggerDeferred").LOG(h(),d("I64").to_string(b),d("I64").to_string(f),e.isCurrentDeviceSendingMsg));return c("LSBumpE2EEMetadataThread")(b,f,e.isCurrentDeviceSendingMsg,c("LS.re").make(a))}));case 3:case"end":return b.stop()}},null,this)}g.call=a}),98);
__d("MAWBridgeThreadHiddenHandler.bs",["LS.bs","LSOptimisticRemoveThread","LSThreadRemoveType.bs","MAWGating","MAWThreadId.bs","Promise"],(function(a,b,c,d,e,f,g){"use strict";function a(a,e){return d("MAWThreadId.bs").toThreadKeyMaybe(a,e).then(function(e){if(e===void 0)return b("Promise").resolve();if(!d("MAWGating").isOccamadillo())return a.table("threads")["delete"]({hd:e,tl:0}).then(function(a){});var f=d("LS.bs").make(a);return c("LSOptimisticRemoveThread")(e,d("LSThreadRemoveType.bs").deleteThread,f)})}g.call=a}),98);
__d("MAWBridgeThreadTimestampsHandler.bs",["CurrentUser","MAWThreadId.bs","MAWTimeUtils","Promise","ReQL.bs","bs_caml_format"],(function(a,b,c,d,e,f,g){"use strict";function h(a,c){return d("MAWThreadId.bs").toThreadKeyMaybe(a,c.threadId).then(function(e){if(e!==void 0)return d("ReQL.bs").first(d("ReQL.bs").getKeyRange(d("ReQL.bs").fromTableAscending(a.table("threads")),{hd:e,tl:0})).then(function(e){if(e===void 0)return b("Promise").resolve();e=babelHelpers["extends"]({},e,{lastReadWatermarkTimestampMs:d("MAWTimeUtils").millisTimeToTimestamp(c.lastReadWatermarkTs)});return a.table("threads").put(e)});else return b("Promise").resolve()})}function a(a,e){return h(a,e).then(function(f){return d("MAWThreadId.bs").toThreadKeyMaybe(a,e.threadId).then(function(f){if(f===void 0)return b("Promise").resolve();var g=c("bs_caml_format").caml_int64_of_string(c("CurrentUser").getID());return d("ReQL.bs").first(d("ReQL.bs").getKeyRange(d("ReQL.bs").fromTableAscending(a.table("participants")),{hd:f,tl:{hd:g,tl:0}})).then(function(c){if(c!==void 0)return a.table("participants").put({authorityLevel:c.authorityLevel,contactId:c.contactId,deliveredWatermarkTimestampMs:c.deliveredWatermarkTimestampMs,groupParticipantJoinState:c.groupParticipantJoinState,isAdmin:c.isAdmin,isModerator:c.isModerator,isSuperAdmin:c.isSuperAdmin,nickname:c.nickname,normalizedSearchTerms:c.normalizedSearchTerms,participantCapabilities:c.participantCapabilities,readActionTimestampMs:d("MAWTimeUtils").millisTimeToTimestamp(e.lastActivityTimestampMs),readWatermarkTimestampMs:d("MAWTimeUtils").millisTimeToTimestamp(e.lastReadWatermarkTs),subscribeSource:c.subscribeSource,threadKey:c.threadKey});else return b("Promise").resolve()})})}).then(function(a){})}g.call=a}),98);
__d("MAWBridgeThreadUpdatedHandler.bs",["I64","LSBitOffset.bs","MAWBridgeBuildThreadSnippet.bs","MAWFolderTypes","MAWFolderUtils","MAWGating","MAWThreadId","MWV2DualSendMessageContent.bs","ReQL","regeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";function h(a,b,c){return b===d("MAWFolderTypes").FOLDER_ID.ARCHIVED&&!c?d("LSBitOffset.bs").clear(d("I64").sub(d("I64").of_int32(64),[0,64]),d("LSBitOffset.bs").set(d("I64").sub(d("I64").of_int32(65),[0,64]),a)):a}function i(a,b,c){return b===d("MAWFolderTypes").FOLDER_ID.INBOX&&!c?d("LSBitOffset.bs").clear(d("I64").sub(d("I64").of_int32(65),[0,64]),d("LSBitOffset.bs").set(d("I64").sub(d("I64").of_int32(64),[0,64]),a)):a}function j(a,b){return b!==void 0&&b==="viewer_not_subscribed"?d("LSBitOffset.bs").clear(d("I64").sub(d("I64").of_int32(28),[0,64]),a):a}function a(a,c,e){var f,g,k,l,m,n,o,p,q,r,s,t;return b("regeneratorRuntime").async(function(u){while(1)switch(u.prev=u.next){case 0:g=e.cannotReplyReason,k=e.folder,l=e.muteExpireTimeMs,m=e.snippetSenderContactId,n=e.threadId;o=d("MAWGating").isOccamadillo();u.next=4;return b("regeneratorRuntime").awrap(d("MAWThreadId").toThreadKeyMaybe(c,n));case 4:p=u.sent;if(!(p==null)){u.next=7;break}return u.abrupt("return");case 7:u.next=9;return b("regeneratorRuntime").awrap(d("ReQL").firstAsync(d("ReQL").fromTableAscending(c.table("threads")).getKeyRange(p)));case 9:q=u.sent;if(!(q==null)){u.next=12;break}return u.abrupt("return");case 12:u.next=14;return b("regeneratorRuntime").awrap(d("MAWBridgeBuildThreadSnippet.bs").buildBridgeThreadSnippet(a,c,e,q.snippet));case 14:r=u.sent;s=k==null||o?q.folderName:d("MAWFolderUtils").getMessagingFolderTag(k);t=((f=g)!=null?f:s==="inbox")?void 0:q.cannotReplyReason;return u.abrupt("return",c.table("threads").put(babelHelpers["extends"]({},q,{capabilities2:j(h(i(q.capabilities2,k,o),k,o),t),parentThreadKey:k!=null&&!o?d("MAWFolderUtils").getSystemFolder(k):q.parentThreadKey,cannotReplyReason:t,snippetSenderContactId:m==null?q.snippetSenderContactId:d("I64").of_string(m),snippet:d("MWV2DualSendMessageContent.bs").isDualSend(r)?q.snippet:r,muteExpireTimeMs:l==null||o?q.muteExpireTimeMs:d("I64").of_float(l),folderName:o?q.folderName:s})));case 18:case"end":return u.stop()}},null,this)}g.call=a}),98);
__d("MAWBridgeThreadsLoadedHandler.bs",["MAWFolderUtils","MAWThreadId.bs","MAWTimeUtils","MAWTimeUtils.bs","Promise","ReQL.bs","bs_caml_int64"],(function(a,b,c,d,e,f,g){"use strict";function a(a,e){var f;switch(e.TAG){case 0:case 1:case 2:f=d("MAWFolderUtils").getClientSystemFolder(e._0.folderId);break}return d("ReQL.bs").first(d("ReQL.bs").getKeyRange(d("ReQL.bs").fromTableAscending(a.table("threads_ranges_v2__generated")),{hd:f,tl:0})).then(function(g){if(g!==void 0)return a.table("threads_ranges_v2__generated")["delete"]({hd:g.parentThreadKey,tl:{hd:g.minThreadKey,tl:{hd:g.minLastActivityTimestampMs,tl:0}}}).then(function(f){switch(e.TAG){case 0:case 1:break;case 2:var c=e._0;return d("MAWThreadId.bs").toThreadKeyMaybe(a,c.minThreadId).then(function(e){if(e!==void 0)return a.table("threads_ranges_v2__generated").put({hasMoreAfter:g.hasMoreAfter,hasMoreBefore:c.hasMore,isLoadingAfter:g.isLoadingAfter,isLoadingBefore:!1,maxLastActivityTimestampMs:g.maxLastActivityTimestampMs,maxThreadKey:g.maxThreadKey,minLastActivityTimestampMs:d("MAWTimeUtils").millisTimeToTimestamp(c.minLastActivityTs),minThreadKey:e,parentThreadKey:g.parentThreadKey});else return b("Promise").resolve()})}return a.table("threads_ranges_v2__generated").put({hasMoreAfter:g.hasMoreAfter,hasMoreBefore:g.hasMoreBefore,isLoadingAfter:g.isLoadingAfter,isLoadingBefore:!1,maxLastActivityTimestampMs:g.maxLastActivityTimestampMs,maxThreadKey:g.maxThreadKey,minLastActivityTimestampMs:g.minLastActivityTimestampMs,minThreadKey:g.minThreadKey,parentThreadKey:g.parentThreadKey})});switch(e.TAG){case 0:return a.table("threads_ranges_v2__generated").put({hasMoreAfter:!1,hasMoreBefore:!1,isLoadingAfter:!1,isLoadingBefore:!1,maxLastActivityTimestampMs:d("MAWTimeUtils.bs").maxTimestampMs,maxThreadKey:c("bs_caml_int64").zero,minLastActivityTimestampMs:d("MAWTimeUtils.bs").maxTimestampMs,minThreadKey:c("bs_caml_int64").zero,parentThreadKey:f});case 1:var h=e._0;return b("Promise").all([d("MAWThreadId.bs").toThreadKeyMaybe(a,h.minThreadId),d("MAWThreadId.bs").toThreadKeyMaybe(a,h.maxThreadId)]).then(function(c){var e=c[1];c=c[0];if(c!==void 0&&e!==void 0)return a.table("threads_ranges_v2__generated").add({hasMoreAfter:!1,hasMoreBefore:h.hasMore,isLoadingAfter:!1,isLoadingBefore:!1,maxLastActivityTimestampMs:d("MAWTimeUtils").millisTimeToTimestamp(h.maxLastActivityTs),maxThreadKey:e,minLastActivityTimestampMs:d("MAWTimeUtils").millisTimeToTimestamp(h.minLastActivityTs),minThreadKey:c,parentThreadKey:f});else return b("Promise").resolve()});case 2:return b("Promise").resolve()}})}g.call=a}),98);
__d("MAWBridgeUnArchivedSelfDeviceChangeAlertsHandler",["Promise"],(function(a,b,c,d,e,f){"use strict";function a(a,c){return b("Promise").resolve()}f.call=a}),66);
__d("MAWUpdateClientRestoreStatusOperationType.bs",[],(function(a,b,c,d,e,f){"use strict";a=0;b=1;f.upsertClientRestoreStatus=a;f.removeClientRestoreStatus=b}),66);
__d("MAWBridgeUpdateClientRestoreStatus.bs",["MAWUpdateClientRestoreStatusOperationType.bs","Promise","ReQL.bs","bs_caml_int64"],(function(a,b,c,d,e,f,g){"use strict";function h(a,c){return d("ReQL.bs").first(d("ReQL.bs").filter(d("ReQL.bs").fromTableAscending(a.table("encrypted_backups_client_restore_status")),function(a){return a.threadId===c})).then(function(c){if(c!==void 0)return a.table("encrypted_backups_client_restore_status")["delete"]({hd:c.threadId,tl:0}).then(function(a){});else return b("Promise").resolve()})}function a(a){return d("ReQL.bs").toArray(d("ReQL.bs").fromTableAscending(a.table("encrypted_backups_client_restore_status"))).then(function(c){return c.reduce(function(b,c){return b.then(function(b){return h(a,c.threadId)})},b("Promise").resolve())})}function e(a,b){var e=b.action;if(e===d("MAWUpdateClientRestoreStatusOperationType.bs").upsertClientRestoreStatus){e=b.threadId;return a.table("encrypted_backups_client_restore_status").put({lastUpdated:c("bs_caml_int64").of_float(Date.now()),threadId:e})}else return h(a,b.threadId)}g.truncateClientRestoreStatusTable=a;g.call=e}),98);
__d("MAWBridgeUpdateE2EEMetadataParticipantsHandler.bs",["LS.bs","LSUpdateE2EEMetadataParticipants","MAWThreadId.bs","Promise"],(function(a,b,c,d,e,f,g){"use strict";function a(a,e){return d("MAWThreadId.bs").toThreadKeyMaybe(a,e.threadId).then(function(e){if(e!==void 0)return c("LSUpdateE2EEMetadataParticipants")(e,d("LS.bs").make(a));else return b("Promise").resolve()})}g.call=a}),98);
__d("MAWBridgeUpdateMinMessageHandler.bs",["MAWThreadId.bs","Promise","ReQL.bs","ReQLTable.bs","bs_caml_int64","unrecoverableViolation"],(function(a,b,c,d,e,f,g){"use strict";function a(a,e){var f=c("bs_caml_int64").of_float(e.minTimestampMs),g=e.minMessageId;return d("MAWThreadId.bs").toThreadKeyMaybe(a,e.threadId).then(function(h){if(h!==void 0)return d("ReQL.bs").first(d("ReQL.bs").getKeyRange(d("ReQL.bs").fromTableAscending(a.table("messages_ranges_v2__generated")),{hd:h,tl:0})).then(function(b){if(b===void 0)return;var i=e.hasMoreBefore,j=i!==void 0?i:b.hasMoreBefore;return d("ReQLTable.bs").update(a.table("messages_ranges_v2__generated"),{hd:h,tl:{hd:b.minTimestampMs,tl:{hd:b.minMessageId,tl:0}}},function(a){if(a!==void 0)return{hasMoreAfter:a.hasMoreAfter,hasMoreBefore:j,isLoadingAfter:a.isLoadingAfter,isLoadingBefore:a.isLoadingBefore,maxMessageId:a.maxMessageId,maxTimestampMs:a.maxTimestampMs,minMessageId:g,minTimestampMs:f,threadKey:a.threadKey};throw c("unrecoverableViolation")("Thread is missing in updating the min message in message range","messenger_e2ee_web")})});else return b("Promise").resolve()})}g.call=a}),98);
__d("MAWBridgeXMAShareExpiredHandler.bs",["MAWThreadId.bs","Promise"],(function(a,b,c,d,e,f,g){"use strict";function a(a,c){var e=String(c.xmaId);return d("MAWThreadId.bs").toThreadKeyMaybe(a,c.threadId).then(function(d){if(d!==void 0)return a.table("attachments").get({hd:d,tl:{hd:c.msgId,tl:{hd:e,tl:0}}}).then(function(f){if(f===void 0)return b("Promise").resolve();f=[f.defaultCtaId,f.attachmentCta1Id,f.attachmentCta2Id,f.attachmentCta3Id].filter(Boolean);f=f.map(function(b){return a.table("attachment_ctas")["delete"]({hd:b,tl:0})});return b("Promise").all(f).then(function(b){return a.table("attachments")["delete"]({hd:d,tl:{hd:c.msgId,tl:{hd:e,tl:0}}})})});else return b("Promise").resolve()})}g.call=a}),98);
__d("MAWBridgeXMAShareTombstonedHandler.bs",["MAWThreadId.bs","Promise","ReQL.bs","recoverableViolation"],(function(a,b,c,d,e,f,g){"use strict";function a(a,e){var f=String(e.xmaId);return d("MAWThreadId.bs").toThreadKeyMaybe(a,e.threadId).then(function(g){if(g!==void 0)return a.table("attachments").get({hd:g,tl:{hd:e.msgId,tl:{hd:f,tl:0}}}).then(function(h){if(h===void 0)return b("Promise").resolve();h=[h.defaultCtaId,h.attachmentCta1Id,h.attachmentCta2Id,h.attachmentCta3Id].filter(Boolean);h=h.map(function(b){return a.table("attachment_ctas")["delete"]({hd:b,tl:0})});return b("Promise").all(h).then(function(h){return d("ReQL.bs").first(d("ReQL.bs").getKeyRange(d("ReQL.bs").fromTableAscending(a.table("attachments")),{hd:g,tl:{hd:e.msgId,tl:{hd:f,tl:0}}})).then(function(d){if(d!==void 0){d=babelHelpers["extends"]({},d,{previewHeightLarge:void 0,previewWidthLarge:void 0,maxSubtitleNumOfLines:void 0,maxTitleNumOfLines:void 0,subtitleText:void 0,titleText:void 0,previewHeight:void 0,previewWidth:void 0,cta3Type:void 0,cta3Title:void 0,attachmentCta3Id:void 0,cta2Type:void 0,cta2Title:void 0,attachmentCta2Id:void 0,cta1Type:void 0,cta1Title:void 0,attachmentCta1Id:void 0,defaultCtaTitle:void 0,defaultCtaId:void 0});return a.table("attachments").put(d)}c("recoverableViolation")("Trying to tombstone a secure xma attachment but no existing attachment","messenger_e2ee_web");return b("Promise").resolve()})})});else return b("Promise").resolve()})}g.call=a}),98);
__d("MAWBridgeUIEventHandler.bs",["FBLogger","JSResourceForInteraction","MAWAbPropsClient.bs","MAWBridgeDeleteGroupInviteHandler","MAWBridgeDeleteMessageRangesV2Handler","MAWBridgeDeleteMessagesHandler","MAWBridgeDeleteReactionHandler","MAWBridgeDropAllSecureThreadsHandler.bs","MAWBridgeEphemeralSettingsUpdatedForUIHandler","MAWBridgeGroupInfoUpdatedHandler.bs","MAWBridgeGroupInviteUpdateHandler.bs","MAWBridgeInitOfflineQueueSyncCompleteHandler.bs","MAWBridgeInitOfflineQueueSyncProgressHandler.bs","MAWBridgeInitOfflineQueueSyncStartHandler.bs","MAWBridgeInitSyncCompleteHandler.bs","MAWBridgeMediaExpiredHandler.bs","MAWBridgeMsgClearCountdownHandler.bs","MAWBridgeMsgUpdatedHandler.bs","MAWBridgeMsgsLoadedHandler.bs","MAWBridgeMsgsStartCountdownHandler.bs","MAWBridgeNewMediaHandler","MAWBridgeNewMediaRangeHandler.bs","MAWBridgeNewMsgHandler.bs","MAWBridgeNewXMAHandler.bs","MAWBridgeOneToOneMessageRequestLoadedHandler.bs","MAWBridgeParticipantRemovedHandler.bs","MAWBridgeParticipantUpdatedHandler.bs","MAWBridgeParticipantsUpdatedHandler.bs","MAWBridgeReactionUpsertHandler.bs","MAWBridgeReceivedChatStateHandler.bs","MAWBridgeReceivedReceiptHandler.bs","MAWBridgeSyncContacts.bs","MAWBridgeThreadBumpedHandler.bs","MAWBridgeThreadBumpedServerHandler","MAWBridgeThreadHiddenHandler.bs","MAWBridgeThreadTimestampsHandler.bs","MAWBridgeThreadUpdatedHandler.bs","MAWBridgeThreadsLoadedHandler.bs","MAWBridgeUIEventQPLLogger","MAWBridgeUnArchivedSelfDeviceChangeAlertsHandler","MAWBridgeUpdateClientRestoreStatus.bs","MAWBridgeUpdateE2EEMetadataParticipantsHandler.bs","MAWBridgeUpdateMinMessageHandler.bs","MAWBridgeXMAShareExpiredHandler.bs","MAWBridgeXMAShareTombstonedHandler.bs","MAWDualSendSimplePermissionsManager.bs","MAWGating","Promise","Promise.bs","WATimeUtils","bs_caml_option","bs_curry","bs_js_exn","cr:2848","promiseDone","recoverableViolation","requireDeferred"],(function(a,b,c,d,e,f,g){"use strict";var h=c("requireDeferred")("MAWBridgeIssuePointQueryHandler.bs").__setRef("MAWBridgeUIEventHandler.bs"),i=c("requireDeferred")("MAWBridgeStartTraceHandler.bs").__setRef("MAWBridgeUIEventHandler.bs"),j=c("requireDeferred")("MAWBridgeStartTraceWithTraceIdHandler.bs").__setRef("MAWBridgeUIEventHandler.bs"),k=c("requireDeferred")("MAWBridgeTraceRecordCheckpointHandler.bs").__setRef("MAWBridgeUIEventHandler.bs"),l=c("requireDeferred")("MAWBridgeUpdateDyiStatus.bs").__setRef("MAWBridgeUIEventHandler.bs"),m=c("requireDeferred")("MAWBridgeUpdateTraceHandler.bs").__setRef("MAWBridgeUIEventHandler.bs"),n=c("requireDeferred")("MAWBridgeUploadMessageHandler.bs").__setRef("MAWBridgeUIEventHandler.bs"),o=c("requireDeferred")("MAWBridgeUploadThreadHandler.bs").__setRef("MAWBridgeUIEventHandler.bs");function a(a,e){a=a.then(function(a){return a.runInTransaction(function(f){var g=d("MAWGating").isArmadillo(),p=d("MAWDualSendSimplePermissionsManager.bs").isDualSendUser(),q=g||p?function(e){switch(e.TAG){case 0:var g=e._0;if(g.isDualSend)return b("Promise").resolve();else return d("MAWBridgeNewMsgHandler.bs").call(a,f,g);case 1:return d("MAWBridgeMsgsStartCountdownHandler.bs").call(f,e._0);case 2:return d("MAWBridgeMsgClearCountdownHandler.bs").call(e._0);case 3:return d("MAWBridgeDropAllSecureThreadsHandler.bs").call(f);case 4:g=e._0;return b("cr:2848").call(f,g);case 5:g=e._0;if(g.isDualSend)return b("Promise").resolve();else return d("MAWBridgeMsgUpdatedHandler.bs").call(a,f,g);case 6:return d("MAWBridgeNewMediaHandler").call(f,e._0);case 7:return d("MAWBridgeNewMediaRangeHandler.bs").call(f,e._0);case 8:return d("MAWBridgeMediaExpiredHandler.bs").call(f,e._0);case 9:return d("MAWBridgeXMAShareExpiredHandler.bs").call(f,e._0);case 10:return d("MAWBridgeNewXMAHandler.bs").call(f,e._0);case 11:return d("MAWBridgeXMAShareTombstonedHandler.bs").call(f,e._0);case 12:return d("MAWBridgeParticipantUpdatedHandler.bs").call(f,e._0);case 13:return d("MAWBridgeParticipantRemovedHandler.bs").call(f,e._0);case 14:return d("MAWBridgeUpdateE2EEMetadataParticipantsHandler.bs").call(f,e._0);case 15:return d("MAWBridgeReceivedReceiptHandler.bs").call(f,e._0);case 16:return d("MAWBridgeThreadUpdatedHandler.bs").call(a,f,e._0);case 17:return d("MAWBridgeGroupInfoUpdatedHandler.bs").call(f,e._0);case 18:return d("MAWBridgeThreadBumpedHandler.bs").call(a,f,e._0);case 19:return d("MAWBridgeThreadsLoadedHandler.bs").call(f,e._0);case 20:return d("MAWBridgeThreadTimestampsHandler.bs").call(f,e._0);case 21:return d("MAWBridgeMsgsLoadedHandler.bs").call(f,e._0);case 22:return d("MAWBridgeInitSyncCompleteHandler.bs").call(f);case 23:var p=e._0;return i.load().then(function(a){return c("bs_curry")._2(a.call,f,p)});case 24:var q=e._0;return m.load().then(function(a){return c("bs_curry")._2(a.call,f,q)});case 25:return d("MAWBridgeThreadHiddenHandler.bs").call(f,e._0);case 26:return d("MAWBridgeSyncContacts.bs").call(f,e._0);case 27:return d("MAWBridgeReceivedChatStateHandler.bs").call(f,e._0);case 28:return window.Promise.resolve((d("WATimeUtils").setClockSkew(e._0),void 0));case 29:return d("MAWAbPropsClient.bs").rewrite(e._0);case 30:return d("MAWBridgeReactionUpsertHandler.bs").call(f,e._0);case 31:return d("MAWBridgeDeleteReactionHandler").deleteReaction(f,e._0);case 32:var r=e._0;return n.load().then(function(a){return c("bs_curry")._2(a.call,f,r)});case 33:var s=e._0;return o.load().then(function(a){return c("bs_curry")._2(a.call,f,s)});case 34:var t=e._0;return c("JSResourceForInteraction")("MAWBridgeCallFinishAddDeviceHandler.bs").__setRef("MAWBridgeUIEventHandler.bs").load().then(function(a){return c("bs_curry")._2(a.call,f,t)});case 35:var u=e._0;return c("JSResourceForInteraction")("MAWBridgeUploadAttachmentHandler.bs").__setRef("MAWBridgeUIEventHandler.bs").load().then(function(a){return c("bs_curry")._2(a.call,f,u)});case 36:var v=e._0;return c("JSResourceForInteraction")("MAWBridgeResignAttachmentCDNUrlHandler.bs").__setRef("MAWBridgeUIEventHandler.bs").load().then(function(a){return c("bs_curry")._2(a.call,f,v)});case 37:return c("MAWBridgeDeleteMessagesHandler")(f,e._0);case 38:var w=e._0;return c("JSResourceForInteraction")("MAWBridgeRestoreMessageBatchHandler.bs").__setRef("MAWBridgeUIEventHandler.bs").load().then(function(a){return c("bs_curry")._2(a.call,f,w)});case 39:return d("MAWBridgeOneToOneMessageRequestLoadedHandler.bs").call(f,e._0);case 40:return d("MAWBridgeGroupInviteUpdateHandler.bs").call(f,e._0);case 41:return d("MAWBridgeInitOfflineQueueSyncStartHandler.bs").call(f,e._0);case 42:return d("MAWBridgeInitOfflineQueueSyncCompleteHandler.bs").call(f);case 43:return d("MAWBridgeInitOfflineQueueSyncProgressHandler.bs").call(f,e._0);case 44:var x=e._0;return l.load().then(function(a){return c("bs_curry")._2(a.call,f,x)});case 45:return c("MAWBridgeDeleteGroupInviteHandler")(f,e._0);case 46:var y=e._0;return k.load().then(function(a){return c("bs_curry")._2(a.call,f,y)});case 47:return d("MAWBridgeDeleteMessageRangesV2Handler").deleteMessageRangesV2(f,e._0);case 48:return d("MAWBridgeUpdateMinMessageHandler.bs").call(f,e._0);case 49:var z=e._0;return h.load().then(function(a){return c("bs_curry")._2(a.call,f,z)});case 50:return d("MAWBridgeThreadBumpedServerHandler").call(f,e._0);case 51:return d("MAWBridgeParticipantsUpdatedHandler.bs").call(f,e._0);case 52:var A=e._0;return j.load().then(function(a){return c("bs_curry")._2(a.call,f,A)});case 53:return d("MAWBridgeUpdateClientRestoreStatus.bs").call(f,e._0);case 54:return d("MAWBridgeNewMsgHandler.bs").bulkCall(a,f,e._0.msgs);case 55:return d("MAWBridgeUnArchivedSelfDeviceChangeAlertsHandler").call(f,e._0);case 56:return d("MAWBridgeEphemeralSettingsUpdatedForUIHandler").call(f,e._0)}}:(c("recoverableViolation")("User is neither part of armadillo QE and dual send QE but somehow loaded this handler","messenger_web_product"),function(a){return b("Promise").resolve()});return e.reduce(function(a,b){var e=d("MAWBridgeUIEventQPLLogger").getInstanceKey();return a.then(function(a){d("MAWBridgeUIEventQPLLogger").start(e,b);return c("bs_curry")._1(q,b)}).then(function(a){d("MAWBridgeUIEventQPLLogger").endSuccess(e);return a})},b("Promise").resolve())},"readwrite")});c("promiseDone")(a,void 0,function(a){a=a.RE_EXN_ID===d("Promise.bs").JsError||a.RE_EXN_ID===c("bs_js_exn").$$Error?c("bs_caml_option").some(a._1):a;c("FBLogger")("messenger_e2ee_web").catching(a).warn("Error handling UI Event")})}g.handleEvents=a}),98);
__d("MAWBridgeOccamadilloVerifyThreadExistsGating",["cr:2849"],(function(a,b,c,d,e,f,g){"use strict";g["default"]=b("cr:2849")}),98);
__d("MAWOccamadilloOnMutexChange",["LSDatabaseType.bs","LSDefaultSyncGroups","LSIntEnum","LSSyncGroupsUtils","MAWGating","Promise","WALogger","bs_caml_int64","promiseDone"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["[Occamadillo] Resetting sync cursor and network request"]);h=function(){return a};return a}function i(a){var c=d("LSDefaultSyncGroups").e2eeMetadataSyncGroup;if(d("MAWGating").isOccamadillo()&&!d("MAWGating").isOccamadilloResumeSyncEnabled()&&c!=null)return a.table("sync_groups").put(babelHelpers["extends"]({},d("LSSyncGroupsUtils").defaultSyncGroup,{groupId:d("LSIntEnum").ofNumber(c.groupId)}));else return b("Promise").resolve()}function j(a){if(d("MAWGating").isOccamadillo()&&!d("MAWGating").isOccamadilloResumeSyncEnabled())return a.table("network_requests").put({epochId:void 0,failureCount:c("bs_caml_int64").zero,lastDelayedRequestTimestampMs:void 0,lastSentTimestampMs:c("bs_caml_int64").zero,lastSyncRequestTimestampMs:c("bs_caml_int64").zero,networkTaskIdentifier:void 0,syncDatabaseId:d("LSDatabaseType.bs").e2eeMessagingMetadataMailbox,taskQueueName:""});else return b("Promise").resolve()}function a(a){d("WALogger").LOG(h()),c("promiseDone")(a.runInTransaction(function(a){return b("Promise").all([i(a),j(a)])},"readwrite"))}g.onOccamadilloMutexChange=a}),98);
__d("LSMessagingThreadAttributionType.re",["LSMessagingThreadAttributionType.bs"],(function(a,b,c,d,e,f){c=(a=b("LSMessagingThreadAttributionType.bs")).unknown;f.unknown=c;d=a.unknownTest;f.unknownTest=d;e=a.unknownFailureRetry;f.unknownFailureRetry=e;b=a.messengerInbox;f.messengerInbox=b;c=a.messengerInboxInThread;f.messengerInboxInThread=c;d=a.messengerInboxThreadList;f.messengerInboxThreadList=d;e=a.messengerInboxNestedFolder;f.messengerInboxNestedFolder=e;b=a.messengerInboxRecentThreads;f.messengerInboxRecentThreads=b;c=a.messengerInboxRemainingThreads;f.messengerInboxRemainingThreads=c;d=a.messengerInboxMessageSearch;f.messengerInboxMessageSearch=d;e=a.messengerInboxImageSending;f.messengerInboxImageSending=e;b=a.messengerInboxForward;f.messengerInboxForward=b;c=a.messengerInboxArchivedThreads;f.messengerInboxArchivedThreads=c;d=a.messengerInboxPendingRequests;f.messengerInboxPendingRequests=d;e=a.messengerInboxActiveContacts;f.messengerInboxActiveContacts=e;b=a.messengerInboxThreadBannerBottomSheet;f.messengerInboxThreadBannerBottomSheet=b;c=a.messengerUniversalSearch;f.messengerUniversalSearch=c;d=a.messengerUniversalSearchNullState;f.messengerUniversalSearchNullState=d;e=a.messengerUniversalSearchKeyPressed;f.messengerUniversalSearchKeyPressed=e;b=a.messengerUniversalSearchMessageSearch;f.messengerUniversalSearchMessageSearch=b;c=a.messengerUniversalSearchAdvancedContentSearch;f.messengerUniversalSearchAdvancedContentSearch=c;d=a.montageAndActiveNow;f.montageAndActiveNow=d;e=a.montageAndActiveNowMontageInboxUnit;f.montageAndActiveNowMontageInboxUnit=e;b=a.montageAndActiveNowActiveNow;f.montageAndActiveNowActiveNow=b;c=a.montageAndActiveNowInboxComposer;f.montageAndActiveNowInboxComposer=c;d=a.montageAndActiveNowActiveAndHasStory;f.montageAndActiveNowActiveAndHasStory=d;e=a.montageAndActiveNowCustomStatus;f.montageAndActiveNowCustomStatus=e;b=a.messengerActiveNowFriendsTab;f.messengerActiveNowFriendsTab=b;c=a.messengerActiveNowFriendsTabFriendsTab;f.messengerActiveNowFriendsTabFriendsTab=c;d=a.messengerActiveNowFriendsTabPlaceHolder;f.messengerActiveNowFriendsTabPlaceHolder=d;e=a.messengerActiveNowFriendsTabRecentActive;f.messengerActiveNowFriendsTabRecentActive=e;b=a.messengerActiveNowFriendsTabRecentActiveAndStory;f.messengerActiveNowFriendsTabRecentActiveAndStory=b;c=a.messengerActiveNowFriendsTabContentDiscovery;f.messengerActiveNowFriendsTabContentDiscovery=c;d=a.messengerPendingRequests;f.messengerPendingRequests=d;e=a.messengerPendingRequestsInboxThreadList;f.messengerPendingRequestsInboxThreadList=e;b=a.messengerPendingRequestsPendingRequestsPage;f.messengerPendingRequestsPendingRequestsPage=b;c=a.messengerBroadcastFlow;f.messengerBroadcastFlow=c;d=a.messengerBroadcastFlowFromMessenger;f.messengerBroadcastFlowFromMessenger=d;e=a.messengerBroadcastFlowFromFb;f.messengerBroadcastFlowFromFb=e;b=a.messengerBroadcastFlowFromExternal;f.messengerBroadcastFlowFromExternal=b;c=a.messengerBroadcastFlowFromFbNewsfeedSharesheet;f.messengerBroadcastFlowFromFbNewsfeedSharesheet=c;d=a.messengerBroadcastFlowFromFbNewsfeedGoodwillComposer;f.messengerBroadcastFlowFromFbNewsfeedGoodwillComposer=d;e=a.messengerBroadcastFlowFromFbShortsViewer;f.messengerBroadcastFlowFromFbShortsViewer=e;b=a.messengerBroadcastFlowForwardGutter;f.messengerBroadcastFlowForwardGutter=b;c=a.messengerBroadcastFlowForwardLongclick;f.messengerBroadcastFlowForwardLongclick=c;d=a.messengerBroadcastFlowMessengerPhotoView;f.messengerBroadcastFlowMessengerPhotoView=d;e=a.messengerOmnipicker;f.messengerOmnipicker=e;b=a.messengerOmnipickerNullState;f.messengerOmnipickerNullState=b;c=a.messengerOmnipickerKeyPressed;f.messengerOmnipickerKeyPressed=c;d=a.messengerNotification;f.messengerNotification=d;e=a.messengerNotificationInThreadReply;f.messengerNotificationInThreadReply=e;b=a.messengerNotificationLongpressReply;f.messengerNotificationLongpressReply=b;c=a.messengerNotificationLongpressReaction;f.messengerNotificationLongpressReaction=c;d=a.clickToMessengerAd;f.clickToMessengerAd=d;e=a.clickToMessengerAdFromNewsfeed;f.clickToMessengerAdFromNewsfeed=e;b=a.clickToMessengerAdSendMessageCta;f.clickToMessengerAdSendMessageCta=b;c=a.clickToMessengerAdViewAndMessage;f.clickToMessengerAdViewAndMessage=c;d=a.clickToMessengerAdSendMessageCtaNewsfeedCtmAdsCta;f.clickToMessengerAdSendMessageCtaNewsfeedCtmAdsCta=d;e=a.payments;f.payments=e;b=a.paymentsBubbleClick;f.paymentsBubbleClick=b;c=a.rtc;f.rtc=c;d=a.rtcVoipIncall;f.rtcVoipIncall=d;e=a.rtcDrawerPromotion;f.rtcDrawerPromotion=e;b=a.fbPage;f.fbPage=b;c=a.fbPageAboutCard;f.fbPageAboutCard=c;d=a.fbPageProfileHeaderMessageButton;f.fbPageProfileHeaderMessageButton=d;e=a.fbPageProfileFooterMessageButton;f.fbPageProfileFooterMessageButton=e;b=a.fbPageProfileMoreDrawer;f.fbPageProfileMoreDrawer=b;c=a.fbPageResponsivenessContextCard;f.fbPageResponsivenessContextCard=c;d=a.fbPagePymmRhc;f.fbPagePymmRhc=d;e=a.fbProfile;f.fbProfile=e;b=a.fbProfileTimelineMessageButton;f.fbProfileTimelineMessageButton=b;c=a.fbProfileFacebookProfile;f.fbProfileFacebookProfile=c;d=a.fbProfileMessageButton;f.fbProfileMessageButton=d;e=a.fbProfileMessageButtonBloksUrl;f.fbProfileMessageButtonBloksUrl=e;b=a.fbSearch;f.fbSearch=b;c=a.fbSearchContextualProfileActionBarFromSearch;f.fbSearchContextualProfileActionBarFromSearch=c;d=a.fbSearchSearchMessageButton;f.fbSearchSearchMessageButton=d;e=a.fbSearchFbMessageSearchResults;f.fbSearchFbMessageSearchResults=e;b=a.fbSearchHighConfidenceCard;f.fbSearchHighConfidenceCard=b;c=a.fbSearchMentions;f.fbSearchMentions=c;d=a.fbSearchNullstateCta;f.fbSearchNullstateCta=d;e=a.crypto;f.crypto=e;b=a.messengerMontageComposer;f.messengerMontageComposer=b;c=a.messengerMontageComposerFriendsTab;f.messengerMontageComposerFriendsTab=c;d=a.messengerMontageComposerFriendsTabStoryAndActiveNow;f.messengerMontageComposerFriendsTabStoryAndActiveNow=d;e=a.messengerMontageReply;f.messengerMontageReply=e;b=a.messengerMontageReplyInboxThreadListProfile;f.messengerMontageReplyInboxThreadListProfile=b;c=a.messengerMontageReplyReplyContext;f.messengerMontageReplyReplyContext=c;d=a.messengerMontageReplyThreadNavBar;f.messengerMontageReplyThreadNavBar=d;e=a.messengerMontageReplyInboxThreadListProfileAuthorProfile;f.messengerMontageReplyInboxThreadListProfileAuthorProfile=e;b=a.messengerMontageReplyReplyContextAuthorProfile;f.messengerMontageReplyReplyContextAuthorProfile=b;c=a.messengerMontageReplyThreadNavBarAuthorProfile;f.messengerMontageReplyThreadNavBarAuthorProfile=c;d=a.messengerMontageReplyOneToOneChatThreadStoryBubble;f.messengerMontageReplyOneToOneChatThreadStoryBubble=d;e=a.messengerThreadMembersList;f.messengerThreadMembersList=e;b=a.marketplace;f.marketplace=b;c=a.marketplaceActivityBanner;f.marketplaceActivityBanner=c;d=a.marketplaceSendMessage;f.marketplaceSendMessage=d;e=a.fbStory;f.fbStory=e;b=a.fbStoryViewerSheetMenu;f.fbStoryViewerSheetMenu=b;c=a.fbStoryViewerSheetRow;f.fbStoryViewerSheetRow=c;d=a.fbStoryStoriesJewelNotification;f.fbStoryStoriesJewelNotification=d;e=a.fbStoryStoriesPushNotification;f.fbStoryStoriesPushNotification=e;b=a.fbStoryStoriesViewerConsumerReply;f.fbStoryStoriesViewerConsumerReply=b;c=a.fbStoryStoriesViewerConsumerArtifact;f.fbStoryStoriesViewerConsumerArtifact=c;d=a.fbStoryStoriesPageStoryConversations;f.fbStoryStoriesPageStoryConversations=d;e=a.fbStorySocialContextConversations;f.fbStorySocialContextConversations=e;b=a.workspeed;f.workspeed=b;c=a.workspeedComposerLikeButton;f.workspeedComposerLikeButton=c;d=a.workspeedComposerGifPicker;f.workspeedComposerGifPicker=d;e=a.mdotme;f.mdotme=e;b=a.mdotmeOrganicPost;f.mdotmeOrganicPost=b;c=a.mdotmeMarketingEmail;f.mdotmeMarketingEmail=c;d=a.mdotmeMbsOffsiteEmail;f.mdotmeMbsOffsiteEmail=d;e=a.customerChatPlugin;f.customerChatPlugin=e;b=a.customerChatPluginMobileRedirect;f.customerChatPluginMobileRedirect=b;c=a.customerChatPluginUpgradeFlow;f.customerChatPluginUpgradeFlow=c;d=a.customerChatPluginReEngagement;f.customerChatPluginReEngagement=d;e=a.fbFeed;f.fbFeed=e;b=a.fbFeedOrganicPost;f.fbFeedOrganicPost=b;c=a.fbFeedOrganicPostViewAndMessage;f.fbFeedOrganicPostViewAndMessage=c;d=a.fbFeedQuestionTriggeredConvo;f.fbFeedQuestionTriggeredConvo=d;e=a.fbFeedDynamicHoverCard;f.fbFeedDynamicHoverCard=e;b=a.fbFeedOrganicPostNewsfeedPagePostCta;f.fbFeedOrganicPostNewsfeedPagePostCta=b;c=a.fbFeedOrganicPostNewsfeedBumperSmcta;f.fbFeedOrganicPostNewsfeedBumperSmcta=c;d=a.fbFeedBcfOpenChatButton;f.fbFeedBcfOpenChatButton=d;e=a.fbFeedReactorsListMessageButton;f.fbFeedReactorsListMessageButton=e;b=a.fbFeedReplyToAuthor;f.fbFeedReplyToAuthor=b;c=a.fbFeedUfiSendSuggestions;f.fbFeedUfiSendSuggestions=c;d=a.fbFeedBcf;f.fbFeedBcf=d;e=a.fbNotification;f.fbNotification=e;b=a.fbNotificationJewelNotif;f.fbNotificationJewelNotif=b;c=a.fbNotificationPushNotif;f.fbNotificationPushNotif=c;d=a.fbEvent;f.fbEvent=d;e=a.fbEventMessageHost;f.fbEventMessageHost=e;b=a.fbEventShareClassMaterials;f.fbEventShareClassMaterials=b;c=a.supportResources;f.supportResources=c;d=a.supportResourcesFrxAction;f.supportResourcesFrxAction=d;e=a.leadGenMessaging;f.leadGenMessaging=e;b=a.leadGenMessagingPreSubmission;f.leadGenMessagingPreSubmission=b;c=a.leadGenMessagingPostSubmission;f.leadGenMessagingPostSubmission=c;d=a.leadGenMessagingCrossChannelVerticalPresentAndroid;f.leadGenMessagingCrossChannelVerticalPresentAndroid=d;e=a.leadGenMessagingCrossChannelHscrollAndroid;f.leadGenMessagingCrossChannelHscrollAndroid=e;b=a.messengerGraph;f.messengerGraph=b;c=a.messengerGraphSelectContact;f.messengerGraphSelectContact=c;d=a.messengerChat;f.messengerChat=d;e=a.messengerChatFromJewelThreadList;f.messengerChatFromJewelThreadList=e;b=a.messengerChatInThread;f.messengerChatInThread=b;c=a.messengerChatForward;f.messengerChatForward=c;d=a.messengerArchivedThreads;f.messengerArchivedThreads=d;e=a.messengerArchivedThreadsArchivedThreadsFolder;f.messengerArchivedThreadsArchivedThreadsFolder=e;b=a.jewel;f.jewel=b;c=a.jewelThreadList;f.jewelThreadList=c;d=a.jewelSearch;f.jewelSearch=d;e=a.jewelNewMessage;f.jewelNewMessage=e;b=a.jewelNestedFolder;f.jewelNestedFolder=b;c=a.chatheads;f.chatheads=c;d=a.chatheadsRecentThreads;f.chatheadsRecentThreads=d;e=a.chatheadsOverflow;f.chatheadsOverflow=e;b=a.chatheadsNewMessage;f.chatheadsNewMessage=b;c=a.sidebar;f.sidebar=c;d=a.sidebarContactsList;f.sidebarContactsList=d;e=a.sidebarContactsSearch;f.sidebarContactsSearch=e;b=a.sidebarContactsGroups;f.sidebarContactsGroups=b;c=a.messengerCommunityMessaging;f.messengerCommunityMessaging=c;d=a.messengerCommunityMessagingCommunityChannel;f.messengerCommunityMessagingCommunityChannel=d;e=a.messengerCommunityMessagingFullscreenChat;f.messengerCommunityMessagingFullscreenChat=e;b=a.fbPlatformLogin;f.fbPlatformLogin=b;c=a.fbPlatformLoginLoginConnectWithMessenger;f.fbPlatformLoginLoginConnectWithMessenger=c;d=a.contactManager;f.contactManager=d;e=a.contactManagerContactShare;f.contactManagerContactShare=e;b=a.contactManagerPeopleTabContactList;f.contactManagerPeopleTabContactList=b;c=a.contactManagerPeopleTabContactSearch;f.contactManagerPeopleTabContactSearch=c;d=a.contactManagerIconContactList;f.contactManagerIconContactList=d;e=a.contactManagerIconContactSearch;f.contactManagerIconContactSearch=e;b=a.messagingInboxInBlue;f.messagingInboxInBlue=b;c=a.messagingInboxInBlueThreadList;f.messagingInboxInBlueThreadList=c;d=a.messagingInboxInBluePeoplePicker;f.messagingInboxInBluePeoplePicker=d;e=a.messagingInboxInBlueInboxIcon;f.messagingInboxInBlueInboxIcon=e;b=a.messagingInboxInBlueSwipeFromRight;f.messagingInboxInBlueSwipeFromRight=b;c=a.messagingInboxInBlueMibNotification;f.messagingInboxInBlueMibNotification=c;d=a.messagingInboxInBlueActiveNow;f.messagingInboxInBlueActiveNow=d;e=a.messagingInboxInBlueSuggestedChats;f.messagingInboxInBlueSuggestedChats=e;b=a.messagingInboxInBlueChatPreviewBanner;f.messagingInboxInBlueChatPreviewBanner=b;c=a.messagingInboxInBlueThreadViewCoreNullState;f.messagingInboxInBlueThreadViewCoreNullState=c;d=a.messagingInboxInBlueMessageRequests;f.messagingInboxInBlueMessageRequests=d;e=a.messagingInboxInBlueSpam;f.messagingInboxInBlueSpam=e;b=a.messagingInboxInBlueFbGroups;f.messagingInboxInBlueFbGroups=b;c=a.messagingInboxInBlueMessengerPeekStateButton;f.messagingInboxInBlueMessengerPeekStateButton=c;d=a.messagingInboxInBlueMessengerPeekStateTooltip;f.messagingInboxInBlueMessengerPeekStateTooltip=d;e=a.messagingInboxInBlueBroadcastFlow;f.messagingInboxInBlueBroadcastFlow=e;b=a.messagingInboxInBlueThreadViewHeader;f.messagingInboxInBlueThreadViewHeader=b;c=a.messagingInboxInBluePrivacySettings;f.messagingInboxInBluePrivacySettings=c;d=a.messagingInboxInBlueArchivedChats;f.messagingInboxInBlueArchivedChats=d;e=a.mibNotification;f.mibNotification=e;b=a.mibNotificationPushNotification;f.mibNotificationPushNotification=b;c=a.mibNotificationJewelNotification;f.mibNotificationJewelNotification=c;d=a.mibNotificationDirectPushNotif;f.mibNotificationDirectPushNotif=d;e=a.mibNotificationDirectJewelNotif;f.mibNotificationDirectJewelNotif=e;b=a.messengerRestrictedAccounts;f.messengerRestrictedAccounts=b;c=a.armadilloCutoverThreadLinkingMessage;f.armadilloCutoverThreadLinkingMessage=c;d=a.callsTab;f.callsTab=d;e=a.miniShopViewMenuButton;f.miniShopViewMenuButton=e;b=a.sharesheet;f.sharesheet=b;c=a.sharesheetGeneralizedBroadcastFlow;f.sharesheetGeneralizedBroadcastFlow=c;d=a.sharesheetOffPlatformSharingHScroll;f.sharesheetOffPlatformSharingHScroll=d;e=a.ufi;f.ufi=e;b=a.ufiGeneralizedBroadcastFlow;f.ufiGeneralizedBroadcastFlow=b;c=a.chatheadClickCollapsed;f.chatheadClickCollapsed=c;d=a.timelineMessageButton;f.timelineMessageButton=d;e=a.directReplyIntent;f.directReplyIntent=e;b=a.fbGroups;f.fbGroups=b;c=a.fbGroupsInbox;f.fbGroupsInbox=c;d=a.fbGroupsPickerExistingChat;f.fbGroupsPickerExistingChat=d;e=a.fbGroupsPickerJoinChat;f.fbGroupsPickerJoinChat=e;b=a.fbGroupsMemberList;f.fbGroupsMemberList=b;c=a.devices;f.devices=c;d=a.devicesStella;f.devicesStella=d;e=a.fbWellbeing;f.fbWellbeing=e;b=a.fbWellbeingIncallUnblockingNotification;f.fbWellbeingIncallUnblockingNotification=b;c=a.messengerDeepLinking;f.messengerDeepLinking=c;d=a.readOnlyCutoverThread;f.readOnlyCutoverThread=d;e=a.readOnlyCutoverThreadArmadilloThread;f.readOnlyCutoverThreadArmadilloThread=e;b=a.armadilloThread;f.armadilloThread=b;c=a.armadilloThreadReadOnlyCutoverThread;f.armadilloThreadReadOnlyCutoverThread=c;d=a.armadilloThreadExternalLink;f.armadilloThreadExternalLink=d;e=a.fbShorts;f.fbShorts=e;b=a.fbShortsProfile;f.fbShortsProfile=b;c=a.fbShortsReactorsListMessageButton;f.fbShortsReactorsListMessageButton=c;d=a.sendPlugin;f.sendPlugin=d;e=a.sendAsMessageFromNt;f.sendAsMessageFromNt=e;b=a.messengerPublicChatsMessaging;f.messengerPublicChatsMessaging=b;c=a.messengerGrowth;f.messengerGrowth=c;d=a.messengerGrowthNotificationsEntrypoint;f.messengerGrowthNotificationsEntrypoint=d;e=a.friendsHome;f.friendsHome=e;b=a.friendsHomeActiveNow;f.friendsHomeActiveNow=b;c=a.friendsHomeMessageNewFriends;f.friendsHomeMessageNewFriends=c;d=a.friendsHomePostAcceptMessaging;f.friendsHomePostAcceptMessaging=d;e=a.externalLinkXma;f.externalLinkXma=e;b=a.externalLinkXmaFromComposer;f.externalLinkXmaFromComposer=b;c=a.externalLinkXmaFromDeepLinking;f.externalLinkXmaFromDeepLinking=c;d=a.externalLinkXmaFromShareExtension;f.externalLinkXmaFromShareExtension=d;e=a.fbNotifications;f.fbNotifications=e;b=a.quickPromotion;f.quickPromotion=b;c=a.quickPromotionCta;f.quickPromotionCta=c;d=a.quickPromotionInterstitial;f.quickPromotionInterstitial=d;e=a.quickPromotionTopBanner;f.quickPromotionTopBanner=e;b=a.fbmInAppNotifs;f.fbmInAppNotifs=b;c=a.creatorSupport;f.creatorSupport=c;d=a.creatorSupportMessengerToast;f.creatorSupportMessengerToast=d}),null);
__d("MAWDBUsageMetrics",["gkx"],(function(a,b,c,d,e,f,g){"use strict";var h=30*1e3,i=0,j=null;function a(){if(Date.now()>i+h){var a=navigator.storage;a==null?void 0:a.estimate==null?void 0:a.estimate().then(function(a){j=a});i=Date.now()}return j}c("gkx")("5444")&&a();g.getMAWDBUsageMetrics=a}),98);
__d("WAShiftTimer",["WAErr"],(function(a,b,c,d,e,f,g){a=function(){function a(a){var b=this;this.$2=0;this.$3=0;this.ts=0;this.$4=0;this.$5=0;this.$6=0;this.$7=void 0;this.$8=function(){var a=b.$7,c=b.$1;b.$3=0;b.$2=0;b.ts=0;b.$4=0;b.$5=0;b.$6=0;b.$7=void 0;c(a)};this.onOrBefore=function(a,c){h(a);var d=Date.now();d=d+a;var e=b.$5;if(e!==0&&e<d)return;e=b.$6;if(e!==0&&d<e)return;b.$5=d;!b.$3&&(!b.$2||d<b.ts)&&b.$9(d,a,c)};this.forceRunNow=function(a){b.$2&&clearTimeout(b.$2),b.$3&&cancelAnimationFrame(b.$3),b.$7=a,b.$8()};this.cancel=function(){b.$2&&clearTimeout(b.$2),b.$3&&cancelAnimationFrame(b.$3),b.$2=0,b.$3=0,b.ts=0,b.$4=0,b.$5=0,b.$6=0,b.$7=void 0};this.$1=a}var b=a.prototype;b.onOrBeforeRepaint=function(a){if(this.$3)return;var b=Date.now(),c=this.$6;if(c!==0&&b<c)return;c=this.$5;(c===0||b<c)&&(this.$5=b);this.$2&&(clearTimeout(this.$2),this.$2=0);(!this.ts||this.ts>b)&&(this.ts=b);this.$7=a;this.$3=requestAnimationFrame(this.$8)};b.onOrAfter=function(a,b){h(a);var c=Date.now();c=c+a;var d=this.$6;if(d!==0&&c<d)return;d=this.$5;if(d!==0&&d<c)return;this.$6=c;(!this.$2||this.ts<c)&&this.$9(c,a,b)};b.debounce=function(a,b){h(a),this.$10(Date.now(),a,b)};b.debounceAndCap=function(a,b,c){h(a);h(b);var d=Date.now();b=d+b;var e=this.$6,f=this.$5;(e===0||e<=b)&&(f===0||b<f)&&(this.$5=b);this.$10(d,a,c)};b.forceRunNowIfScheduled=function(){this.$2?(clearTimeout(this.$2),this.$8()):this.$3&&(cancelAnimationFrame(this.$3),this.$8())};b.isScheduled=function(){return this.$2!==0||this.$3!==0};b.$10=function(a,b,c){var d=a+b,e=this.$6;if(e!==0&&d<e)return;e=this.ts;var f=this.$5;f!==0&&f<d?e<f&&this.$9(f,f-a,c):e<d&&this.$9(d,b,c)};b.$9=function(a,b,c){this.$3&&(cancelAnimationFrame(this.$3),this.$3=0);this.$7=c;this.ts=a;if(this.$2){c=a-this.$4;if(-16<c&&c<16)return;clearTimeout(this.$2)}this.$2=setTimeout(this.$8,b);this.$4=a};return a}();function h(a){if(!(a>=0))throw c("WAErr")("ShiftTimer must be given delay >= 0")}g.ShiftTimer=a}),98);
__d("WABridgeBatcher",["WAShiftTimer"],(function(a,b,c,d,e,f,g){var h=20,i=1e3;a=function(){function a(a,b){var c=this;this.$1=null;this.$4=h;this.$5=Date.now();this.$6=new(d("WAShiftTimer").ShiftTimer)(function(){var a=c.$1;if(a==null)return;c.$1=null;c.$2(a)});this.$2=b;this.$3=a}var b=a.prototype;b.addEvent=function(a){var b=this.$1;this.$1=b?this.$3(b,a):[a];if(this.$6.isScheduled())return;b=this.$4;if(b<1){a=Date.now();var c=Math.max(a-this.$5,0)/i;b=Math.min(b+c,h);this.$4=b;this.$5=a}b>=1?(c=0,this.$4=b-1):(c=Math.ceil(i*(1-b)),this.$4=0);this.$6.onOrBefore(c)};b.cancel=function(){this.$1=null,this.$6.cancel()};return a}();g.BridgeBatcher=a}),98);
__d("WAPromiseCallSync",["Promise"],(function(a,b,c,d,e,f){function a(a,c){try{for(var d=arguments.length,e=new Array(d>2?d-2:0),f=2;f<d;f++)e[f-2]=arguments[f];return b("Promise").resolve(a.apply(c,e))}catch(a){return b("Promise").reject(a)}}f.promiseCallSync=a}),66);
__d("WAPromiseManagement",["WAPromiseCallSync"],(function(a,b,c,d,e,f,g){function a(a){var b=null,c=function(){b||(b=d("WAPromiseCallSync").promiseCallSync(a)["finally"](function(){b=null}));return b};c.isPending=function(){return!!b};return c}function b(a,b){var c=new Map();return function(d){var e=a(d),f=c.get(e);if(f)return f;try{f=Promise.resolve(b(d))}catch(a){f=Promise.reject(a)}d=f["finally"](function(){return void c["delete"](e)});c.set(e,d);return d}}var h=new Set();function c(a){h.add(a),a["finally"](function(){h["delete"](a)})}g.nullaryCacheWhilePending=a;g.cacheWhilePending=b;g.preventGarbageCollection=c}),98);
__d("WACrossWorkerPortal",["Promise","WABridgeBatcher","WAErr","WALogger","WAPromiseManagement"],(function(a,b,c,d,e,f,g){function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["absorbPortal: transferring request #",""]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["Bridge unexpected non-result to call"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["Bridge unexpected result to cast"]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["Bridge unrecognized result ",""]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(["Bridge "," response of ",""]);l=function(){return a};return a}function m(){var a=babelHelpers.taggedTemplateLiteralLoose(["Bridge "," request for ",""]);m=function(){return a};return a}function n(){var a=babelHelpers.taggedTemplateLiteralLoose(["Bridge queuing "," msgs"]);n=function(){return a};return a}function o(){var a=babelHelpers.taggedTemplateLiteralLoose(["Bridge sending "," across (delayed)"]);o=function(){return a};return a}function p(){var a=babelHelpers.taggedTemplateLiteralLoose(["Bridge received msg on old port"]);p=function(){return a};return a}function q(){var a=babelHelpers.taggedTemplateLiteralLoose(["Bridge updating port"]);q=function(){return a};return a}var r=function(){function a(a,b,c){var e=this;this.port=null;this.$2=1;this.openRequests=new Map();this.listeners=new Set();this.$1=a;this.sendStream=new(d("WABridgeBatcher").BridgeBatcher)(b,function(a){e.$3(a)});c.forEach(function(b){a.setNamespaceHandler(b,e.$4(b))})}var e=a.prototype;e.addListener=function(a){var b=this;this.listeners.add(a);return function(){return b.listeners["delete"](a)}};e.setPort=function(a){var b=this;d("WALogger").LOG(q());this.port=a;this.sendStream.cancel();a.onmessage=function(c){if(b.port!==a){d("WALogger").WARN(p()).devConsole(c.data);return}c=c.data;if(!c)return;c.forEach(function(c){b.$5(c,"incoming"),b.$6(a,c)})};this.openRequests.forEach(function(a){a=a.request;d("WALogger").LOG(o(),a.name);b.sendStream.addEvent({type:"request",content:a})})};e.getBridge=function(){return this.$1};e.$4=function(a){var b=this;return function(c,d,e,f){b.$7(a,c,d,e,f)}};e.$7=function(a,b,c,d,e){var f=this.$2++;a={requestId:f,expectsResponse:!!d,namespace:a,name:b,arg:c,silentLog:e};this.openRequests.set(f,{request:a,resolver:d});this.sendStream.addEvent({type:"request",content:a})};e.$8=function(a,b){if(a!==this.port)return;this.sendStream.addEvent({type:"result",content:b})};e.$3=function(a){var b=this,c=this.port;if(!c){d("WALogger").LOG(n(),a.length);return}c.postMessage(a);a.forEach(function(a){return b.$5(a,"outgoing")})};e.$5=function(a,b){this.listeners.forEach(function(c){return c(a,b)})};e.$6=function(a,e){var f=this;if(e.type==="request"){var g=e.content,h=g.namespace,n=g.name,o=g.requestId,p=g.arg,q=g.expectsResponse,r=g.silentLog;r||d("WALogger").LOG(m(),o,n);g=this.$1;if(q){q=g.sendAndReceive(h,n,p,r).then(function(b){f.$8(a,{requestId:o,type:"success",result:b,silentLog:r})},function(b){f.$8(a,{requestId:o,type:"error",result:String(b),silentLog:r})});d("WAPromiseManagement").preventGarbageCollection(q)}else{g.fireAndForget(h,n,p,r);q={type:"result",content:{requestId:o,type:"handled",silentLog:r}};this.$5(q,"outgoing");a.postMessage([q])}}else{e.type;g=e.content;h=g.requestId;n=g.type;p=g.result;q=g.silentLog;q||d("WALogger").LOG(l(),h,n);e=this.openRequests.get(h);if(!e){d("WALogger").WARN(k(),h);return}switch(n){case"success":case"error":this.openRequests["delete"](h);g=e.resolver;g?g(n==="success"?p:b("Promise").reject(c("WAErr")(p))):d("WALogger").ERROR(j());break;case"handled":e.resolver?d("WALogger").ERROR(i()):this.openRequests["delete"](h);break}}};return a}();function a(a,b,c){return new r(a,c,b)}function e(a){var b;(b=a.port)==null?void 0:b.close();a.port=null;a.sendStream.cancel();b=a.openRequests;a.openRequests=new Map();var c=a.getBridge();b.forEach(function(a){var b=a.request;a=a.resolver;var e=b.namespace,f=b.name,g=b.arg,i=b.silentLog;d("WALogger").LOG(h(),b.requestId);a?a(c.sendAndReceive(e,f,g,i)):c.fireAndForget(e,f,g,i)})}g.CrossWorkerPortal=r;g.attachPortal=a;g.killPortalAndSendPendingToBridge=e}),98);
__d("WADevToolMessageChannel",[],(function(a,b,c,d,e,f){var g=new MessageChannel();a=function(){g=new MessageChannel();return g};b=function(){return g};f.createNewChannel=a;f.getMostRecentChannel=b}),66);
__d("MAWCommonSetupBridge",["CurrentUser","ErrorTransport","I64","LSDatabaseDeferred","LSMessagingThreadAttributionType.re","MAWBridge","MAWChatJid.bs","MAWCurrentUser","MAWDBUsageMetrics","MAWDbMedia","MAWEBSwitch","MAWFrontendMediaUtils","MAWGating","MAWJobActionsV2","MAWThreadCutover.bs","MWLogSend.bs","MessagingThreadType.re","ODS","Promise","QPLEvent","QPLUserFlow","ReStore.bs","WACrossWorkerPortal","WADevToolMessageChannel","WADevToolsBridge","WADualSendMsgUtils","WAJids","cr:2036","err","gkx","promiseDone","requireDeferred"],(function(a,b,c,d,e,f,g){"use strict";var h=c("requireDeferred")("MAWMainThreadLogger").__setRef("MAWCommonSetupBridge"),i=c("gkx")("5444"),j=new Set([25312111,25311870,25308825]),k=new Map(),l=new Map([[d("MAWDbMedia").MEDIA_TYPE.IMAGE,8],[d("MAWDbMedia").MEDIA_TYPE.VIDEO,10],[d("MAWDbMedia").MEDIA_TYPE.GIF,6],[d("MAWDbMedia").MEDIA_TYPE.STICKER,4],[d("MAWDbMedia").MEDIA_TYPE.PTT,11]]),m=new Set([25312150,25313100,25304093,1056840931,25299294]);function n(a,b){return a+"_"+b}function o(a,b,e){return d("LSDatabaseDeferred").db.then(function(f){f=d("ReStore.bs").toGenericStorage(f);return d("MAWThreadCutover.bs").isCutoverSecureThreadFromChatJid(f,a).then(function(a){c("QPLUserFlow").addAnnotations(b,{bool:{isCutover:a}},{instanceKey:e})})})}var p={fbErrorProxy:function(a){d("ErrorTransport").log(a)},log:function(a){var b=a.context,c=a.logLevel,d=a.logString,e=a.tags;switch(c){case"log":h.onReadyImmediately(function(a){a=a.info;return a(d,b,e)});return;case"warn":h.onReadyImmediately(function(a){a=a.warn;return a(d,b,e)});return;case"logRestricted":h.onReadyImmediately(function(a){a=a.logRestricted;return a(d,b,e)});return;case"debug":break;case"error":break;default:break}},logError:function(a){var b=a.context,c=a.entriesToReport,d=a.framesToPop,e=a.logString,f=a.message,g=a.stack,i=a.tags;h.onReadyImmediately(function(a){a=a.logError;return a(e,b,i,f,g,d,c)})},odsBumpEntityKey:function(a){var b=a.amount,e=a.entity;a=a.key;d("ODS").bumpEntityKey(3185,e,a+"."+(c("CurrentUser").getAppID()||"unknown"),b)},onJobFinished:function(a){a.type==="createGroup"&&a.originalArgs.key!=null&&d("MAWJobActionsV2").recentFinishedJobsCache.set(a.originalArgs.key,a.result);switch(a.type){case"sendMsg":case"sendMediaMsg":case"sendReactionMsg":case"sendXMAShareMsg":var b=a.originalArgs.chatJid,e=a.type==="sendXMAShareMsg"?a.originalArgs.xmaMsgExternalId:a.originalArgs.externalId;k.set(n(b,e),a.originalArgs)}if(a.type==="sendWrittenMsg"){b=a.originalArgs.protocolMsgId;e=b.chat;var f=b.externalId;b=n(e,f);e=k.get(b);k["delete"](b);if(a.result.type==="success"&&e!=null){var g=e.args,h=e.chatJid;b=e.file;a=g.reactToAuthor!=null;var i;a&&(i=g.reaction!=null?20:27);e=g.specialTextSize!=null;b=b!=null?d("MAWFrontendMediaUtils").getMediaTypeAndServerMediaTypeFromBlob(b.type).mediaType:null;var j=(b=l.get(b))!=null?b:e?3:a?i:0,m=d("WAJids").switchOnMsgrChatJidType(h,{group:function(){return d("MessagingThreadType.re").secureMessageOverWaGroup},user:function(){return d("MessagingThreadType.re").secureMessageOverWaOneToOne}});c("promiseDone")(d("LSDatabaseDeferred").db.then(function(a){var b=d("ReStore.bs").toGenericStorage(a);c("promiseDone")(d("MAWChatJid.bs").toThreadKey(b,h).then(function(a){d("MWLogSend.bs").log(b,a,m,f,[],d("I64").of_string(d("MAWCurrentUser").getID()),d("LSMessagingThreadAttributionType.re").unknown,j,g.quote!=null,1,1,d("I64").to_string(a),g==null?void 0:(a=g.ephemeralSetting)==null?void 0:a.ephemeralExpirationInSec,d("WADualSendMsgUtils").isDualSendJid(h)?["dst:8"]:void 0,void 0)}))}))}}},qplEvent:function(a){var e=a.action,f=a.annotations,g=a.event,h=a.instanceKey,k=a.nonTrackableAnnotations,l=a.timestamp;if(!c("CurrentUser").isEmployee()&&j.has(d("QPLEvent").getMarkerId(g)))return;var n=h||0;h=k==null?void 0:(a=k.string)==null?void 0:a.jid;k=h!=null?d("WAJids").validateChatJid(h):void 0;a=m.has(d("QPLEvent").getMarkerId(g))&&k!=null?o(k,g,n):b("Promise").resolve();switch(e.type){case"start":c("QPLUserFlow").start(g,{annotations:babelHelpers["extends"]({},f||{},{bool:babelHelpers["extends"]({},(f==null?void 0:f.bool)||{},{isBulkifyHIMEnabled:d("MAWGating").isBulkifyHIMEnabled(),isDev:0,isDeviceRegistrationDomainUniquenessEnabled:c("gkx")("7858"),isEBEnabled:c("MAWEBSwitch").isEnabled(),isGifSearchEnbled:c("gkx")("7045"),isOccamadillo:d("MAWGating").isOccamadillo(),isTlcPublicUser:d("MAWGating").isTlcPublicUser(),stanzaQueue:d("MAWGating").enableRawStanzaQueueStore(),waitForCommsConnection:c("gkx")("7503")})}),instanceKey:n,timestamp:l});break;case"success":if(i){h=d("MAWDBUsageMetrics").getMAWDBUsageMetrics();k=(k=h==null?void 0:(k=h.usageDetails)==null?void 0:k.indexedDB)!=null?k:h==null?void 0:h.usage;k!=null&&c("QPLUserFlow").addAnnotations(g,{"int":{indexedDbSizeInBytes:k}},{instanceKey:n})}c("QPLUserFlow").addAnnotations(g,{bool:{isRelaxedDurability:!0}},{instanceKey:n});a["finally"](function(){c("QPLUserFlow").endSuccess(g,{annotations:f,instanceKey:n,timestamp:l})});break;case"point":c("QPLUserFlow").addPoint(g,e.name,{data:f,instanceKey:n,timestamp:l});break;case"failure":c("QPLUserFlow").addAnnotations(g,{bool:{isRelaxedDurability:!0}},{instanceKey:n});a["finally"](function(){c("QPLUserFlow").endFailure(g,e.name,{annotations:f,instanceKey:n,timestamp:l})});break;default:throw c("err")("Bridge sends unreachable qplEvent action type")}}},q=function(a,b){a.push(b);return a};a=function(a){var e=a.customizeEventHandlers;a=a.worker;var f=d("MAWBridge").getBridge();f.setHandlers("event",babelHelpers["extends"]({},p,e));e=d("WACrossWorkerPortal").attachPortal(f,["backend"],q);e.setPort(a);if(c("gkx")("5147")){var g=d("WADevToolsBridge").getDevToolBridge();a=new MessageChannel();var h=d("WACrossWorkerPortal").attachPortal(g,["backend"],q),i=d("WACrossWorkerPortal").attachPortal(g,["devtool"],q);h.setPort(d("WADevToolMessageChannel").getMostRecentChannel().port1);i.setPort(a.port1);b("cr:2036")==null?void 0:b("cr:2036").connectAddonPort(a.port2);e.addListener(function(a,b){return g.fireAndForget("devtool","bridgeMessage",{direction:b==="outgoing"?"toWorker":"toMain",msg:a,ts:Date.now()},!0)})}return b("Promise").resolve(f)};g.commonBridgeEventHandlers=p;g.initBridge=a}),98);
__d("MAWSetupBridge",["LSDatabaseDeferred","LSInitSyncCompleteSubscription.bs","MAWBridgeUIEventHandler.bs","MAWBridgeUIEventsWrapper","MAWCommonSetupBridge","MAWCryptoAuthToken","MAWMainThreadLogger","Run","cr:1265","regeneratorRuntime","requireDeferred"],(function(a,b,c,d,e,f,g){"use strict";var h=c("requireDeferred")("ArmadilloCutoverClientFalcoEvent").__setRef("MAWSetupBridge"),i=c("requireDeferred")("MAWSetupBridgeOfflineSnapshot").__setRef("MAWSetupBridge"),j=d("LSDatabaseDeferred").db.then(d("LSInitSyncCompleteSubscription.bs").use).then(function(){return d("LSDatabaseDeferred").db}),k=function(a){h.loadImmediately(function(b){b=b.log;return b(function(){return{armadillo_thread_id:a.armadilloThreadId,domain:a.domain,event:a.event,event_details:a.eventDetails,open_thread_id:a.openThreadId,success:a.success,trace_id:a.traceId}})})};function a(a){var c=a.dispatch,e=a.environment,f=a.logout,g=a.worker;function h(){g.postMessage({type:"force-flush-data"})}d("Run").onUnload(h);d("Run").onBeforeUnload(h,!1);return d("MAWCommonSetupBridge").initBridge({customizeEventHandlers:{flushLogs:function(a){return d("MAWMainThreadLogger").logToHistoryInBulk(a.logs)},logCutoverEvent:k,logout:f,offlineSnapshot:function(){var a=arguments;return b("regeneratorRuntime").async(function(c){while(1)switch(c.prev=c.next){case 0:c.next=2;return b("regeneratorRuntime").awrap(i.load());case 2:c.t0=void 0;c.t1=a;return c.abrupt("return",c.sent.apply(c.t0,c.t1));case 5:case"end":return c.stop()}},null,this)},rotateCryptoAuthToken:function(){return d("MAWCryptoAuthToken").fetchFreshCAT(e)},uiUpdate:function(a){a=a.events;c&&a.forEach(function(a){return c(a)});b("cr:1265")==null?void 0:b("cr:1265").recordBridgeUIEvent(a);d("MAWBridgeUIEventHandler.bs").handleEvents(j,a.map(d("MAWBridgeUIEventsWrapper").UIEventToRE))}},worker:g})}g.setupBridge=a}),98);
__d("MAWSetupMutex.react",["cr:2671","react"],(function(a,b,c,d,e,f,g){"use strict";d("react");function a(a){var c=a.environment,d=a.fbId;a=a.platformSetupUtils;b("cr:2671").useMutex(c,d,a);return null}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("SharedWorkerBundleResource",["SiteData","SpinConfigSitevarConfig","TrustedTypesWebWorkerScriptURLPolicy","WebStorage","err","gkx","performanceNavigationStart"],(function(a,b,c,d,e,f,g){"use strict";var h="__swbundle__",i=c("SpinConfigSitevarConfig").pin_time_window*1e3,j=new Set(),k=!1;function l(a){return a==null?null:JSON.parse(a)}function m(a){a=l(a.getItem(h));if(a==null)return null;var b=c("performanceNavigationStart")();return Object.fromEntries(Object.entries(a).filter(function(a){a[0];a=a[1];return b-a.spin_time*1e3<=i}))}function n(a,b,c){var d=m(a);if(d==null){var e;a.setItem(h,JSON.stringify((e={},e[b]=c,e)));return}d[b]=c;a.setItem(h,JSON.stringify(d))}function o(a,b){var c=m(a);if(c!=null&&Object.prototype.hasOwnProperty.call(c,b)){delete c[b];a.setItem(h,JSON.stringify(c));return}}function p(a,b){a=l(a.getItem(h));return a==null?null:a[b]}function q(a,b,d){a=new SharedWorker(c("TrustedTypesWebWorkerScriptURLPolicy").createScriptURL(a),{name:b});a.port.start();a.port.postMessage({type:"execute-worker",args:[d]});return a}function r(a,b,c,d){b.port.addEventListener("message",function(b){var e;if(typeof b.data==="object"&&((e=b.data)==null?void 0:e.type)==="sw-get-rev"&&typeof b.data.response==="object"){e=(e=b.data)==null?void 0:(e=e.response)==null?void 0:e.workerRevision;b=(b=b.data)==null?void 0:(b=b.response)==null?void 0:b.spinTime;if(e==null||typeof e!=="number")return;if(b==null||typeof b!=="number")return;n(a,d,{url:c,rev:e,spin_time:b})}}),b.port.postMessage({type:"sw-get-rev",args:[]})}function a(a,b,d){var e;d=(d=d)!=null?d:a.name;var f=c("WebStorage").getLocalStorage();if(f==null)throw c("err")("Shared worker could not start, missing session storage");var g=p(f,d);if(g!=null)if(g.rev>=c("SiteData").client_revision&&(!k||j.has(d)||g.url===a.url))e=q(g.url,d,a);else{o(f,d);g=new SharedWorker(g.url,d);g.port.postMessage({type:"sw-shutdown",args:[]});e=q(a.url,d,a);r(f,e,a.url,d)}else e=q(a.url,d,a),r(f,e,a.url,d);e.port.addEventListener("message",function(a){var c;typeof a.data==="object"&&((c=a.data)==null?void 0:c.type)==="sw-shutdown"&&typeof a.data.response==="object"&&(b==null?void 0:b())});k&&j.add(d);return e}g.createPushSafeSharedWebWorker=a}),98);
__d("WorkerBundleResource",["TrustedTypesWebWorkerScriptURLPolicy"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b){var d,e;for(var f=arguments.length,g=new Array(f>2?f-2:0),h=2;h<f;h++)g[h-2]=arguments[h];var i=(d=b)!=null?d:a.name,j=new window.URL(a.url,window.location.href).href;if(j==null){var k=new Error("Can't start up worker without a resource url.");k.stack;throw k}var l=new Blob(["__DEV__=false;","if (self.trustedTypes && self.trustedTypes.createPolicy) {","const escapeScriptURLPolicy = self.trustedTypes.createPolicy('workerPolicy', {\n  createScriptURL: url => url });","importScripts(escapeScriptURLPolicy.createScriptURL('"+j+"'));","} else {","importScripts('"+j+"');","}","StartBundle.apply(null, "+JSON.stringify([a].concat((e=g)!=null?e:[]))+")"],{type:"text/javascript"}),m=window.URL.createObjectURL(l),n=new Worker(c("TrustedTypesWebWorkerScriptURLPolicy").createScriptURL(m),{name:i}),o=n.terminate;n.terminate=function(){window.URL.revokeObjectURL(this._objectURL),o.apply(this,arguments)};return n}function b(a,b){b=(b=b)!=null?b:a.name;b=new SharedWorker(c("TrustedTypesWebWorkerScriptURLPolicy").createScriptURL(a.url),{name:b});b.port.start();b.port.postMessage({type:"execute-worker",args:[a]});return b}g.createDedicatedWebWorker=a;g.createSharedWebWorker=b}),98);
__d("MAWWebWorkerSingleton",["FBLogger","MAWMainWebWorkerResource","SharedWorkerBundleResource","WorkerBundleResource","shouldUseMAWSharedWorker"],(function(a,b,c,d,e,f,g){"use strict";var h=null;function a(a){if(!h){var b=c("shouldUseMAWSharedWorker")();i();b?(b=d("SharedWorkerBundleResource").createPushSafeSharedWebWorker(c("MAWMainWebWorkerResource"),a),h=b.port):h=b=d("WorkerBundleResource").createDedicatedWebWorker(c("MAWMainWebWorkerResource"));b.onerror=function(a){c("FBLogger")("messenger_e2ee_web").mustfix("[MAWWebWorkerSingleton]: %s:%s:%s",JSON.stringify(a==null?void 0:a.message),a==null?void 0:a.lineno,a==null?void 0:a.colno)}}return h}function b(){h=null}function i(){}g.createWorkerIfNone=a;g.destroyWorkerInstance=b}),98);
__d("startMAWWorkerWatchdog",["MAWBridgeSendAndReceive","MAWIssueNewUserVisibleErrors","Promise","clearInterval","promiseDone","setInterval","setTimeout"],(function(a,b,c,d,e,f,g){"use strict";var h=30*1e3,i=h/2;function a(){var a=c("setInterval")(function(){var e=new(b("Promise"))(function(a,b){c("setTimeout")(function(){b(d("MAWIssueNewUserVisibleErrors").MAWGeneralErrorMsgBody)},i)});e=b("Promise").race([d("MAWBridgeSendAndReceive").sendAndReceive("backend","getWorkerHeartbeat"),e]);c("promiseDone")(e.then(function(b){b||(d("MAWIssueNewUserVisibleErrors").issueError(d("MAWIssueNewUserVisibleErrors").MAWGeneralErrorMsgBody,d("MAWIssueNewUserVisibleErrors").MAWGeneralErrorMsgTitle,d("MAWIssueNewUserVisibleErrors").MAWUserVisibleErrorPresentationType.BANNER),c("clearInterval")(a))})["catch"](function(b){d("MAWIssueNewUserVisibleErrors").issueError(d("MAWIssueNewUserVisibleErrors").MAWGeneralErrorMsgBody,d("MAWIssueNewUserVisibleErrors").MAWGeneralErrorMsgTitle,d("MAWIssueNewUserVisibleErrors").MAWUserVisibleErrorPresentationType.BANNER);c("clearInterval")(a);throw b}))},h);return function(){return c("clearInterval")(a)}}g["default"]=a}),98);
__d("MAWSetupWorker",["MAWCommonSetupWorker","MAWInit","MAWWebWorkerSingleton","Promise","WALogger","err","promiseDone","regeneratorRuntime","setTimeout","startMAWWorkerWatchdog"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["worker terminating"]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["worker doesn't exist, no need to terminate"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["worker setting up"]);j=function(){return a};return a}var k=null,l=null,m=null,n=!1;function o(a,b,e,f){if(n)throw c("err")("Worker is permanently killed.");var g=function(){return o(a,b,e,f)};d("MAWInit").logPoint("create_worker_start");l=d("MAWWebWorkerSingleton").createWorkerIfNone(function(){q(),c("setTimeout")(function(){c("promiseDone")(g(),f)},5e3)});d("MAWInit").logPoint("create_worker_end");if(l===null)throw c("err")("Client is starting bridge without a worker.");d("WALogger").LOG(j());var h=new(d("MAWCommonSetupWorker").BridgeAdapter)(l,"MAWMainWorker");k=h;return d("MAWInit").measurePerformance("maw_init_worker",function(){return d("MAWCommonSetupWorker").initWorker(h,a,b,e,g)})}function a(a,d,e,f){if(!k){a=o(a,d,e,f);m=c("startMAWWorkerWatchdog")();return a}return b("Promise").resolve(k.getBridgePort())}function e(){return l!=null}function p(a,b){if(!k){b&&d("WALogger").LOG(i());return!1}b&&d("WALogger").LOG(h());k.close();k=null;d("MAWWebWorkerSingleton").destroyWorkerInstance();l=null;a&&m!=null&&(m(),m=null);return!0}function q(){p(!0,!0)}function f(){p(!0,!0),n=!0}function r(){return b("regeneratorRuntime").async(function(a){while(1)switch(a.prev=a.next){case 0:if(!p(!1,!1)){a.next=3;break}a.next=3;return b("regeneratorRuntime").awrap(s(45e3));case 3:case"end":return a.stop()}},null,this)}function s(a){return new(b("Promise"))(function(b){return c("setTimeout")(b,a)})}g.setupWorker=o;g.getOrSetupWorker=a;g.doesWorkerExist=e;g.terminateWorker=q;g.terminateWorkerPermanently=f;g.killWorkerForTest=r}),98);
__d("MAWCommonSetupUser",["CurrentUser"],(function(a,b,c,d,e,f,g){"use strict";function a(){return{getAccountID:c("CurrentUser").getAccountID(),getAppID:c("CurrentUser").getAppID(),getEIMU:c("CurrentUser").getEIMU(),getEmployeeWorkUserID:c("CurrentUser").getEmployeeWorkUserID(),getID:c("CurrentUser").getID(),getName:c("CurrentUser").getName(),getPossiblyNonFacebookUserID:c("CurrentUser").getPossiblyNonFacebookUserID(),getShortName:c("CurrentUser").getShortName(),hasSecondaryBusinessPerson:c("CurrentUser").hasSecondaryBusinessPerson(),hasWorkUser:c("CurrentUser").hasWorkUser(),isBusinessPersonAccount:c("CurrentUser").isBusinessPersonAccount(),isDeactivatedAllowedOnMessenger:c("CurrentUser").isDeactivatedAllowedOnMessenger(),isEmployee:c("CurrentUser").isEmployee(),isFacebookWorkAccount:c("CurrentUser").isFacebookWorkAccount(),isGray:c("CurrentUser").isGray(),isLoggedIn:c("CurrentUser").isLoggedIn(),isLoggedInNow:c("CurrentUser").isLoggedInNow(),isMessengerCallGuestUser:c("CurrentUser").isMessengerCallGuestUser(),isMessengerOnlyUser:c("CurrentUser").isMessengerOnlyUser(),isTestUser:c("CurrentUser").isTestUser(),isUnderage:c("CurrentUser").isUnderage(),isWorkroomsUser:c("CurrentUser").isWorkroomsUser(),isWorkUser:c("CurrentUser").isWorkUser()}}g.getCurrentUserForArmadilloSetup_DO_NOT_USE=a}),98);
__d("FuncChannel",["FBLogger","Promise"],(function(a,b,c,d,e,f,g){"use strict";a=function(){function a(a){var d=this;this.$2=[];this.callMessageHandler=function(a){return new(b("Promise"))(function(b,c){a.result={resolveFunc:b,rejectFunc:c},d.$2.push(a)})};this.messageToCall=function(a){var b,e,f=d.proxyMethods[a.method];if(typeof f!=="function"){c("FBLogger")("worker").mustfix("proxyMethods["+a.method+"] is not a functions");return}b=(b=a.result)==null?void 0:b.resolveFunc;e=(e=a.result)==null?void 0:e.rejectFunc;if(typeof b==="function"&&typeof e==="function")try{var g=f.apply(a.thisArg,a.argList);b(g)}catch(a){e(a)}else return f.apply(a.thisArg,a.argList)};var e=this,f={},g=a(f);a=Object.keys(g);var h={};a.forEach(function(a){h[a]=function(){var b={type:"call",method:a,thisArg:null,argList:Array.from(arguments)};return e.callMessageHandler(b)},f[a]=function(){var b=e.$1[a];if(typeof b!=="function"){c("FBLogger")("worker").mustfix("_backend["+a+"] is not a functions");return}return b.apply(e.$1,arguments)},g[a]===null&&(g[a]=f[a])});this.$1=h;this.proxyMethods=g}var d=a.prototype;d.flushBuffer=function(){var a=this.$2;this.$2=[];a.forEach(this.messageToCall)};d.setBackend=function(a){this.$1!==a&&(this.$1=a,this.flushBuffer());return this};d.setCallMessageHandler=function(a){this.callMessageHandler=a,this.flushBuffer()};return a}();g["default"]=a}),98);
__d("MainPageUrl",["ExecutionEnvironment","FBLogger","SimpleHook"],(function(a,b,c,d,e,f,g){"use strict";var h=new URL("http://undefined"),i=new(d("SimpleHook").SimpleHook)();function j(){return c("ExecutionEnvironment").isInBrowser&&h.searchParams.get("workerlog")==="debug"}function a(a){try{j()&&c("FBLogger")("worker").debug("received url "+a);var b=new URL(a,h.href||"http://undefined");h.href!==b.href?(h.href=b.href,i.call(h)):j()&&c("FBLogger")("worker").debug("ignoring url: path didn't change in "+a)}catch(a){c("FBLogger")("worker").catching(a).warn("invalid url")}}typeof window==="object"&&typeof window.location==="object"&&typeof window.location.href==="string"&&a(window.location.href);g.mainPageUrl=h;g.onMainPageUrlChange=i;g.isWorkerLogEnabled=j;g.updateMainPageUrl=a}),98);
__d("TimedOnceFunc",["ExecutionEnvironment"],(function(a,b,c,d,e,f,g){a=function(){function a(a,b){this.$2=!1,this.$4=a,this.$3=b,c("ExecutionEnvironment").isInBrowser&&this.$5()}var b=a.prototype;b.$6=function(){this.$1!=null&&clearTimeout(this.$1),this.$1=null};b.$5=function(){var a=this;this.isDone()||(this.$6(),this.$1=setTimeout(function(){a.$2=!0,a.run()},this.$3))};b.isDone=function(){return this.$4===null};b.isCancelled=function(){return this.$1===null&&this.$4!==null};b.run=function(){this.$6();if(this.$4!=null){var a=this.$4;this.$4=null;a(this.$2)}};b.getDelay=function(){return this.$3};b.delay=function(a){this.$3=(a=a)!=null?a:this.$3;this.$5()};b.cancel=function(){this.$6()};return a}();g.TimedOnceFunc=a}),98);
__d("VirtualMessageChannel",["invariant","Promise","SimpleHook","nullthrows","promiseDone"],(function(a,b,c,d,e,f,g,h){"use strict";var i=function(){function a(a){a===void 0&&(a=!1),this.$2=new(d("SimpleHook").SimpleHook)(),this.onmessage=null,this.onmessageerror=null,this.$3=a}var e=a.prototype;e.setRemotePort=function(a){this.$1=a};e.addEventListener=function(a,b,c){(a==="message"||a==="error")&&c==null||h(0,55320,a);if(a==="message")if(typeof b==="function")this.$2.add(b);else{c=b.handleEvent.bind(b);this.$2.add(c);b.__handler=c}};e.removeEventListener=function(a,b,c){if(typeof b==="function")this.$2.remove(b);else{a=b.__handler;this.$2.remove(a)}};e.postMessage=function(a,d){var e=this,f=function(){var b=c("nullthrows")(e.$1,"By now remote port must have value!");b.$2.call({data:a,ports:d})};this.$3?f():c("promiseDone")(b("Promise").resolve(),f)};e.start=function(){};return a}();a=function(a,b){this.port1=new i(a),this.port2=new i(b),this.port1.setRemotePort(this.port2),this.port2.setRemotePort(this.port1)};g.VirtualMessagePort=i;g.VirtualMessageChannel=a}),98);
__d("DoubleKeyMap",[],(function(a,b,c,d,e,f){"use strict";a=function(){function a(){this.$1=new Map()}var b=a.prototype;b.set=function(a,b,c){var d=this.$1.get(a);d||this.$1.set(a,d=new Map());d.set(b,c)};b.get=function(a,b){return(a=this.$1.get(a))==null?void 0:a.get(b)};b["delete"]=function(a,b){var c=this.$1.get(a);c&&(c["delete"](b),c.size===0&&this.$1["delete"](a))};b.deleteAll=function(a){this.$1["delete"](a)};return a}();f.DoubleKeyMap=a}),66);
__d("NestedTimeRange",["SimpleHook","performance","performanceAbsoluteNow"],(function(a,b,c,d,e,f,g){"use strict";var h=new(d("SimpleHook").SimpleHook)(),i=new(d("SimpleHook").SimpleHook)(),j="/";function k(a,b){return""+a+j+b}b=function(){function a(a,b){b===void 0&&(b=null),this.$3=0,this.$1=a,this.$2=b}var b=a.prototype;b.isRunning=function(){return this.$3>0};b.fullname=function(){return this.$2!==null?k(this.$2.fullname(),this.$1):this.$1};b.start=function(a){a===void 0&&(a=c("performanceAbsoluteNow")());if(this.$3===0){var b;(b=this.$2)==null?void 0:b.start(a);this.__onStart(a)}++this.$3;return a};b.__onStart=function(a){h.call(this,a)};b.stop=function(a){a===void 0&&(a=c("performanceAbsoluteNow")());--this.$3;if(this.$3===0){var b;this.__onStop(a);(b=this.$2)==null?void 0:b.stop(a)}return a};b.__onStop=function(a){i.call(this,a)};return a}();function a(){c("performance").mark&&c("performance").measure&&(h.add(function(a,b){c("performance").mark(a.fullname()+"_start")}),i.add(function(a,b){c("performance").measure(a.fullname(),a.fullname()+"_start")}))}g.OnRangeStart=h;g.OnRangeStop=i;g.TIME_RANGE_LEVEL_SEPARATOR=j;g.rangeFullName=k;g.NestedTimeRange=b;g.enableDevConsoleTimeline=a}),98);
__d("QLogEvent",["DoubleKeyMap","FBLogger","NestedTimeRange","QPLEvent","SimpleHook","performanceNavigationStart"],(function(a,b,c,d,e,f,g){"use strict";var h=new(d("DoubleKeyMap").DoubleKeyMap)(),i=function(b){babelHelpers.inheritsLoose(a,b);function a(a,c,d){a=b.call(this,a,d)||this;a.$QPLRange1=c;h.set(c,a.fullname(),babelHelpers.assertThisInitialized(a));return a}var e=a.prototype;e.__onStart=function(a){b.prototype.__onStart.call(this,a),this.$QPLRange1.point(this.fullname()+"_START",{timestamp:a})};e.__onStop=function(a){b.prototype.__onStop.call(this,a),this.$QPLRange1.point(this.fullname()+"_END",{timestamp:a}),h["delete"](this.$QPLRange1,this.fullname())};e.range=function(b){this.fullname().startsWith(d("NestedTimeRange").TIME_RANGE_LEVEL_SEPARATOR)||c("FBLogger")("qpl").warn("Range %s cannot have subrange since root name does not start with /",this.fullname());var e=d("NestedTimeRange").rangeFullName(this.fullname(),b);return(e=h.get(this.$QPLRange1,e))!=null?e:new a(b,this.$QPLRange1,this)};return a}(d("NestedTimeRange").NestedTimeRange),j=new(d("DoubleKeyMap").DoubleKeyMap)(),k=new(d("SimpleHook").SimpleHook)(),l=new(d("SimpleHook").SimpleHook)(),m=new(d("SimpleHook").SimpleHook)(),n=new(d("SimpleHook").SimpleHook)(),o=function(b){babelHelpers.inheritsLoose(a,b);function a(a,c,e,f){var g;c===void 0&&(c=0);e===void 0&&(e=2);f===void 0&&(f=!1);var h=d("QPLEvent").getMarkerId(a);g=b.call(this,"event_"+h)||this;g.event=a;g.instanceKey=c;g.$QPLEvent1=e;g.isUserFlow=f;j.set(h,c,babelHelpers.assertThisInitialized(g));return g}var e=a.prototype;e.action=function(a){this.$QPLEvent1=a;return this};e.getAction=function(){return this.$QPLEvent1};e.setIsUserFlow=function(a){this.isUserFlow=a;return this};e.startFromNavStart=function(){this.start(c("performanceNavigationStart")());return this};e.startFromTime=function(a){this.start(a);return this};e.__onStart=function(a){k.call(this,a)};e.__onStop=function(a){l.call(this,a),h.deleteAll(this),j["delete"](d("QPLEvent").getMarkerId(this.event),this.instanceKey)};e.range=function(a){var b;return(b=h.get(this,a))!=null?b:new i(a,this)};e.point=function(a,b){b===void 0&&(b={});m.call(this,a,b);return this};e.annotate=function(a){n.call(this,a);return this};return a}(d("NestedTimeRange").NestedTimeRange);function a(a,b){var c;b===void 0&&(b=0);return(c=j.get(d("QPLEvent").getMarkerId(a),b))!=null?c:new o(a,b)}g.OnEventStart=k;g.OnEventStop=l;g.OnEventPoint=m;g.OnEventAnnotate=n;g.QPLEvent=o;g.event=a}),98);
__d("WorkerMessagePort",["FBLogger","MainPageUrl","Promise","QLogEvent","SimpleHook","VirtualMessageChannel","performanceAbsoluteNow","promiseDone","qpl"],(function(a,b,c,d,e,f,g){"use strict";var h=20,i=100,j=50;function k(a){return a}var l=function(b){babelHelpers.inheritsLoose(a,b);function a(){return b.apply(this,arguments)||this}return a}(d("SimpleHook").SimpleHook);function m(a,b){a=k(a);a.__timing=b}function n(a){return a.__timing}var o=0;function p(){return d("QLogEvent").event(c("qpl")._(41497718,"106"),o++)}var q=Math.random()<.1;function r(a,b,c){var d;if(b==null||!q)return;var e=b.sendDelayHighPrecision,f=b.sendTimestamp,g=b.sendDateTime,j=b.receiveTimestamp;b=b.receiveDateTime;d=(d=c)!=null?d:p();c==null&&d.startFromTime();var k=d.range("SEND_DELAY");k.start(f);k.stop(j);k=d.range("SEND_DELAY_LOW_PRECISION");k.start(g);k.stop(b);k=Math.abs(f-g);f=Math.abs(j-b);d.annotate({string:{port_name:a},"int":{send_delay:e,send_drift:k,receive_drift:f},bool:{send_delay_above_max:e!=null&&e>h,send_drift_above_max:k>i,receive_drift_above_max:f>i}});c==null&&d.stop()}a=function(){var a=e.prototype;a.onMessageHandler=function(a){try{this.onMessage.call(a);var b=this.$1[a.type];!b?this.onUnhandledMessage.call(a):b.call(a)}catch(a){this.onError.call(a)}};function e(a,b){var d=this;this.$1={};this.onUnhandledMessage=new l();this.onMessage=new l();this.onPostMessage=new l();this.onError=new l();this.$2=a;this.name=b;this.$2.addEventListener("message",function(a){return d.onMessageHandler(k(a.data))});this.$2.addEventListener("error",function(a){return d.onError.call(a)});this.onPostMessage.add(function(a){m(a,{sendTimestamp:c("performanceAbsoluteNow")(),receiveTimestamp:-1,sendDelayHighPrecision:0,sendDateTime:Date.now(),receiveDateTime:-1,sendDelayLowPrecision:0})});this.onMessage.add(function(a){a=n(a);if(a!=null){var b=a.sendTimestamp,e=a.sendDateTime,f=c("performanceAbsoluteNow")(),g=Date.now();a.receiveTimestamp=f;a.receiveDateTime=g;a.sendDelayHighPrecision=f-b;a.sendDelayLowPrecision=g-e;r(d.name,a)}})}a.postMessage=function(a,b){this.onPostMessage.call(a),b?this.$2.postMessage(a,b):this.$2.postMessage(a)};a.addMessageListener=function(a,b){var c=this.$1[a];c||(c=new l(),this.$1[a]=c);return c.add(b)};a.removeMessageListener=function(a,b){a=this.$1[a];return!!a&&a.remove(b)};a.onMessageOnce=function(a,c){var d=this;return new(b("Promise"))(function(b){var e=d.addMessageListener(a,function(f){c(f)&&(d.removeMessageListener(a,e),b(f))})})};a.close=function(){if(this.$2 instanceof MessagePort)this.$2.close();else if(this.$2 instanceof Worker)this.$2.terminate();else if(this.$2 instanceof DedicatedWorkerGlobalScope)this.$2.close();else{var a;(a=(a=this.$2.close)!=null?a:this.$2.terminate)==null?void 0:a.call(this.$2)}};a.isWrappingVirtualMessagePort=function(){return this.$2 instanceof d("VirtualMessageChannel").VirtualMessagePort};return e}();function s(a){return k(a)}e=function(a){babelHelpers.inheritsLoose(d,a);function d(d,e){var f;f=a.call(this,d,e)||this;var g=s(babelHelpers.assertThisInitialized(f));d=g.onMessageOnce("endpoint_started",function(){return!0});e=g.onMessageOnce("endpoint_started_received",function(){return!0});g.postMessage({type:"endpoint_started",endpoint:f.name});c("promiseDone")(d,function(a){var b=n(a);g.postMessage({type:"endpoint_started_received",endpoint:a.endpoint,targetEndpoint:f.name,startSendTimestamp:b==null?void 0:b.sendTimestamp});r(f.name,b)});c("promiseDone")(e,function(a){var b=n(a);if(b!=null){var c=p();c.startFromTime();r(f.name,b,c);var d=c.range("ROUND_TRIP");d.start(a.startSendTimestamp);d.stop(b.receiveTimestamp);d=b.receiveTimestamp-a.startSendTimestamp;c.annotate({"int":{round_trip:d},bool:{round_trip_above_max:d>j}}).stop()}});f.fullyConnected=b("Promise").race([d,e]).then(function(){return babelHelpers.assertThisInitialized(f)});return f}return d}(a);g.getMessageTiming=n;g.WorkerMessagePort=a;g.CastWorkerMessagePort=s;g.WorkerSyncedMessagePort=e}),98);
__d("WorkerFuncChannel",["invariant","DateConsts","ExecutionEnvironment","FBLogger","FuncChannel","MainPageUrl","Promise","TimedOnceFunc","VirtualMessageChannel","WorkerMessagePort","err","promiseDone"],(function(a,b,c,d,e,f,g,h){"use strict";var i={serialize:function(a,b){b.push(a);return a},deserialize:function(a){return a}},j=1e4,k=0,l=5,m=l+1,n=function(){function a(a){self.WeakRef&&(this.$1=new self.WeakRef(a))}var b=a.prototype;b.isDead=function(){return this.$1!=null&&this.$1.deref()==null};return a}(),o=function(e){babelHelpers.inheritsLoose(a,e);function a(a,b,f,g){var i;f===void 0&&(f=null);g===void 0&&(g={});i=e.call(this,a)||this;i.$WorkerFuncChannel1=new Map();i.$WorkerFuncChannel2=new Map();i.$WorkerFuncChannel5={"function":{serialize:function(a,b){b=m++;i.$WorkerFuncChannel1.set(b,a);a={type:"function",value:b};return a},deserialize:function(a){var b=babelHelpers.assertThisInitialized(i),c=a.value;a=function(){var a={type:"call",id:c,method:"__anonymous",thisArg:null,argList:Array.from(arguments)};return b.callMessageHandler(a)};i.$WorkerFuncChannel2.set(c,new n(a));return a}},custom:{serialize:function(a,b){var c=a.constructor.name,d=i.$WorkerFuncChannel4[c];d!=null||h(0,63779,c);d=d.serialize(a,b);return{type:"custom",custom:c,value:d}},deserialize:function(a){var b=a.custom,c=i.$WorkerFuncChannel4[b];c!=null||h(0,63779,b);return c.deserialize(a.value)}},error:{serialize:function(a,b){b={name:a.name,message:a.message,stack:a.stack};return{type:"error",value:b}},deserialize:function(a){var b=c("err")(a.value.message);b.name=a.value.name;b.stack=a.value.stack;return b}},object:{serialize:function(a,b){b=a.constructor;if(b!==Object)throw new Error("Cannot clone class object");return{type:"object",value:a}},deserialize:function(a){return a.value}},raw:{serialize:function(a,b){return{type:"raw",value:a}},deserialize:function(a){return a.value}}};i.name=b;i.$WorkerFuncChannel3=f;i.$WorkerFuncChannel4=g;a=function(a){d("MainPageUrl").isWorkerLogEnabled()&&c("FBLogger")("adsworker").debug("[Channel] removing callback ids: %s",a.join()),a.forEach(function(a){return i.$WorkerFuncChannel1["delete"](a)})};var l=i.__remoteInternalFunc(k,a);typeof jest===typeof void 0&&c("ExecutionEnvironment").isInBrowser&&setInterval(function(){var a=[];i.$WorkerFuncChannel2.forEach(function(b,c){b.isDead()&&(a.push(c),i.$WorkerFuncChannel2["delete"](c))});a.length>0?l(a):i.$WorkerFuncChannel2.size>5e3&&c("FBLogger")("adsworker").warn("[%s] has too many remaining refs %s",i.name,i.$WorkerFuncChannel2.size)},j);return i}var f=a.prototype;f.__remoteInternalFunc=function(a,b){(a>l||this.$WorkerFuncChannel1.get(a)!=null)&&c("FBLogger")("adsworker").mustfix("invalid internal func id %s",a);this.$WorkerFuncChannel1.set(a,b);b=this.$WorkerFuncChannel5["function"].deserialize({type:"function",value:a});return b};f.$WorkerFuncChannel6=function(a){return a instanceof Int8Array||a instanceof Int16Array||a instanceof Int32Array||a instanceof Uint8Array||a instanceof Uint8ClampedArray||a instanceof Uint16Array||a instanceof Uint32Array||a instanceof Float32Array||a instanceof Float64Array};f.$WorkerFuncChannel7=function(a){if(typeof a==="function")return"function";if(a===null)return"raw";if(typeof a!=="object")return"raw";if(Array.isArray(a))return"raw";if(this.$WorkerFuncChannel6(a))return"raw";var b=a.constructor.name;if(this.$WorkerFuncChannel4[b])return"custom";return a instanceof Error?"error":"object"};f.$WorkerFuncChannel8=function(a,b){var c=this.$WorkerFuncChannel7(a);return this.$WorkerFuncChannel5[c].serialize(a,b)};f.$WorkerFuncChannel9=function(a){var b=a;if(a!==null&&typeof a==="object"&&typeof a.type==="string"){var c=this.$WorkerFuncChannel5[a.type];if(c)return c.deserialize(a)}return b};f.__onPostOutMessage=function(a){return a};f.__callCallback=function(a,b){a.apply(null,b.argList)};f.setOutMessagePort=function(a,d){var e=this,f=[];this.setCallMessageHandler(function(d){d.thisArg=e.name;var g=[];d.argList=d.argList.map(function(a){return e.$WorkerFuncChannel8(a,g)});var h=new(b("Promise"))(function(a,b){d.result={resolveFunc:e.$WorkerFuncChannel8(a,g),rejectFunc:e.$WorkerFuncChannel8(b,g)}}),i=e.__onPostOutMessage(d);i!=null&&(f!=null?f.push({message:d,transferList:g}):a.postMessage(d,g));h["catch"](function(a){c("FBLogger")("worker").catching(a).mustfix("Error: channel %s, remote call of %s returned error %s",e.name,d.method,a.message)});return h});c("promiseDone")(d||v.waitForRemote(this.name),function(){var b=f;f=null;b==null?void 0:b.forEach(function(b){a.postMessage(b.message,b.transferList)});e.$WorkerFuncChannel3==null?void 0:e.$WorkerFuncChannel3()})};f.__messageToCall=function(a){var b=this;a.argList=a.argList.map(function(a){return b.$WorkerFuncChannel9(a)});if(a.result){var d=a.result,e=d.resolveFunc;d=d.rejectFunc;e=this.$WorkerFuncChannel9(e);d=this.$WorkerFuncChannel9(d);a.result={resolveFunc:e,rejectFunc:d}}e=a.id;if(e===void 0)this.messageToCall(a);else{d=this.$WorkerFuncChannel1.get(e);d?this.__callCallback(d,a):c("FBLogger")("adsworker").mustfix("Error: callback is called but no longer available")}};f.setInMessagePort=function(a){var b=this;a.addMessageListener("call",function(a){typeof a.thisArg==="string"&&a.thisArg===b.name&&b.__messageToCall(a)});v.notifyReady(this.name)};f.setMessagePort=function(a){this.setInMessagePort(a);this.setOutMessagePort(a);return this};return a}(c("FuncChannel")),p=function(b){babelHelpers.inheritsLoose(a,b);function a(){return b.apply(this,arguments)||this}return a}(d("WorkerMessagePort").WorkerMessagePort);function q(a,b,d,e){v.exportChannel(a,function(e){var f=e.syncPort;e=e.remoteNativePort;var g=b();a===g.name||h(0,54247,a,g.name);var i;e?(i=new p(e,f.name+"("+g.name+")"),e.start(),i.onError.add(function(a){c("FBLogger")("worker").catching(a).mustfix("error caught in remotePort");throw a})):i=f;g.setMessagePort(i).setBackend(d);c("promiseDone")(f.fullyConnected,function(){f.postMessage({type:"channelReady",channelName:g.name}),v.logState("EXPORTED",a)})})}function a(a,b,c,d){d===void 0&&(d={});return q(c,function(){return new o(function(b){return a},c,null,d)},a,b)}var r=function(b){babelHelpers.inheritsLoose(a,b);function a(a,e){e===void 0&&(e="");var f=d("DateConsts").MS_PER_MIN*1;return b.call(this,function(){c("FBLogger")("worker").warn("Channel %s did not establish eventually. %s",a,e)},f)||this}return a}(d("TimedOnceFunc").TimedOnceFunc);function s(a,b){var e,f=null,g,h;b.isWrappingVirtualMessagePort()?(h=new(d("VirtualMessageChannel").VirtualMessageChannel)(!0,!0),e="on virtual dedicated channel"):(h=new MessageChannel(),e="on native dedicated channel",g=[h.port2]);var i=h.port1;f=h.port2;i.start();var j=new p(i,b.name+"("+a.name+")");c("promiseDone")(b.fullyConnected,function(){v.logState("IMPORTING "+e+" ",a.name);a.setInMessagePort(j);var d=new r(a.name,e);c("promiseDone")(b.onMessageOnce("channelReady",function(b){return b.channelName===a.name}),function(b){a.setOutMessagePort(j),d.cancel(),v.logState("ESTABLISHED",a.name)});b.postMessage({type:"channelImport",channelName:a.name,port:f},g)});return a.proxyMethods}function t(a,b,c,d){c===void 0&&(c=null);d===void 0&&(d={});b=new o(function(b){return a},b,c,d);return b}function e(a,b,c,d,e){d===void 0&&(d=null);e===void 0&&(e={});return s(t(a,c,d,e),b)}var u=function(){function a(){this.name=self.name+"_P"+Math.round(10*Math.random()),this.$1=new Map(),this.$2=new Set()}var e=a.prototype;e.logState=function(a,b){d("MainPageUrl").isWorkerLogEnabled()&&c("FBLogger")("worker").debug("%s-%s %s",this.name,a,b)};e.$3=function(a){var b=this.$1.get(a);b==null&&(b={pendingPorts:null,onImportRequest:null},this.$1.set(a,b));return b};e.exportChannel=function(a,b){var d=this,e=this.$3(a);e.onImportRequest!=null&&c("FBLogger")("worker").debug("Re-exporting channel %s",a);e.onImportRequest=b;this.logState("REGISTERED",a);a=e.pendingPorts;if(a!=null){var f=a.filter(function(a){return d.$2.has(a.syncPort)});f.forEach(b);f.length<a.length?e.pendingPorts=a.filter(function(a){return!d.$2.has(a.syncPort)}):e.pendingPorts=null}return e};e.activate=function(a,b,d){var e=this;if(this.$2.has(a)){c("FBLogger")("worker").debug("Port %sis already duplicated ",a.name);return}this.$2.add(a);a.addMessageListener("channelImport",function(b){var c=b.channelName,d=e.$3(c);b={syncPort:a,remoteNativePort:b.port};d.onImportRequest!=null?d.onImportRequest(b):d.pendingPorts!=null?d.pendingPorts.push(b):d.pendingPorts=[b];e.logState("IMPORT REQUEST",c)})};e.notifyReady=function(a){};e.waitForRemote=function(a){return b("Promise").resolve()};return a}(),v=new u();function f(a,b,c){v.activate(a,b,c)}g.TransferableTransformer=i;g.WorkerFuncChannel=o;g.exportChannelOnPort=q;g.exportChannel=a;g.importChannelOnPort=s;g.makeChannel=t;g.importChannel=e;g.activateChannels=f}),98);
__d("WorkerBanzaiLazyQueueChannelClient",["BanzaiLazyQueue","WorkerFuncChannel"],(function(a,b,c,d,e,f,g){"use strict";function a(a){d("WorkerFuncChannel").exportChannel(c("BanzaiLazyQueue"),a,"banzai_lazyqueue_channel")}g.init=a}),98);
__d("WorkerQPLChannel",["WorkerFuncChannel","performanceAbsoluteNow"],(function(a,b,c,d,e,f,g){"use strict";var h=new(d("WorkerFuncChannel").WorkerFuncChannel)(function(a){return{markerStartFromNavStart:null,markerStart:function(b,d,e){e===void 0&&(e=c("performanceAbsoluteNow")());return a.markerStart(b,d,e)},markerAnnotate:function(b,c,d){return a.markerAnnotate(b,c,d)},markerPoint:function(b,d,e){e=(e==null?void 0:e.timestamp)===void 0?babelHelpers["extends"]({},e,{timestamp:c("performanceAbsoluteNow")()}):e;return a.markerPoint(b,d,e)},markerEnd:function(b,d,e,f){f===void 0&&(f=c("performanceAbsoluteNow")());return a.markerEnd(b,d,e,f)}}},"qpl");function a(a){h.setMessagePort(a)}function b(a){h.setBackend(a)}g.setMessagePort=a;g.initQPL=b}),98);
__d("WorkerClient",["WorkerBanzaiLazyQueueChannelClient","WorkerFuncChannel","WorkerQPLChannel"],(function(a,b,c,d,e,f,g){"use strict";function a(a){d("WorkerFuncChannel").activateChannels(a,"client","worker"),d("WorkerBanzaiLazyQueueChannelClient").init(a),d("WorkerQPLChannel").setMessagePort(a),e(["QuickPerformanceLogger"],function(a){return d("WorkerQPLChannel").initQPL(a)})}g.init=a}),98);
__d("MAWCommonSetupWorker",["Deferred","MAWCommonSetupUser","MAWMainThreadLogger","MAWSetupWorker","WADevToolMessageChannel","WALogger","WorkerClient","WorkerMessagePort","err","gkx","performanceNavigationStart","uuid"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["Terminating worker and rebooting..."]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["worker receive invalid message: ",""]);i=function(){return a};return a}var j=c("performanceNavigationStart")()+"__"+c("uuid")();b=function(a){babelHelpers.inheritsLoose(b,a);function b(b,c){var e;e=a.call(this,b,c)||this;e.onmessage=null;e.$BridgeAdapter1=b;d("WorkerClient").init(babelHelpers.assertThisInitialized(e));e.onUnhandledMessage.add(function(a){e.onmessage&&e.onmessage({data:a})});return e}var c=b.prototype;c.getBridgePort=function(){return this};return b}(d("WorkerMessagePort").WorkerSyncedMessagePort);function a(a,b,e,f,g){var k=new(c("Deferred"))();a.addMessageListener("worker-setup",function(b){var e;if(b.setupHash!==j)return;b.status==="failure"&&((e=b.logs)==null?void 0:e.length)&&d("MAWMainThreadLogger").logToHistoryInBulk(b.logs);if(b==null||b.type!=="worker-setup"){d("WALogger").WARN(i(),b);return}if(b.status==="success")k.resolve(a.getBridgePort());else if(b.status==="failure"){k.reject(c("err")((e=b.msg)!=null?e:"Encountered an error setting up the armadillo web worker"))}else if(b.status==="already-setup")if(b.action==="no-action"){k.resolve(a.getBridgePort());return}else if(b.action==="reboot-required"&&b.setupHash===j){d("WALogger").DEV(h());d("MAWSetupWorker").terminateWorker();return g().then(function(a){return k.resolve(a)})["catch"](function(a){return k.reject(a)})}else throw c("err")("received invalid action for worker-setup:already-setup: "+b.action);else throw c("err")("received invalid message for worker")});var l=d("MAWCommonSetupUser").getCurrentUserForArmadilloSetup_DO_NOT_USE(),m=window.location.hostname;if(c("gkx")("5147")){var n=d("WADevToolMessageChannel").createNewChannel();a.postMessage({content:{currentUser:l,devToolMessageChannelPort2:n.port2,fbId:b,hostname:m,latestKeyVersionForEAR:e,vaultMaterials:f},setupHash:j,type:"worker-setup"},[n.port2])}else a.postMessage({content:{currentUser:l,fbId:b,hostname:m,latestKeyVersionForEAR:e,vaultMaterials:f},setupHash:j,type:"worker-setup"});return k.getPromise()}g.BridgeAdapter=b;g.initWorker=a}),98);
__d("useLegacyUserWatchdog",["MAWIssueNewUserVisibleErrors","clearTimeout","react","setTimeout"],(function(a,b,c,d,e,f,g){"use strict";var h=d("react").useEffect;b=24*60*60*1e3;var i=5*b;function a(){h(function(){var a=c("setTimeout")(function(){d("MAWIssueNewUserVisibleErrors").issueError(d("MAWIssueNewUserVisibleErrors").MAWLegacyUserErrorMsgBody,d("MAWIssueNewUserVisibleErrors").MAWLegacyUserErrorMsgTitle,d("MAWIssueNewUserVisibleErrors").MAWUserVisibleErrorPresentationType.BANNER)},i);return function(){return c("clearTimeout")(a)}})}g["default"]=a}),98);
__d("useMAWDeregisterDeviceUntilReload",["MAWBridgeSendAndReceive","MAWIssueNewUserVisibleErrors","MAWSetupWorker","ODS","react","regeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";var h=d("react").useCallback;function a(){return h(function(){return b("regeneratorRuntime").async(function(a){while(1)switch(a.prev=a.next){case 0:d("ODS").bumpEntityKey(3185,"armadillo_forced_deregister",window.location.hostname);a.next=3;return b("regeneratorRuntime").awrap(d("MAWBridgeSendAndReceive").sendAndReceive("backend","removeCurrentDevice"));case 3:d("MAWSetupWorker").terminateWorkerPermanently(),d("MAWIssueNewUserVisibleErrors").issueError(d("MAWIssueNewUserVisibleErrors").MAWLegacyUserErrorMsgBody,d("MAWIssueNewUserVisibleErrors").MAWLegacyUserErrorMsgTitle,d("MAWIssueNewUserVisibleErrors").MAWUserVisibleErrorPresentationType.BANNER);case 5:case"end":return a.stop()}},null,this)},[])}g["default"]=a}),98);
__d("MAWSetup.react",["BaseHeadingContext","CometPlaceholder.react","CometRelay","CurrentUser","LSDatabaseDeferred","MAWCommonSetup","MAWSetupBridge","MAWSetupMutex.react","MAWSetupWorker","cr:2072","cr:2573","cr:2808","cr:2809","cr:3487","cr:5387","cr:5388","deferredLoadComponent","promiseDone","react","requireDeferredForDisplay","shouldUseMAWSharedWorker","useLegacyUserWatchdog","useMAWDeregisterDeviceUntilReload"],(function(a,b,c,d,e,f,g){"use strict";var h=d("react");e=d("react");var i=e.useContext,j=e.useMemo,k=c("deferredLoadComponent")(c("requireDeferredForDisplay")("MAWLoadingStateSpinner.react").__setRef("MAWSetup.react"));window.XPlatTesting=b("cr:2808");window.XPlatTestingGroups=b("cr:2809");var l=c("CurrentUser").getID();function m(a){var e=d("CometRelay").useRelayEnvironment(),f=c("useMAWDeregisterDeviceUntilReload")(),g=j(function(){return{doesWorkerExist:d("MAWSetupWorker").doesWorkerExist,getOrSetupWorker:d("MAWSetupWorker").getOrSetupWorker,logout:function(){return c("promiseDone")(f())},setupBridge:d("MAWSetupBridge").setupBridge,terminateWorker:d("MAWSetupWorker").terminateWorker}},[f]);d("MAWCommonSetup").useArmadillo(l,g);b("cr:5387")!=null?c("promiseDone")(d("LSDatabaseDeferred").db.then(function(a){b("cr:5387")==null?void 0:b("cr:5387").makeAll(a)})):b("cr:5388")==null?void 0:b("cr:5388").useMAWContactSync();c("useLegacyUserWatchdog")();b("cr:2573")();b("cr:2072")==null?void 0:b("cr:2072")();return h.jsxs(h.Fragment,{children:[a.children,c("shouldUseMAWSharedWorker")()?null:h.jsx(c("MAWSetupMutex.react"),{environment:e,fbId:l,platformSetupUtils:g})]})}m.displayName=m.name+" [from "+f.id+"]";function a(a){var d=i(c("BaseHeadingContext"));return h.jsxs(c("BaseHeadingContext").Provider,{value:d+1,children:[h.jsx(m,babelHelpers["extends"]({},a)),h.jsx(c("CometPlaceholder.react"),{fallback:null,children:h.jsx(k,{})}),b("cr:3487")&&h.jsx(b("cr:3487"),{})]})}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("MAWSetupMutexV2",["FBLogger","LocalStorageMutex","MAWAppMutex","MAWBridge","MAWEncyptionIndexedDbV2","MAWGating","MAWIssueNewUserVisibleErrors","MAWKeychainInit","MAWLocalStorage","MAWOccamadilloOnMutexChange","MAWStateContext.react","MAWVaultMaterialsStorage","MWChatBadgeCountUpdates.bs","QPLUserCountEvent","QPLUserFlow","Run","WALogger","WALoggerDeferred","emptyFunction","qex","qpl","react","regeneratorRuntime","useReStore"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["AppMutex - Reinitializing"]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["Worker is permanently killed and refuses startup"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["AppMutex - Shouldn't reinitialize, worker already exists"]);j=function(){return a};return a}a=d("react");var k=a.useCallback,l=a.useEffect,m=a.useMemo,n=c("FBLogger")("messenger_e2ee_web"),o=!1,p=0;function q(a){if(document.visibilityState!=="visible")return!1;a=a();var b=window.indexedDB!=null,e=d("MAWLocalStorage").isLocalStorageAvailable();if(a){d("WALogger").DEV(j());return!1}if(!b){d("QPLUserCountEvent").fireQplUserCount(c("qpl")._(25299354,"201"));return!1}if(!e){d("QPLUserCountEvent").fireQplUserCount(c("qpl")._(25309925,"203"));return!1}return!0}function r(a){return b("regeneratorRuntime").async(function(c){while(1)switch(c.prev=c.next){case 0:c.next=2;return b("regeneratorRuntime").awrap(d("MAWEncyptionIndexedDbV2").makeEncryptionDB(a));case 2:d("MAWEncyptionIndexedDbV2").maybeSetEncryptionDbOnVersionChange(function(){d("MAWIssueNewUserVisibleErrors").issueError(d("MAWIssueNewUserVisibleErrors").MAWLegacyUserErrorMsgBody,d("MAWIssueNewUserVisibleErrors").MAWLegacyUserErrorMsgTitle,d("MAWIssueNewUserVisibleErrors").MAWUserVisibleErrorPresentationType.BANNER)});return c.abrupt("return",d("MAWKeychainInit").initSetupKeychain());case 4:case"end":return c.stop()}},null,this)}function s(){return d("MAWVaultMaterialsStorage").setupVaultMaterials()}function t(a,e,f,g){var h;return b("regeneratorRuntime").async(function(j){while(1)switch(j.prev=j.next){case 0:j.prev=0;j.next=3;return b("regeneratorRuntime").awrap(a(e,f,g,c("emptyFunction")));case 3:h=j.sent;h==null&&c("QPLUserFlow").endFailure(c("qpl")._(25310984,"169"),"worker_refused_startup",{instanceKey:p});return j.abrupt("return",h);case 8:j.prev=8;j.t0=j["catch"](0);if(!((j.t0==null?void 0:j.t0.message)==="Worker is permanently killed.")){j.next=13;break}d("WALoggerDeferred").WARN(i());return j.abrupt("return");case 13:throw j.t0;case 14:case"end":return j.stop()}},null,this,[[0,8]])}e=function(a,e,f){var g=f.doesWorkerExist,i=f.getOrSetupWorker,j=f.logout,u=f.setupBridge,v=f.terminateWorker,w=m(function(){return d("MAWAppMutex").use()},[]),x=c("useReStore")(),y=d("MAWStateContext.react").useDispatchClearEphemeralSettings(),z=x.persistenceTypes.includes("indexeddb"),A=k(function(a){var b=w.takeoverFilter(a);if(!b||a.newValue===d("LocalStorageMutex").THIS_TAB||a.newValue==="")return;z||d("MAWBridge").getBridge().fireAndForget("event","uiUpdate",{events:[{tag:"DropAllSecureThreads",value:void 0}]});v();w.onMutexDeath()},[w,z,v]),B=k(function(){v(),w.onMutexDeath()},[w,v]),C=k(function(){var f,k,l,m,v,A;return b("regeneratorRuntime").async(function(B){while(1)switch(B.prev=B.next){case 0:f=q(g);if(!(!f||o||c("qex")._("215")===!0)){B.next=3;break}return B.abrupt("return");case 3:o=!0;p++;B.prev=5;d("WALogger").LOG(h());c("QPLUserFlow").start(c("qpl")._(25310984,"169"),{instanceKey:p});c("QPLUserFlow").addAnnotations(c("qpl")._(25310984,"169"),{"int":{version:2}},{instanceKey:p});B.next=11;return b("regeneratorRuntime").awrap(w.init());case 11:k=B.sent;if(k){B.next=15;break}c("QPLUserFlow").endFailure(c("qpl")._(25310984,"169"),"mutex_no_premission_on_reinit",{instanceKey:p});return B.abrupt("return");case 15:B.next=17;return b("regeneratorRuntime").awrap(r(e));case 17:l=B.sent;if(l.success){B.next=21;break}c("QPLUserFlow").endFailure(c("qpl")._(25310984,"169"),"mutex_keychain_setup_failure_on_reinit",{instanceKey:p});return B.abrupt("return");case 21:B.next=23;return b("regeneratorRuntime").awrap(s());case 23:m=B.sent;c("QPLUserFlow").addPoint(c("qpl")._(25310984,"169"),"vaulting_setup",{instanceKey:p});c("QPLUserFlow").addAnnotations(c("qpl")._(25310984,"169"),{bool:{will_vault:m!=null}},{instanceKey:p});B.next=28;return b("regeneratorRuntime").awrap(t(i,e,l.value,m));case 28:v=B.sent;if(!(v==null)){B.next=31;break}return B.abrupt("return");case 31:c("QPLUserFlow").addPoint(c("qpl")._(25310984,"169"),"worker_setup",{instanceKey:p});B.next=34;return b("regeneratorRuntime").awrap(u({environment:a,logout:j,worker:v}));case 34:A=B.sent;c("QPLUserFlow").addPoint(c("qpl")._(25310984,"169"),"bridge_setup",{instanceKey:p});if(!(!z&&d("MAWGating").isOccamadillo())){B.next=40;break}d("MAWOccamadilloOnMutexChange").onOccamadilloMutexChange(x);B.next=43;break;case 40:if(z){B.next=43;break}B.next=43;return b("regeneratorRuntime").awrap(A.sendAndReceive("backend","initSync",{numMsgsPerThread:10,numThreads:d("MWChatBadgeCountUpdates.bs").minSyncedThreads}));case 43:c("QPLUserFlow").endSuccess(c("qpl")._(25310984,"169"),{instanceKey:p});y();B.next=52;break;case 47:B.prev=47,B.t0=B["catch"](5),n.mustfix("AppMutex - failed to reinitialize worker"),n.catching(B.t0),c("QPLUserFlow").endFailure(c("qpl")._(25310984,"169"),"failed_to_reinitialize_worker",{error:B.t0,instanceKey:p});case 52:B.prev=52;o=!1;return B.finish(52);case 55:case"end":return B.stop()}},null,this,[[5,47,52,55]])},[g,w,e,i,x,u,a,j,z,y]);l(function(){window.addEventListener("storage",A);var a=d("Run").onBeforeUnload(B,!1),b=d("Run").onUnload(B);window.addEventListener("visibilitychange",C);return function(){window.removeEventListener("storage",A),a.remove(),b.remove(),window.removeEventListener("visibilitychange",C)}},[A,B,C])};g.useMutex=e}),98);
__d("MAWLoadingStateToastSelectors",[],(function(a,b,c,d,e,f){"use strict";a=function(a){return a.offlineQueueCount};b=function(a){return a.offlineQueueProgressDownloaded};f.offlineQueueCountSelector=a;f.offlineQueueProgressCountSelector=b}),66);
__d("MAWLoadingStateSpinner.react",["fbt","ix","BaseToasterStateManager","CometIcon.react","CometProgressRingDeterminate.react","MAWLoadingStateToastSelectors","MAWStateContext.react","fbicon","mwPushToast","mwReplaceToast","react","useMAWOfflineQueueLoadingIndicator"],(function(a,b,c,d,e,f,g,h,i){"use strict";var j=d("react");b=d("react");e=b.memo;var k=b.useEffect,l=b.useMemo,m=b.useRef,n=h._("__JHASH__f9ft1Nb-b3f__JHASH__"),o=h._("__JHASH__laOwOEc4JeD__JHASH__"),p=function(a,b){return h._("__JHASH__-uoxDFsOMfK__JHASH__",[h._param("restoredMessage",a.toString()),h._param("count",b.toString())])},q=c("BaseToasterStateManager").getInstance();function r(a,b){var d=100*a/b;a=b>100?p(a,b):void 0;return{body:a,icon:{comet:j.jsx(c("CometProgressRingDeterminate.react"),{color:"light",percentage:d,size:20})},startAddOn:{source:d,type:"progressRing"},title:n}}function s(a){d("mwReplaceToast").mwReplaceToast({icon:{comet:j.jsx(c("CometIcon.react"),{icon:d("fbicon")._(i("498146"),20)}),mds:d("fbicon")._(i("477815"),24)},title:o,toastId:a})}function a(){var a=c("useMAWOfflineQueueLoadingIndicator")(!0),b=d("MAWStateContext.react").useMAWSelector(d("MAWLoadingStateToastSelectors").offlineQueueCountSelector),e=d("MAWStateContext.react").useMAWSelector(d("MAWLoadingStateToastSelectors").offlineQueueProgressCountSelector),f=m();l(function(){if(a)f.current==null?f.current=d("mwPushToast").mwPushToast(r(e,b),Number.MAX_SAFE_INTEGER):d("mwReplaceToast").mwReplaceToast(babelHelpers["extends"]({},r(e,b),{toastId:f.current}));else if(f.current!=null){var c=f.current;s(c);window.setTimeout(function(){q.expire(c),f.current=void 0},2750)}},[e,a,b]);k(function(){return function(){f.current!=null&&q.expire(f.current)}},[]);return null}a.displayName=a.name+" [from "+f.id+"]";b=e(a);g["default"]=b}),98);